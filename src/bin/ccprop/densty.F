      SUBROUTINE DENSTY(OCC,EAO,P)
      IMPLICIT REAL*8 (A-H,O-Z)
      COMMON/BASIS/NBASIS,NBFAO,NBFSO,NBATRI
      COMMON/SIGNS/IOFF(500),IPRNT
      DIMENSION OCC(NBASIS),EAO(NBFAO,NBFSO),P(NBATRI)
      DATA ZERO / 0.0D+00 /
    1 FORMAT(//,2X,' DENSITY MATRIX'/)
C
C   READ DENSITY MATRIX AND Z VECTOR FROM FILE79
C
      NT=NBASIS
      NT2=NT*(NT+1)/2
      NTAO2=NBFAO*(NBFAO+1)/2
      ITAP79=79
      CALL RFILE(ITAP79)
      IPT=1+INTOWP(NT2+NT2+1+NT2+NT*NT)
      CALL WREADW(ITAP79,P,INTOWP(NTAO2),IPT,IPT)
      IPT=IPT+INTOWP(NTAO2)
C     CALL WREADW(ITAP79,ZETA,INTOWP(NO*NV),IPT,IPT)
      CALL RCLOSE(ITAP79,3)
C
C     DO 101 I=1,NBATRI
C 101 P(I)=ZERO
C     IJ=0
C     DO 103 I=1,NBFAO
C     DO 103 J=1,I
C     IJ=IJ+1
C     VALU=ZERO
C     DO 102 K=1,NBASIS
C     IF(OCC(K).LE.ZERO) GO TO 102
C     VALU=VALU+EAO(I,K)*EAO(J,K)*OCC(K)
C 102 CONTINUE
C     P(IJ)=VALU
C 103 CONTINUE
      IF(IPRNT.LE.3) GO TO 201
      WRITE(6,1)
      CALL PRINT(P,NBATRI,NBFAO,6)
C
  201 CONTINUE
      RETURN
      END
