      SUBROUTINE BCXYZ(ZETA,BXY,BXYZ,CXYZ)
C   THE CALCULATION OF CENTRIFUGAL DISTORTION CONSTANTS
      IMPLICIT REAL*8 (A-H,O-Z)
      DIMENSION ZETA(N3N,N3N,3),BXY(3,3,N3N)
      DIMENSION BXYZ(3,3,3,N3N),CXYZ(3,3,3,N3N)
      COMMON/VIB101/NATOM,N3N,NATRI,ILIN,NVIB
      COMMON/VIB102/ITHREE,IFOUR,N3TOT,N4TOT
      COMMON/VIB106/ROTAA(3),ROTGC(3),ROTCM(3),ROTMH(3)
      COMMON/VIB108/IAXIS(3),NDEG(150),NDAB(150,5),IMAG(150)
      COMMON/VIB203/IOFF(150),IPRNT
      COMMON/VIB204/SQM(150),ROOT(150),FREQ(150)
      COMMON/VIB205/IFREQ,NFRQ(150)
      COMMON/VIB207/TABCD(3,3,3,3),PABC(3,3,3)
      DATA WLIMIT / 1.0D-2 /
      DATA PH,AVN / 6.626176D+00 , 6.022045D+00 /
      DATA PI,CL / 3.1415926536D+00 , 2.99792458D+00 /
      DATA A00,HALF,ONE,TWO / 0.0D+00 , 0.5D+00 , 1.0D+00 , 2.0D+00 /
    1 FORMAT(//,2X,' **************************************'/
     1          2X,' ***THE B (XYZ) AND C (XYZ) MATRICES***'/
     2          2X,' **************************************')
    2 FORMAT(//,2X,' BXY MATRIX, IVIB = ',I5/)
    3 FORMAT(//,2X,' BXYZ (X) MATRIX (IN D-06 CM-1), IVIB = ',I2,
     1          1X,' BXYZ (Y) MATRIX (IN D-06 CM-1), IVIB = ',I2,
     2          1X,' BXYZ (Z) MATRIX (IN D-06 CM-1), IVIB = ',I2/)
    4 FORMAT(//,2X,' CXYZ (X) MATRIX (IN D-08 CM-1), IVIB = ',I2,
     1          1X,' CXYZ (Y) MATRIX (IN D-08 CM-1), IVIB = ',I2,
     2          1X,' CXYZ (Z) MATRIX (IN D-08 CM-1), IVIB = ',I2/)
C
      IF(IPRNT.GE.1)
     *WRITE(6,1)
      IXX=1
      IYY=2
      IZZ=3
C
C   ELEMENTS OF BXY MATRIX ARE IN CM-1
C   ELEMENTS OF CXY MATRIX ARE IN NO UNITS
      IF(IPRNT.LE.2) GO TO 201
      DO 101 IVIB=1,NVIB
      WRITE(6,2) IVIB
      CALL MATOUT(BXY(1,1,IVIB),3,3,3,3,6)
  101 CONTINUE
C
C   FORM BXYZ MATRICES
C   ELEMENTS OF BXYZ MATRIX ARE IN CM(-1/2)
  201 CONTINUE
      CALL ZERO(BXYZ,3*3*3*N3N)
      CALL ZERO(CXYZ,3*3*3*N3N)
      DO 110 IVIB=1,NVIB
      FRQI=FREQ(IVIB)
      FRQI2=FRQI*FRQI
      FRQIH=DSQRT(FRQI)
C
C   B(IA,IA,IA,IVIB) AND CXYZ(IA,IA,IA,IVIB) TERMS
      DO 103 IA=1,3
      VALU=A00
      DO 102 JVIB=1,NVIB
      FRQJ=FREQ(JVIB)
      FRQJ2=FRQJ*FRQJ
      FRQJH=DSQRT(FRQJ)
      IAA=IAXIS(IA)
      FACT=BXY(IA,IA,JVIB)*ROTCM(IAA)*ZETA(JVIB,IVIB,IA)
      VALU=VALU+(FACT*FRQJH)*(ONE/FRQJ2+TWO/FRQI2)
  102 CONTINUE
      BXYZ(IA,IA,IA,IVIB)=VALU
      CXYZ(IA,IA,IA,IVIB)=-VALU/FRQIH
  103 CONTINUE
C
C   BXYZ(IA,IA,IB,IVIB) AND CXYZ(IA,IA,IB,IVIB) TERMS
      DO 105 IA=1,3
      DO 105 IB=1,3
      IF(IA.EQ.IB) GO TO 105
      VALU=A00
      DO 104 JVIB=1,NVIB
      FRQJ=FREQ(JVIB)
      FRQJ2=FRQJ*FRQJ
      FRQJH=DSQRT(FRQJ)
      IAA=IAXIS(IA)
      IBB=IAXIS(IB)
      FACT=BXY(IA,IA,JVIB)*ROTCM(IBB)*ZETA(JVIB,IVIB,IB)
     1    +BXY(IA,IB,JVIB)*ROTCM(IAA)*ZETA(JVIB,IVIB,IA)*TWO
      VALU=VALU+(FACT*FRQJH)*(ONE/FRQJ2+TWO/FRQI2)
  104 CONTINUE
      BXYZ(IA,IA,IB,IVIB)=VALU
      BXYZ(IA,IB,IA,IVIB)=VALU
      BXYZ(IB,IA,IA,IVIB)=VALU
      CXYZ(IA,IA,IB,IVIB)=-VALU/FRQIH
      CXYZ(IA,IB,IA,IVIB)=-VALU/FRQIH
      CXYZ(IB,IA,IA,IVIB)=-VALU/FRQIH
  105 CONTINUE
C
C   BXYZ(IA,IB,IC,IVIB) AND CXYZ(IA,IB,IC,IVIB) TERMS
      VALU=A00
      IAA=IAXIS(1)
      IBB=IAXIS(2)
      ICC=IAXIS(3)
      DO 106 JVIB=1,NVIB
      FRQJ=FREQ(JVIB)
      FRQJ2=FRQJ*FRQJ
      FRQJH=DSQRT(FRQJ)
      FACT=BXY(IYY,IZZ,JVIB)*ROTCM(IAA)*ZETA(JVIB,IVIB,IXX)
     1    +BXY(IZZ,IXX,JVIB)*ROTCM(IBB)*ZETA(JVIB,IVIB,IYY)
     2    +BXY(IXX,IYY,JVIB)*ROTCM(ICC)*ZETA(JVIB,IVIB,IZZ)
      VALU=VALU+(FACT*FRQJH)*(ONE/FRQJ2+TWO/FRQI2)
  106 CONTINUE
      BXYZ(IXX,IYY,IZZ,IVIB)=VALU
      BXYZ(IXX,IZZ,IYY,IVIB)=VALU
      BXYZ(IYY,IXX,IZZ,IVIB)=VALU
      BXYZ(IYY,IZZ,IXX,IVIB)=VALU
      BXYZ(IZZ,IXX,IYY,IVIB)=VALU
      BXYZ(IZZ,IYY,IXX,IVIB)=VALU
      CXYZ(IXX,IYY,IZZ,IVIB)=-VALU/FRQIH
      CXYZ(IXX,IZZ,IYY,IVIB)=-VALU/FRQIH
      CXYZ(IYY,IXX,IZZ,IVIB)=-VALU/FRQIH
      CXYZ(IYY,IZZ,IXX,IVIB)=-VALU/FRQIH
      CXYZ(IZZ,IXX,IYY,IVIB)=-VALU/FRQIH
      CXYZ(IZZ,IYY,IXX,IVIB)=-VALU/FRQIH
C
  110 CONTINUE
      IF(IPRNT.LE.1) GO TO 202
      DO 115 IVIB=1,NVIB
      DO 113 IA=1,3
      DO 113 IB=1,3
      DO 113 IC=1,3
      BXYZ(IA,IB,IC,IVIB)=BXYZ(IA,IB,IC,IVIB)*1.0D+06
      CXYZ(IA,IB,IC,IVIB)=CXYZ(IA,IB,IC,IVIB)*1.0D+08
  113 CONTINUE
      WRITE(6,3) IVIB,IVIB,IVIB
      CALL MX3OUT(BXYZ(1,1,1,IVIB),3,BXYZ(1,1,2,IVIB),3,
     1            BXYZ(1,1,3,IVIB),3,3,6)
      WRITE(6,4) IVIB,IVIB,IVIB
      CALL MX3OUT(CXYZ(1,1,1,IVIB),3,CXYZ(1,1,2,IVIB),3,
     1            CXYZ(1,1,3,IVIB),3,3,6)
      DO 114 IA=1,3
      DO 114 IB=1,3
      DO 114 IC=1,3
      BXYZ(IA,IB,IC,IVIB)=BXYZ(IA,IB,IC,IVIB)/1.0D+06
      CXYZ(IA,IB,IC,IVIB)=CXYZ(IA,IB,IC,IVIB)/1.0D+08
  114 CONTINUE
  115 CONTINUE
C
  202 CONTINUE
      RETURN
      END
