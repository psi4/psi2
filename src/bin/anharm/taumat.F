      SUBROUTINE TAUMAT(AXY,BXY)
C   THE CALCULATION OF CENTRIFUGAL DISTORTION CONSTANTS
      IMPLICIT REAL*8 (A-H,O-Z)
      DIMENSION AXY(3,3,N3N),BXY(3,3,N3N)
      DIMENSION TAABB(3,3),TABAB(3,3)
      COMMON/VIB101/NATOM,N3N,NATRI,ILIN,NVIB
      COMMON/VIB102/ITHREE,IFOUR,N3TOT,N4TOT
      COMMON/VIB106/ROTAA(3),ROTGC(3),ROTCM(3),ROTMH(3)
      COMMON/VIB108/IAXIS(3),NDEG(150),NDAB(150,5),IMAG(150)
      COMMON/VIB203/IOFF(150),IPRNT
      COMMON/VIB204/SQM(150),ROOT(150),FREQ(150)
      COMMON/VIB205/IFREQ,NFRQ(150)
      COMMON/VIB207/TABCD(3,3,3,3),PABC(3,3,3)
      DATA WLIMIT / 1.0D-2 /
      DATA PH,AVN / 6.626176D+00 , 6.022045D+00 /
      DATA PI,CL / 3.1415926536D+00 , 2.99792458D+00 /
      DATA A00,HALF,ONE,TWO / 0.0D+00 , 0.5D+00 , 1.0D+00 , 2.0D+00 /
    1 FORMAT(//,2X,' *****************************'/
     1          2X,' ***THE TAU (ABCD) MATRICES***'/
     2          2X,' *****************************')
    2 FORMAT(//,2X,' AXY MATRIX, IVIB = ',I5/)
    3 FORMAT(//,2X,' BXY MATRIX, IVIB = ',I5/)
    4 FORMAT(//,2X,' TAABB MATRIX FROM AXY MATRICES (IN CM-1)',
     1          2X,' TABAB MATRIX FROM AXY MATRICES (IN CM-1)'/)
    5 FORMAT(//,2X,' TAABB MATRIX FROM BXY MATRICES (IN CM-1)',
     1          2X,' TABAB MATRIX FROM BXY MATRICES (IN CM-1)'/)
C
      WRITE(6,1)
C   TCONST IS IN CM-1
      TCONST=1.0D+06*((PH*AVN/CL)**3)/(128.0D+00*(PI**6))
C
C   ELEMENTS OF AXY MATRIX ARE IN AMU(1/2).A
      IF(IPRNT.LE.2) GO TO 201
      DO 101 IVIB=1,NVIB
      WRITE(6,2) IVIB
      CALL MATOUT(AXY(1,1,IVIB),3,3,3,3,6)
  101 CONTINUE
C
C   ELEMENTS OF BXY MATRIX ARE IN CM-1
      DO 102 IVIB=1,NVIB
      WRITE(6,3) IVIB
      CALL MATOUT(BXY(1,1,IVIB),3,3,3,3,6)
  102 CONTINUE
C
C   FORM TABCD MATRIX USING AXY MATRICES
C   ELEMENTS OF TABCD MATRIX ARE IN CM-1
  201 CONTINUE
      CALL ZERO(TABCD,81)
      DO 105 IVIB=1,NVIB
      FRQI=FREQ(IVIB)
      IF(DABS(FRQI).LE.WLIMIT) GO TO 105
      FRQI2=FRQI*FRQI
      DO 103 IA=1,3
      DO 103 IB=1,3
      DO 103 IC=1,3
      DO 103 ID=1,3
      IAA=IAXIS(IA)
      IBB=IAXIS(IB)
      ICC=IAXIS(IC)
      IDD=IAXIS(ID)
      DABCD=ROTAA(IAA)*ROTAA(IBB)*ROTAA(ICC)*ROTAA(IDD)
      IF(DABS(DABCD).LE.WLIMIT) GO TO 103
      FABCD=TCONST*(AXY(IA,IB,IVIB)*AXY(IC,ID,IVIB))/DABCD
      TABCD(IA,IB,IC,ID)=TABCD(IA,IB,IC,ID)-FABCD/FRQI2
  103 CONTINUE
  105 CONTINUE
      DO 106 IA=1,3
      DO 106 IB=1,3
      TAABB(IA,IB)=TABCD(IA,IA,IB,IB)
      TABAB(IA,IB)=TABCD(IA,IB,IA,IB)
  106 CONTINUE
      WRITE(6,4)
      CALL MX2OUT(TAABB,3,TABAB,3,3,6)
C
C   FORM TABCD USING BXY MATRICES
C   ELEMENTS OF TABCD MATRIX ARE IN CM-1
      CALL ZERO(TABCD,81)
      DO 108 IVIB=1,NVIB
      FRQI=FREQ(IVIB)
      IF(DABS(FRQI).LE.WLIMIT) GO TO 108
      DO 107 IA=1,3
      DO 107 IB=1,3
      DO 107 IC=1,3
      DO 107 ID=1,3
      FABCD=-TWO*BXY(IA,IB,IVIB)*BXY(IC,ID,IVIB)/FRQI
      TABCD(IA,IB,IC,ID)=TABCD(IA,IB,IC,ID)+FABCD
  107 CONTINUE
  108 CONTINUE
      DO 109 IA=1,3
      DO 109 IB=1,3
      TAABB(IA,IB)=TABCD(IA,IA,IB,IB)
      TABAB(IA,IB)=TABCD(IA,IB,IA,IB)
  109 CONTINUE
      WRITE(6,5)
      CALL MX2OUT(TAABB,3,TABAB,3,3,6)
C
      RETURN
      END
