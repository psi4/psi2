      SUBROUTINE ROVLIR(ZETA,AXY,F3Q,EE,RVCNST)
C   THE CALCULATION OF VIBRATION-ROTATION INTERACTION CONSTANTS
C   FOR A LINEAR POLYATOMIC MOLECULE
      IMPLICIT REAL*8 (A-H,O-Z)
      CHARACTER*1 RAXIS
      CHARACTER*25 RTYPE
      DIMENSION F3Q(N3N,N3N,N3N),ZETA(N3N,N3N,3),AXY(3,3,N3N)
      DIMENSION EE(N3N,N3N),RVCNST(NVIB,3)
      COMMON/VIB101/NATOM,N3N,NATRI,ILIN,NVIB
      COMMON/VIB103/PARA,WAVE,CONST,CYCL,CONV
      COMMON/VIB106/ROTAA(3),ROTGC(3),ROTCM(3),ROTMH(3)
      COMMON/VIB108/IAXIS(3),NDEG(150),NDAB(150,5),IMAG(150)
      COMMON/VIB109/CLIMIT,FLIM1,FLIM2
      COMMON/VIB203/IOFF(150),IPRNT
      COMMON/VIB204/SQM(150),ROOT(150),FREQ(150)
      COMMON/VIB205/IFREQ,NFRQ(150)
      COMMON/VIB206/RAXIS(3),RTYPE(6)
      COMMON/VIB209/SALP(3)
      DATA PH,AVN / 6.626176D+00 , 6.022045D+00 /
      DATA PI,CL / 3.1415926536D+00 , 2.99792458D+00 /
      DATA A00,HALF,ONE,TWO / 0.0D+00 , 0.5D+00 , 1.0D+00 , 2.0D+00 /
      DATA WLIMIT / 1.0D+00 /
      DATA ZLIMIT / 1.0D-05 /
    1 FORMAT(//,2X,' **************************************************'
     1        /,2X,' ***THE VIBRATION-ROTATION INTERACTION CONSTANTS***'
     2        /,2X,' **************************************************'
     3        )
    2 FORMAT(//,2X,' ZETA MATRIX, IABC = ',I5/)
    3 FORMAT(//,2X,' F3(QI*QJ*QK) MATRIX (IN CM-1), IVIB = ',I5/)
    4 FORMAT(//,2X,' AXY MATRIX, IVIB = ',I5/)
    5 FORMAT(//,2X,' QVIB',5X,' IVIB',10X,' A',21X,' B'/
     1          27X,' IN CM-1',15X,' IN CM-1'/)
    6 FORMAT(2X,I5,5X,I5,3X,F20.10,3X,F20.10)
    7 FORMAT(//,2X,' PRINCIPAL MOMENTS OF INERTIA WITH ZERO-POINT VIBRAT
     1IONAL CORRECTION'/
     2 4X,5H AXIS,9X,11H IN AMU.A+2,9X,10H IN G.CM+2,10X,
     3 8H IN CM-1,15X,7H IN MHZ/38X,8H (*D+39)/)
    8 FORMAT(8X,A1,3X,3F20.10,F20.5)
    9 FORMAT(//,2X,' ::::::::::::::::::::::::::::::::::::'/
     1          2X,' :::CORIOLIS RESONANCE IS OBSERVED:::'/
     2          2X,' ::::::::::::::::::::::::::::::::::::'/)
   10 FORMAT(2X,' RESONANCE LIMIT IS SET TO ',F10.3,' CM-1'/)
C
      WRITE(6,1)
      RCONST=1.0D-01*PI*DSQRT(CL/(PH*AVN))
      IAA=IAXIS(1)
      IBB=IAXIS(2)
      ICC=IAXIS(3)
      NCORIO=0
C
      IF(IPRNT.LE.2) GO TO 201
      DO 101 IABC=1,3
      WRITE(6,2) IABC
      CALL MATOUT(ZETA(1,1,IABC),N3N,N3N,N3N,N3N,6)
  101 CONTINUE
      DO 103 III=1,NVIB
      IVIB=NFRQ(III)
      WRITE(6,3) IVIB
      DO 102 I=1,NVIB
      II=NFRQ(I)
      DO 102 J=1,NVIB
      JJ=NFRQ(J)
      EE(I,J)=F3Q(II,JJ,IVIB)
  102 CONTINUE
      CALL ANHOUT(EE,N3N,N3N,NVIB,NVIB,6)
  103 CONTINUE
      DO 104 IVIB=1,NVIB
      WRITE(6,4) IVIB
      CALL MATOUT(AXY(1,1,IVIB),3,3,3,3,6)
  104 CONTINUE
C
C::::::::::::::::::::::::::::::
C:::FOR NON-DEGENERATE MODES:::
C::::::::::::::::::::::::::::::
  201 CONTINUE
      DO 113 IVIB=1,NVIB
      IF(NDEG(IVIB).NE.1) GO TO 113
      FRQI=FREQ(IVIB)
      FRQI2=FRQI*FRQI
      VALSA1=(AXY(IAA,IAA,IVIB)**2/ROTAA(1))*0.75D+00
      VALSB1=(AXY(IBB,IBB,IVIB)**2/ROTAA(2))*0.75D+00
C   SUM OVER DEGENERATE MODES
      VALSA2=A00
      VALSB2=A00
      DO 111 JVIB=1,NVIB
      IF(NDEG(JVIB).EQ.1) GO TO 111
      FRQJ=FREQ(JVIB)
      FRQJ2=FRQJ*FRQJ
      IF(DABS(FRQI-FRQJ).LE.CLIMIT) GO TO 203
      FACT2=0.5D+00*(FRQI2*3.0D+00+FRQJ2)/(FRQI2-FRQJ2)
      GO TO 204
C////////////////////////////////////
C///CORIOLIS RESONANCE CORRECTIONS///
C////////////////////////////////////
  203 CONTINUE
      FACT2=-(0.25D+00*(FRQI-FRQJ)**2)/(FRQJ*(FRQI+FRQJ))
      IF(DABS(ZETA(IVIB,JVIB,IAA)).GT.ZLIMIT.OR.
     *   DABS(ZETA(IVIB,JVIB,IBB)).GT.ZLIMIT) THEN
        NCORIO=NCORIO+1
      END IF
C///////////////////////////////
C///END OF CORIOLIS RESONANCE///
C///////////////////////////////
  204 CONTINUE
      ZFACT=ZETA(IVIB,JVIB,IAA)**2+ZETA(IVIB,JVIB,IBB)**2
      VALSA2=VALSA2+FACT2*ZFACT
      VALSB2=VALSB2+FACT2*ZFACT
  111 CONTINUE
C   SUM OVER NON-DEGENERATE MODES
      VALSA3=A00
      VALSB3=A00
      DO 112 JVIB=1,NVIB
      IF(NDEG(JVIB).NE.1) GO TO 112
      FRQJ=FREQ(JVIB)
      FACT3=(FRQI*F3Q(IVIB,IVIB,JVIB)*RCONST)/(FRQJ**(1.5D+00))
      VALSA3=VALSA3+AXY(IAA,IAA,JVIB)*FACT3
      VALSB3=VALSB3+AXY(IBB,IBB,JVIB)*FACT3
  112 CONTINUE
      ROTSA=-(VALSA1+VALSA2+VALSA3)*(ROTCM(1)*ROTCM(1)*TWO)/FRQI
      ROTSB=-(VALSB1+VALSB2+VALSB3)*(ROTCM(2)*ROTCM(2)*TWO)/FRQI
      RVCNST(IVIB,1)=ROTSA
      RVCNST(IVIB,2)=ROTSB
  113 CONTINUE
C
C::::::::::::::::::::::::::
C:::FOR DEGENERATE MODES:::
C::::::::::::::::::::::::::
      DO 115 IVIB=1,NVIB
      IF(NDEG(IVIB).EQ.1) GO TO 115
      FRQI=FREQ(IVIB)
      FRQI2=FRQI*FRQI
      VALTA1=A00
      VALTB1=A00
      VALTA2=A00
      VALTB2=A00
      VALTA3=A00
      VALTB3=A00
C   SUM OVER NON-DEGENERATE MODES
      DO 114 JVIB=1,NVIB
      IF(NDEG(JVIB).NE.1) GO TO 114
      FRQJ=FREQ(JVIB)
      FRQJ2=FRQJ*FRQJ
      IF(DABS(FRQI-FRQJ).LE.CLIMIT) GO TO 205
      FACT2=0.5D+00*(FRQI2*3.0D+00+FRQJ2)/(FRQI2-FRQJ2)
      GO TO 206
C////////////////////////////////////
C///CORIOLIS RESONANCE CORRECTIONS///
C////////////////////////////////////
  205 CONTINUE
      FACT2=-(0.25D+00*(FRQI-FRQJ)**2)/(FRQJ*(FRQI+FRQJ))
      IF(DABS(ZETA(IVIB,JVIB,IAA)).GT.ZLIMIT.OR.
     *   DABS(ZETA(IVIB,JVIB,IBB)).GT.ZLIMIT) THEN
        NCORIO=NCORIO+1
      END IF
C///////////////////////////////
C///END OF CORIOLIS RESONANCE///
C///////////////////////////////
  206 CONTINUE
      ZFACT=ZETA(IVIB,JVIB,IAA)**2+ZETA(IVIB,JVIB,IBB)**2
      VALTA2=VALTA2+FACT2*ZFACT
      VALTB2=VALTB2+FACT2*ZFACT
      FACT3=(FRQI*F3Q(IVIB,IVIB,JVIB)*RCONST)/(FRQJ**(1.5D+00))
      VALTA3=VALTA3+AXY(IAA,IAA,JVIB)*FACT3
      VALTB3=VALTB3+AXY(IBB,IBB,JVIB)*FACT3
  114 CONTINUE
      ROTTA=-(VALTA1+VALTA2+VALTA3)*(ROTCM(1)*ROTCM(1)*TWO)/FRQI
      ROTTB=-(VALTB1+VALTB2+VALTB3)*(ROTCM(2)*ROTCM(2)*TWO)/FRQI
      RVCNST(IVIB,1)=ROTTA
      RVCNST(IVIB,2)=ROTTB
  115 CONTINUE
C
C   CALCULATE THE ROTATIONAL CONSTANTS
C   WITH ZERO-POINT VIBRATIONAL CORRECTION
      CALL ZERO(SALP,3)
      WRITE(6,5)
      DO 120 III=1,NVIB
      IVIB=NFRQ(III)
      ROTA=RVCNST(IVIB,1)
      ROTB=RVCNST(IVIB,2)
      SALP(1)=SALP(1)+ROTA
      SALP(2)=SALP(2)+ROTB
      WRITE(6,6) III,IVIB,ROTA,ROTB
  120 CONTINUE
      WRITE(6,7)
      DO 122 I=1,2
      PB=ROTCM(I)-SALP(I)*HALF
      PT=CONST/PB
      PA=PT*PARA
      PC=CYCL/PT
      WRITE(6,8) RAXIS(I),PT,PA,PB,PC
  122 CONTINUE
C
      IF(NCOR.NE.0) THEN
        WRITE(6,9)
        WRITE(6,10) CLIMIT
      END IF
C
      RETURN
      END
