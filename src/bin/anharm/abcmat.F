      SUBROUTINE ABCMAT(EPXM,AXY,BXY,CXY,EE)
C   FORM A (XY) MATRICES
      IMPLICIT REAL*8 (A-H,O-Z)
      DIMENSION EPXM(N3N,N3N),AXY(3,3,N3N),BXY(3,3,N3N),CXY(3,3,N3N)
      DIMENSION EE(N3N,N3N)
      COMMON/VIB101/NATOM,N3N,NATRI,ILIN,NVIB
      COMMON/VIB106/ROTAA(3),ROTGC(3),ROTCM(3),ROTMH(3)
      COMMON/VIB108/IAXIS(3),NDEG(150),NDAB(150,5),IMAG(150)
      COMMON/VIB201/CHG(50),X(50),Y(50),Z(50),W(50)
      COMMON/VIB203/IOFF(150),IPRNT
      COMMON/VIB204/SQM(150),ROOT(150),FREQ(150)
      DATA PH,AVN / 6.626176D+00 , 6.022045D+00 /
      DATA PI,CL / 3.1415926536D+00 , 2.99792458D+00 /
      DATA A00,HALF,ONE,TWO / 0.0D+00 , 0.5D+00 , 1.0D+00 , 2.0D+00 /
      DATA WLIMIT / 1.0D-2 /
    1 FORMAT(//,2X,' ********************************************'/
     1          2X,' ***THE A (XY) , B (XY) AND C(XY) MATRICES***'/
     2          2X,' ********************************************')
    2 FORMAT(//,2X,' LXM'' MATRIX'/)
    3 FORMAT(//,2X,' LXM'' * LXM''(T) = E'/)
    4 FORMAT(//,2X,' CARTESIAN COORDINATES W.R.T. CENTER OF MASS (IN A)'
     1/5X,4H NO.,11X,2H X,18X,2H Y,18X,2H Z,18X,2H W/)
    5 FORMAT(2X,I7,5X,4F15.7)
    6 FORMAT(//,2X,' AXY MATRIX, IVIB = ',I5/)
    7 FORMAT(//,2X,' BXY MATRIX, IVIB = ',I5/)
    8 FORMAT(//,2X,' CXY MATRIX, IVIB = ',I5/)
    9 FORMAT(//,2X,' AXY MATRIX, IVIB = ',I5,18X,' BXY MATRIX, IVIB = ',
     1       I5,18X,' CXY MATRIX, IVIB = ',I5/)
C
      IF(IPRNT.GE.1)
     *WRITE(6,1)
      IF(IPRNT.LE.2) GO TO 201
      WRITE(6,2)
      CALL MATOUT(EPXM,N3N,N3N,N3N,N3N,6)
      CALL MTXMPY(EPXM,N3N,EPXM,N3N,EE,N3N,EE,N3N,N3N,3)
      WRITE(6,3)
      CALL MATOUT(EE,N3N,N3N,N3N,N3N,6)
      WRITE(6,4)
      DO 101 I=1,NATOM
      WRITE(6,5) I,X(I),Y(I),Z(I),W(I)
  101 CONTINUE
C
C   FORM AXY MATRICES
C   ELEMENTS OF AXY MATRIX ARE IN AMU(1/2).A
  201 CONTINUE
      CALL ZERO(AXY,3*3*N3N)
      DO 105 IVIB=1,NVIB
      CALL ZERO(EE,N3N*N3N)
      DO 103 I=1,NATOM
      IX=(I-1)*3+1
      IY=IX+1
      IZ=IX+2
      EE(1,1)=EE(1,1)+SQM(I)*(Y(I)*EPXM(IY,IVIB)+Z(I)*EPXM(IZ,IVIB))*TWO
      EE(2,2)=EE(2,2)+SQM(I)*(Z(I)*EPXM(IZ,IVIB)+X(I)*EPXM(IX,IVIB))*TWO
      EE(3,3)=EE(3,3)+SQM(I)*(X(I)*EPXM(IX,IVIB)+Y(I)*EPXM(IY,IVIB))*TWO
      EE(1,2)=EE(1,2)-SQM(I)*(X(I)*EPXM(IY,IVIB)+Y(I)*EPXM(IX,IVIB))
      EE(1,3)=EE(1,3)-SQM(I)*(Z(I)*EPXM(IX,IVIB)+X(I)*EPXM(IZ,IVIB))
      EE(2,3)=EE(2,3)-SQM(I)*(Y(I)*EPXM(IZ,IVIB)+Z(I)*EPXM(IY,IVIB))
  103 CONTINUE
      EE(2,1)=EE(1,2)
      EE(3,1)=EE(1,3)
      EE(3,2)=EE(2,3)
      DO 104 I=1,3
      DO 104 J=1,3
      AXY(I,J,IVIB)=EE(I,J)
  104 CONTINUE
      IF(IPRNT.LE.2) GO TO 105
      IF(DABS(FREQ(IVIB)).LE.WLIMIT) GO TO 105
      WRITE(6,6) IVIB
      CALL MATOUT(AXY(1,1,IVIB),3,3,3,3,6)
  105 CONTINUE
C
C   BCONST IS IN CM-1
      BCONST=1.0D+03*((PH*AVN/CL)**(1.5D+00))/(16.0D+00*(PI**3))
C
C   FORM BXY AND CXY MATRICES
C   ELEMENTS OF BXY MATRIX ARE IN CM-1
C   ELEMENTS OF CXY MATRIX DO NOT HAVE UNITS
      CALL ZERO(BXY,3*3*N3N)
      CALL ZERO(CXY,3*3*N3N)
      DO 108 IVIB=1,NVIB
      FRQI=FREQ(IVIB)
      IF(DABS(FRQI).LE.WLIMIT) GO TO 108
      FRQIH=DSQRT(FRQI)
      DO 107 IA=1,3
      DO 106 IB=1,3
      IAA=IAXIS(IA)
      IBB=IAXIS(IB)
      DENAB=ROTAA(IAA)*ROTAA(IBB)
      IF(DABS(DENAB).LE.WLIMIT) GO TO 106
      DENAB=-DENAB*FRQIH
      BXY(IA,IB,IVIB)=BCONST*AXY(IA,IB,IVIB)/DENAB
      CXY(IA,IB,IVIB)=-BXY(IA,IB,IVIB)/FRQI
  106 CONTINUE
  107 CONTINUE
      IF(IPRNT.LE.2) GO TO 108
      WRITE(6,7) IVIB
      CALL MATOUT(BXY(1,1,IVIB),3,3,3,3,6)
      WRITE(6,8) IVIB
      CALL MATOUT(CXY(1,1,IVIB),3,3,3,3,6)
  108 CONTINUE
C
      IF(IPRNT.LE.1) GO TO 202
      DO 110 IVIB=1,NVIB
      WRITE(6,9) IVIB,IVIB,IVIB
      CALL MX3OUT(AXY(1,1,IVIB),3,BXY(1,1,IVIB),3,CXY(1,1,IVIB),3,3,6)
  110 CONTINUE
C
  202 CONTINUE
      RETURN
      END
