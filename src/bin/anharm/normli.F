      SUBROUTINE NORMLI(ELXM,EE,VALU,FV1,FV2,FXM,FXMX,VALUX,ELXMX,NORD,
     1                  NAA)
      IMPLICIT REAL*8 (A-H,O-Z)
      DIMENSION ELXM(N3N,N3N),EE(N3N,N3N)
      DIMENSION VALU(N3N),FV1(N3N),FV2(N3N),FXM(NATRI)
      DIMENSION FXMX(NAA),VALUX(NATOM),ELXMX(NATOM,NATOM)
      DIMENSION NORD(1)
      COMMON/VIB101/NATOM,N3N,NATRI,ILIN,NVIB
      COMMON/VIB103/PARA,WAVE,CONST,CYCL,CONV
      COMMON/VIB108/IAXIS(3),NDEG(150),NDAB(150,5),IMAG(150)
      COMMON/VIB203/IOFF(150),IPRNT
      COMMON/VIB204/SQM(150),ROOT(150),FREQ(150)
      DATA A00 / 0.0D+00 /
    1 FORMAT(//,2X,' FXMX MATRIX, IXYZ = ',I5/)
    2 FORMAT(//,2X,' ELXM MATRIX BEFORE SORTING'/)
    3 FORMAT(/,2X,' EIGENVALUES AND FREQUENCIES'/
     1 13X,8H IN A.U.,9X,8H IN CM-1/)
    4 FORMAT(2X,I5,F15.6,2X,F15.6)
    5 FORMAT(//,2X,' LXM MATRIX'/)
    6 FORMAT(//,2X,' LXM * LXM(T) = E '/)
C
C   THE CALCULATION OF EIGENVALUE AND EIGENVECTOR
      DO 105 IXYZ=1,3
C
      IIJJ=0
      DO 101 IABC=1,NATOM
      IADD=(IABC-1)*3
      IX=IADD+IXYZ
      DO 101 JABC=1,IABC
      JADD=(JABC-1)*3
      JX=JADD+IXYZ
      IJX=IOFF(IX)+JX
      IIJJ=IIJJ+1
      FXMX(IIJJ)=FXM(IJX)
  101 CONTINUE
      IF(IPRNT.LE.2) GO TO 201
      WRITE(6,1) IXYZ
      CALL PRINT(FXMX,NAA,NATOM,6)
  201 CONTINUE
      CALL RSP(NATOM,NATOM,NAA,FXMX,VALUX,1,ELXMX,FV1,FV2)
C
      DO 103 IABC=1,NATOM
      IADD=(IABC-1)*3
      IX=IADD+IXYZ
      VALU(IX)=VALUX(IABC)
      DO 103 JABC=1,NATOM
      JADD=(JABC-1)*3
      JX=JADD+IXYZ
      ELXM(IX,JX)=ELXMX(IABC,JABC)
  103 CONTINUE
  105 CONTINUE
      IF(IPRNT.LE.2) GO TO 202
      WRITE(6,2)
      CALL MATOUT(ELXM,N3N,N3N,N3N,N3N,6)
C
C   SORT EIGENVALUES AND EIGENVECTORS
  202 CONTINUE
      CALL REORDR(VALU,NORD,N3N)
      WRITE(6,3)
      DO 106 I=1,N3N
      ROOT(I)=VALU(I)
      IMAG(I)=0
      IF(VALU(I).LT.A00) IMAG(I)=1
      IF(VALU(I).LT.A00) VALU(I)=-VALU(I)
      AVAL=VALU(I)
      FREQ(I)=WAVE*DSQRT(AVAL)
  106 WRITE(6,4) I,ROOT(I),FREQ(I)
C
C   EIGENVECTOR CORRESPONDS TO LXM VECTOR
      DO 108 II=1,N3N
      NN=NORD(II)
      DO 107 I=1,N3N
  107 EE(I,II)=ELXM(I,NN)
  108 CONTINUE
      DO 109 I=1,N3N
      DO 109 J=1,N3N
      ELXM(I,J)=EE(I,J)
  109 CONTINUE
      WRITE(6,5)
      CALL FRQOUT(ELXM,FREQ,N3N,N3N,N3N,N3N,6)
C
C   THE EXAMINATION OF ABOVE CALCULATION
      IF(IPRNT.LE.2) GO TO 203
      CALL MTXMPY(ELXM,N3N,ELXM,N3N,EE,N3N,EE,N3N,N3N,3)
      WRITE(6,6)
      CALL MATOUT(EE,N3N,N3N,N3N,N3N,6)
C
  203 CONTINUE
      RETURN
      END
