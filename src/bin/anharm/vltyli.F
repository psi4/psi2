      SUBROUTINE VLTYLI(F3Q,F4Q,CLTYP)
C   THE CALCULATION OF VIBRATIONAL L-TYPE DOUBLING CONSTANTS
C   FOR A LINEAR POLYATOMIC MOLECULE
      IMPLICIT REAL*8 (A-H,O-Z)
      DIMENSION CLTYP(N3N,N3N)
      DIMENSION F3Q(N3N,N3N,N3N),F4Q(N3N,N3N,N3N,N3N)
      COMMON/VIB101/NATOM,N3N,NATRI,ILIN,NVIB
      COMMON/VIB108/IAXIS(3),NDEG(150),NDAB(150,5),IMAG(150)
      COMMON/VIB109/CLIMIT,FLIM1,FLIM2
      COMMON/VIB203/IOFF(150),IPRNT
      COMMON/VIB204/SQM(150),ROOT(150),FREQ(150)
      COMMON/VIB205/IFREQ,NFRQ(150)
      DATA A00,HALF,ONE,TWO / 0.0D+00 , 0.5D+00 , 1.0D+00 , 2.0D+00 /
      DATA WLIMIT / 1.0D-02 /
      DATA PI,CL / 3.1415926536D+00 , 2.99792458D+00 /
    1 FORMAT(//,2X,' ***********************************************'/
     1          2X,' ***THE VIBRATIONAL L-TYPE DOUBLING CONSTANTS***'/
     2          2X,' ***********************************************')
    2 FORMAT(2X,I5,4F10.5)
    3 FORMAT(//,2X,' QVIB',5X,' IVIB',7X,' FREQENCY',9X,' CUBIC',
     1         12X,' QUARTIC',10X,' TOTAL',9X,' TOTAL'/
     2         24X,' IN CM-1',10X,' IN CM-1',10X,' IN CM-1',
     3         10X,' IN CM-1',7X,' IN MHZ'/)
    4 FORMAT(2X,I5,5X,I5,8X,F10.5,F15.5,3X,F15.5,3X,F15.5,3X,F15.5)
C
      WRITE(6,1)
C
C   NOTE : THE MOLECULAR AXIS IS CHOSEN AS THE Z AXIS
      IXX=1
      IYY=2
      IZZ=3
C
C:::::::::::::::::::::::::::::::
C:::ONLY FOR DEGENERATE MODES:::
C:::::::::::::::::::::::::::::::
      DO 105 IVIB=1,NVIB
      IF(NDEG(IVIB).EQ.1) GO TO 105
      FRQI=FREQ(IVIB)
      FRQI2=FRQI*FRQI
      IVA=NDAB(IVIB,1)
      IVB=NDAB(IVIB,2)
      DO 104 JVIB=1,NVIB
      IF(NDEG(JVIB).EQ.1) GO TO 104
      FRQJ=FREQ(JVIB)
      FRQJ2=FRQJ*FRQJ
      JVA=NDAB(JVIB,1)
      JVB=NDAB(JVIB,2)
      IF(IVIB.EQ.JVIB) GO TO 104
C
C   SUM OVER NON-DEGENERATE MODES
      VALU3=A00
      DO 103 KVIB=1,NVIB
      IF(NDEG(KVIB).NE.1) GO TO 103
      FRQK=FREQ(JVIB)
      FRQK2=FRQK*FRQK
      DNUM=(FRQK2-FRQI2-FRQJ2)*FRQK
      FAC=F3Q(IVA,JVA,KVIB)
      FACT=FAC*FAC
      WPPP=FRQI+FRQJ+FRQK
      WPPM=FRQI+FRQJ-FRQK
      WPMP=FRQI-FRQJ+FRQK
      WPMM=FRQI-FRQJ-FRQK
      DIJK=WPPP*WPPM*WPMP*WPMM
      VALU3=VALU3-(0.5D+00*FACT*DNUM)/(DIJK)
  103 CONTINUE
      VALU4=(F4Q(IVA,IVA,JVA,JVA)-F4Q(IVA,IVA,JVB,JVB))/4.0D+00
      VALUT=VALU3+VALU4
      CLTYP(IVIB,1)=VALU3
      CLTYP(IVIB,2)=VALU4
      CLTYP(IVIB,3)=VALUT
      IF(IPRNT.LE.2) GO TO 105
      WRITE(6,2) IVIB,FRQI,VALU3,VALU4,VALUT
  104 CONTINUE
  105 CONTINUE
C
      WRITE(6,3)
      DO 106 II=1,NVIB
      IVIB=NFRQ(II)
      IF(NDEG(IVIB).LE.1) GO TO 106
      FRQI=FREQ(IVIB)
      VALU3=CLTYP(IVIB,1)
      VALU4=CLTYP(IVIB,2)
      VALUT=CLTYP(IVIB,3)
      VALUM=VALUT*CL*1.0D+04
      WRITE(6,4) II,IVIB,FRQI,VALU3,VALU4,VALUT,VALUM
  106 CONTINUE
C
      RETURN
      END
