      SUBROUTINE INSORT(IAD,VAL,AINT,IVAL,IINT)
C
CTJL  EXTENDED DUMMY IAD,VAL,AINT,IVAL,IINT
C
      INTEGER SYMORB,IINT(1),IVAL(1)
      REAL*8 AINT,T,VAL
C
      COMMON /TAPES/ITAP52,ITAPE5,ITAPE6,ITAP58,ITAP12,ITAP99,ITAP04
     *,             ITAPE3,ITAP05,ITAP06
      COMMON /INTS/   NMAX,NMAX2,NGROUP,NBLKOC,NUMIJ,SYMORB,INTSRT
      COMMON /SORT/   IBLOCK,LNBUF,MAX
      COMMON /TEST/ ITEST
C
      DIMENSION IAD(1),VAL(1),AINT(NMAX)
C
      ILAST=0
      DO 1 I=1,NGROUP
        IP=(I-1)*LNBUF
C       BACK-CHAINING POINTER
        IAD(IP+MAX+1)=-1
C       NUMBER OF ELEMENTS IN BUFFER
        IAD(IP+MAX+2)=0
    1 CONTINUE
      RETURN
C
C***************************** OUT *************************************
C
      ENTRY SORTS(IBLK,IADR,T,IAD,VAL,AINT,IVAL,IINT)
C
      IP=(IBLK-1)*LNBUF
      N=IAD(IP+MAX+2)
      IF (N.LT.MAX) GO TO 2
      ILAST=ILAST+1
C************ TJL
      ITEST = 1
      CALL SWRIT(ITAP99,IAD(IP+1),LNBUF)
      CALL SWRIT(ITAP99,VAL(IP+1),INTOWP(LNBUF))
      IAD(IP+MAX+1)=ILAST
      N=0
    2 CONTINUE
      N=N+1
      IAD(IP+MAX+2)=N
      IAD(IP+N)=IADR
      VAL(IP+N)=T
      RETURN
C
C*************************** FINSRT ************************************
C
      ENTRY FINSRT(IAD,VAL,AINT,IVAL,IINT)
C
      WRITE(ITAPE6,101) ILAST,LNBUF
  101 FORMAT (1X,'SORT TAPE USED',I7,' BUFFERS OF ',I7,' ELEMENTS EACH')
      CALL SREW(ITAP52)
      INTPT=INTSRT
      LNBF12=I2SEC(ITRNC(LNBUF))
C
      DO 8 I=1,NGROUP
        CALL RREAD(ITAP52,IINT,INTOWP(NMAX),INTPT)
        IP=(I-1)*LNBUF
    5   CONTINUE
        N=IAD(IP+MAX+2)
        DO 6 J=IP+1,IP+N
          AINT(IAD(J))=VAL(J)
    6   CONTINUE
        ILAST=IAD(IP+MAX+1)
        IF (ILAST.LE.0) GO TO 7
C*************  CORRECTION FOR 1ST SECTOR BEING LABELED 1, NOT 0.
CTJL    IPT=3*LNBF12*(ILAST-1)
        IPT=3*LNBF12*(ILAST-1) + 1
        CALL RREAD(ITAP99,IAD(IP+1),LNBUF,IPT)
        CALL RREAD(ITAP99,VAL(IP+1),INTOWP(LNBUF),IPT+LNBF12)
        GO TO 5
    7   CONTINUE
        CALL RWRIT(ITAP52,IINT,INTOWP(NMAX),INTPT)
CC    WRITE(ITAPE6,791) (AINT(IQ),IQ=1,NMAX)
  791   FORMAT (//,(5(1PE15.5)))
C     WRITE(ITAPE6,"(' IN FINSRT',/,(5F10.5))") AINT
        INTPT=INTPT+I2SEC(INTOWP(NMAX))
    8 CONTINUE
      RETURN
      END
