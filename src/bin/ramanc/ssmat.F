      SUBROUTINE SSMAT(UA,UF,SSAF,SSFG)
      IMPLICIT REAL*8 (A-H,O-Z)
      DIMENSION UA(NBASIS,NBASIS,N3N),UF(NBASIS,NBASIS,3)
      DIMENSION SSAF(NTRI,N3N,3),SSFG(NTRI,3,3)
      COMMON/BASIS/NBASIS,NBFAO,NTRI,NTRI2,NBASQ
      COMMON/FUNCS/NATOMS,N3N,N3NP3,N3NX3
      COMMON/SECTF/ISF(153),IHF(153),IFF(153),IBF(153),IUF(153)
      COMMON/SIGNS/IOFF(466),IPRNT
      COMMON/TAPES/ITAP43,ITAP44
      DATA ZERO / 0.0D+00 /
    1 FORMAT(//,2X,' UA MATRIX, IABC = ',I5/)
    2 FORMAT(//,2X,' UF MATRIX, IXYZ = ',I5/)
    3 FORMAT(//,2X,' SSAF MATRIX'/)
    4 FORMAT(//,2X,' SSFG MATRIX'/)
 
C
      CALL RFILE(ITAP44)
C
      DO 101 IABC=1,N3N
      IUA=IUF(IABC)
      CALL RREAD(ITAP44,UA(1,1,IABC),NBASQ,IUA)
      IF(IPRNT.LE.3) GO TO 101
      WRITE(6,1) IABC
      CALL MATOUT(UA(1,1,IABC),NBASIS,NBASIS,NBASIS,NBASIS,6)
  101 CONTINUE
      DO 102 IXYZ=1,3
      IUX=IUF(IXYZ+N3N)
      CALL RREAD(ITAP44,UF(1,1,IXYZ),NBASQ,IUX)
      IF(IPRNT.LE.3) GO TO 102
      WRITE(6,2) IXYZ
      CALL MATOUT(UF(1,1,IXYZ),NBASIS,NBASIS,NBASIS,NBASIS,6)
  102 CONTINUE
C
C   FORM SSAF MATRIX
      DO 105 IABC=1,N3N
      DO 105 IXYZ=1,3
      IJ=0
      DO 104 I=1,NBASIS
      DO 104 J=1,I
      IJ=IJ+1
      VALU=ZERO
      DO 103 M=1,NBASIS
      VALU=VALU+UA(I,M,IABC)*UF(J,M,IXYZ)+UA(J,M,IABC)*UF(I,M,IXYZ)
  103 CONTINUE
      SSAF(IJ,IABC,IXYZ)=VALU
  104 CONTINUE
  105 CONTINUE
C
      IF(IPRNT.LE.3) GO TO 201
      WRITE(6,3)
      CALL MATOUT(SSAF,NTRI,N3NX3,NTRI,N3NX3,6)
C
C   FORM SSFG MATRIX
  201 CONTINUE
      DO 108 IXYZ=1,3
      DO 108 JXYZ=1,3
      IJ=0
      DO 107 I=1,NBASIS
      DO 107 J=1,I
      IJ=IJ+1
      VALU=ZERO
      DO 106 M=1,NBASIS
      VALU=VALU+UF(I,M,IXYZ)*UF(J,M,JXYZ)+UF(J,M,IXYZ)*UF(I,M,JXYZ)
  106 CONTINUE
      SSFG(IJ,IXYZ,JXYZ)=VALU
  107 CONTINUE
  108 CONTINUE
C
      IF(IPRNT.LE.3) GO TO 202
      WRITE(6,4)
      CALL MATOUT(SSFG,NTRI,9,NTRI,9,6)
C
  202 CONTINUE
      CALL SREW(ITAP44)
      RETURN
      END
