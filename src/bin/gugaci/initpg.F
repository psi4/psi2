      SUBROUTINE INITPG(VECTOR,SIGMA)
C
C
      IMPLICIT REAL*8 (A-H,O-Z)
      DIMENSION VECTOR(NWKSMX),SIGMA(NWKSMX)
      INTEGER REFWLK,BMAX,FWORD,PUWKT,ORBFRM
      LOGICAL PAGEIN,IEQJ
C
      INTEGER NR3,NR6,NW6
C10-13-90 COMMON /STATPG/ IR3(100),NR3(100),IR6(100),NR6(100),IW6(100)
C10-13-90             NW6(100),IPGS(100),IPGD(100),IPGO(100),IPGIJ(100)
C10-13-90             IPGOUT(100)
      COMMON /STATPG/ IR3(200),NR3(200),IR6(200),NR6(200),IW6(200)
     #,               NW6(200),IPGS(200),IPGD(200),IPGO(200),IPGIJ(200)
     #,               IPGOUT(200)
      COMMON /LEVEL/  ILEV
C
      COMMON /DIMS/ NBF,NSYM,NORBS,NROWS,NROWS4,NWKS,NWKS2,NLEVS
     *,             NROWOC,LEVFRM
     *,             NWKSMX,NLWKMX,NUWKMX,BMAX,NROOTS,ORBFRM
      COMMON /DIAG/ REP,FZCORE,EGUESS,ECI,REFWLK,MXITER,CNVERG,ICNVG
     *,             ITER,SQCDIF,CZERO,NROOT
      COMMON /TAPES/ITAP52,ITAPE5,ITAPE6,ITAP58,ITAP54,ITAP99,ITAP94
     *,             ITAPE3,ITAP95,ITAP96
      COMMON /OPS/  IGUESS,IPRINT,IRSTRT,IROOTI,IROOTF
      COMMON /LOOPS/NUWK,PUWKT,IUWK,JUWK,ITRAK,IPT1,IPT2
      COMMON /ALL/  ACF,D,CCF,LADT,ITR1,ITR2,IA,JA,ITYPE,ISEGT,LVFRM1
     *,             NLWKI,NLWKJ,IMAX,IMIN
      COMMON /PAGE/ IWORD3,IWORD4,PAGEIN,NOFFI,NOFFJ,NPASS,NWORDL,IWORD6
      COMMON /RSTRT/IBLCK1,INXT,LOWTRI,NDVDIT,IBLOCK
      COMMON /PAGDAT/IEQJ,IUWKSV,JUWKSV,NLWKI2,NLWKJ2,JWALK,IWALK,II,JJ
      IWORD3=1
      IWORD4=1
      IWORD6=1
      IEQJ=.TRUE.
      IWALK=0
      II=1
      JJ=1
      NLWKI2=2*NWKS2
      NWKMX2=NWKSMX
      RETURN
C
C-----------------------------------------------------------------PAGES
C
      ENTRY PAGES(vector,sigma)
C
C     WRITE(ITAPE3,*) ' ENTRY PAGES '
      IPGS(ILEV)=IPGS(ILEV)+1
      IF(IUWK.NE.JUWK) GO TO 210
C
C-----------------------------------------------------------------PAGED
C
      ENTRY PAGED(vector,sigma)
C
C     WRITE(ITAPE3,*) ' ENTRY PAGED '
      IPGD(ILEV)=IPGD(ILEV)+1
  200 IF(NLWKI.GT.NWKSMX) RETURN
      IUWKSV=IUWK
      JUWKSV=JUWK
      IEQJ=.TRUE.
      PAGEIN=.TRUE.
      NLWKI2=NLWKI+NLWKI
      NLWKJ2=NLWKI2
      NOFFI=PUWKT+IUWK-1
      NOFFJ=NOFFI
      IWALK=NOFFI+NOFFI
      II=1
      JJ=1
      FWORD=IWALK+IWORD6
      CALL WREADW(ITAP96,SIGMA,NLWKI2,FWORD,JUNK)
      IR6(ILEV)=IR6(ILEV)+1
      NR6(ILEV)=NR6(ILEV)+NLWKI2
      IF(NDVDIT.EQ.0) RETURN
      FWORD=IWALK+IWORD3
      CALL WREADW(ITAP99,VECTOR,NLWKI2,FWORD,JUNK)
      IR3(ILEV)=IR3(ILEV)+1
      NR3(ILEV)=NR3(ILEV)+NLWKI2
      RETURN
  210 CONTINUE
      IF((NLWKI+NLWKJ).GT.NWKSMX) RETURN
C
C-----------------------------------------------------------------PAGEO
C
      ENTRY PAGEO(vector,sigma)
C
C     WRITE(ITAPE3,*) ' ENTRY PAGEO '
      IPGD(ILEV)=IPGD(ILEV)+1
      IUWKSV=IUWK
      JUWKSV=JUWK
      PAGEIN=.TRUE.
      IEQJ=.FALSE.
      NLWKI2=NLWKI+NLWKI
      NLWKJ2=NLWKJ+NLWKJ
      NOFFI=PUWKT+IUWK-1
      NOFFJ=PUWKT+JUWK-1
      IWALK=NOFFI+NOFFI
      JWALK=NOFFJ+NOFFJ
      NOFFJ=NOFFJ-NLWKI
      FWORD=IWALK+IWORD6
      II=1
      CALL WREADW(ITAP96,SIGMA,NLWKI2,FWORD,JUNK)
      IR6(ILEV)=IR6(ILEV)+1
      NR6(ILEV)=NR6(ILEV)+NLWKI2
      FWORD=JWALK+IWORD6
      JJ=NLWKI+1
      CALL WREADW(ITAP96,SIGMA(JJ),NLWKJ2,FWORD,JUNK)
      IR6(ILEV)=IR6(ILEV)+1
      NR6(ILEV)=NR6(ILEV)+NLWKJ2
      FWORD=IWALK+IWORD3
      CALL WREADW(ITAP99,VECTOR,NLWKI2,FWORD,JUNK)
      IR3(ILEV)=IR3(ILEV)+1
      NR3(ILEV)=NR3(ILEV)+NLWKI2
      FWORD=JWALK+IWORD3
      CALL WREADW(ITAP99,VECTOR(JJ),NLWKJ2,FWORD,JUNK)
      IR3(ILEV)=IR3(ILEV)+1
      NR3(ILEV)=NR3(ILEV)+NLWKJ2
      RETURN
C
C----------------------------------------------------------------PAGEIJ
C
      ENTRY PAGEIJ(vector,sigma)
C
C   CHECK THAT SOMETHING HAS CHANGED
C
C     WRITE(ITAPE3,*) ' ENTRY PAGEIJ '
      IPGIJ(ILEV)=IPGIJ(ILEV)+1
      IF(IUWKSV.EQ.IUWK.AND.JUWKSV.EQ.JUWK) RETURN
      IF(IEQJ) GO TO 400
      IF(IUWKSV.EQ.IUWK) GO TO 310
      IF(JUWKSV.EQ.JUWK) GO TO 330
      PAGEIN=.FALSE.
      FWORD=IWALK+IWORD6
      CALL WWRITW(ITAP96,SIGMA(II),NLWKI2,FWORD,JUNK)
      IW6(ILEV)=IW6(ILEV)+1
      NW6(ILEV)=NW6(ILEV)+NLWKI2
      FWORD=JWALK+IWORD6
      CALL WWRITW(ITAP96,SIGMA(JJ),NLWKJ2,FWORD,JUNK)
      IW6(ILEV)=IW6(ILEV)+1
      NW6(ILEV)=NW6(ILEV)+NLWKJ2
      IF(IUWK.EQ.JUWK) GO TO 200
      GO TO 210
  310 CONTINUE
      FWORD=JWALK+IWORD6
      CALL WWRITW(ITAP96,SIGMA(JJ),NLWKJ2,FWORD,JUNK)
      IW6(ILEV)=IW6(ILEV)+1
      NW6(ILEV)=NW6(ILEV)+NLWKJ2
      IF((NLWKI+NLWKJ).LE.NWKSMX) GO TO 320
      FWORD=IWALK+IWORD6
      CALL WWRITW(ITAP96,SIGMA(II),NLWKI2,FWORD,JUNK)
      IW6(ILEV)=IW6(ILEV)+1
      NW6(ILEV)=NW6(ILEV)+NLWKI2
      PAGEIN=.FALSE.
      RETURN
  320 CONTINUE
      JJ=NLWKI+1
      JUWKSV=JUWK
      NLWKJ2=NLWKJ+NLWKJ
      NOFFJ=PUWKT+JUWK-1
      JWALK=NOFFJ+NOFFJ
      NOFFJ=NOFFJ-NLWKI
      FWORD=JWALK+IWORD6
      CALL WREADW(ITAP96,SIGMA(JJ),NLWKJ2,FWORD,JUNK)
      IR6(ILEV)=IR6(ILEV)+1
      NR6(ILEV)=NR6(ILEV)+NLWKJ2
      FWORD=JWALK+IWORD3
      CALL WREADW(ITAP99,VECTOR(JJ),NLWKJ2,FWORD,JUNK)
      IR3(ILEV)=IR3(ILEV)+1
      NR3(ILEV)=NR3(ILEV)+NLWKJ2
      RETURN
  330 CONTINUE
      FWORD=IWALK+IWORD6
      CALL WWRITW(ITAP96,SIGMA(II),NLWKI2,FWORD,JUNK)
      IW6(ILEV)=IW6(ILEV)+1
      NW6(ILEV)=NW6(ILEV)+NLWKI2
      IF(IUWK.NE.JUWK) GO TO 340
      IEQJ=.TRUE.
      II=JJ
      IWALK=JWALK
      IUWKSV=IUWK
      NLWKI2=NLWKJ2
      RETURN
  340 CONTINUE
      IF(NLWKI.LT.JJ) GO TO 350
      FWORD=JWALK+IWORD6
      CALL WWRITW(ITAP96,SIGMA(JJ),NLWKJ2,FWORD,JUNK)
      IW6(ILEV)=IW6(ILEV)+1
      NW6(ILEV)=NW6(ILEV)+NLWKJ2
      PAGEIN=.FALSE.
      GO TO 210
  350 IUWKSV=IUWK
      NOFFI=PUWKT+IUWK-1
      IWALK=NOFFI+NOFFI
      NLWKI2=NLWKI+NLWKI
      FWORD=IWALK+IWORD6
      II=1
      CALL WREADW(ITAP96,SIGMA(II),NLWKI2,FWORD,JUNK)
      IR6(ILEV)=IR6(ILEV)+1
      NR6(ILEV)=NR6(ILEV)+NLWKI2
      FWORD=IWALK+IWORD3
      CALL WREADW(ITAP99,VECTOR(II),NLWKI2,FWORD,JUNK)
      IR3(ILEV)=IR3(ILEV)+1
      NR3(ILEV)=NR3(ILEV)+NLWKI2
      RETURN
  400 CONTINUE
      IF(IUWK.NE.IUWKSV) GO TO 420
      IEQJ=.FALSE.
      IF(II.EQ.1) GO TO 405
      IF(NLWKJ.GE.II) GO TO 420
      JJ=1
      GOTO 410
  405 CONTINUE
      IF((NLWKI+NLWKJ).GT.NWKSMX) GO TO 420
      JJ=II+NLWKI
  410 JUWKSV=JUWK
      NOFFJ=PUWKT+JUWK-1
      JWALK=NOFFJ+NOFFJ
      NOFFJ=NOFFJ-NLWKI
      NLWKJ2=NLWKJ+NLWKJ
      FWORD=JWALK+IWORD6
      CALL WREADW(ITAP96,SIGMA(JJ),NLWKJ2,FWORD,JUNK)
      IR6(ILEV)=IR6(ILEV)+1
      NR6(ILEV)=NR6(ILEV)+NLWKJ2
      FWORD=JWALK+IWORD3
      CALL WREADW(ITAP99,VECTOR(JJ),NLWKJ2,FWORD,JUNK)
      IR3(ILEV)=IR3(ILEV)+1
      NR3(ILEV)=NR3(ILEV)+NLWKJ2
      RETURN
  420 CONTINUE
      PAGEIN=.FALSE.
      FWORD=IWALK+IWORD6
      CALL WWRITW(ITAP96,SIGMA(II),NLWKI2,FWORD,JUNK)
      IW6(ILEV)=IW6(ILEV)+1
      NW6(ILEV)=NW6(ILEV)+NLWKI2
      IF(IUWK.EQ.JUWK) GO TO 200
      GO TO 210
C
C----------------------------------------------------------------PAGEOUT
C
      ENTRY PAGEOT(vector,sigma)
C
C     WRITE(ITAPE3,*) ' ENTRY PAGEOUT '
      IPGOUT(ILEV)=IPGOUT(ILEV)+1
      PAGEIN=.FALSE.
      FWORD=IWALK+IWORD6
      CALL WWRITW(ITAP96,SIGMA(II),NLWKI2,FWORD,JUNK)
      IW6(ILEV)=IW6(ILEV)+1
      NW6(ILEV)=NW6(ILEV)+NLWKI2
      IF(IEQJ) RETURN
      FWORD=JWALK+IWORD6
      CALL WWRITW(ITAP96,SIGMA(JJ),NLWKJ2,FWORD,JUNK)
      IW6(ILEV)=IW6(ILEV)+1
      NW6(ILEV)=NW6(ILEV)+NLWKJ2
      RETURN
      END
