      SUBROUTINE yw(INT,C,S,IJADD,KADD,LADD,WTW,WTX,WTY,WAB,SS
     #,                 CI,SI,CJ,SJ,H1,H2,IJXX,NKLXX,IJWW,NKLWW
     #,                 KLXX,KLWW)
C
C
      IMPLICIT REAL*8 (A-H,O-Z)
CTJL 1               CI,SI,CJ,SJ,H1,H2,IJXX,NKLXX,IJWW,NKLWW,
CTJL 2               KLXX,KLWW
C
      real*8 sqrt2,sqrt3,sqt1p5,asqrt2,hsqrt3
      INTEGER ARR,TR1,TR2,ASM,OS,WTW,WTX,WTY,WAB,SS,SYMORB
      INTEGER BMAX,ORBFRM
      REAL*8 INT(NMAX),C(NWKS),S(NWKS)
C
      DIMENSION CI(1),CJ(1),SI(1),SJ(1),H1(1),H2(1)
      DIMENSION KADD(SYMORB),LADD(SYMORB),IJADD(NUMIJ),WTW(ORBFRM,NSYM)
      DIMENSION WTX(ORBFRM,NSYM),WTY(ORBFRM),WAB(ORBFRM),SS(NORBS)
      DIMENSION IJXX(NUMIJ ),NKLXX(NSYM,ORBFRM),IJWW(NUMIJ )
      DIMENSION NKLWW(NSYM,ORBFRM),KLXX(1),KLWW(1)
C
      COMMON /COEFS/  A,B,INTAL,INTAU,INTB,INTAD,INTBD
      COMMON /DIMS/ NBF,NSYM,NORBS,NROWS,NROWS4,NWKS,NWKS2,NLEVS
     *,             NROWOC,LEVFRM
     *,             NWKSMX,NLWKMX,NUWKMX,BMAX,NROOTS,ORBFRM
      COMMON /INTS/   NMAX,NMAX2,NGROUP,NBLKOC,NUMIJ,SYMORB,INTSRT
C  UNIVERSAL IDENTITY OF THE OBJECTS IN THESE COMMON
C     COMMON /ALL/ ARR,VAL1,VAL2,VAL3,ITR1,ITR2,IA,JA,ITYPE,ISEGT
C    *,LVFRM1,NLWKI,NLWKJ,IMAX,IMIN
C     COMMON /SYMM/ JSM,JFSYM,IFSYM,MAXSYM(8),MINSYM(8),ISMOFF(8)
C    #,             NUMSYM(8)
      COMMON /SYMM/ ASM,JS,IS,MX(8),MN(8),OS(8),NUMSYM(8)
      COMMON /TAPES/ITAP52,ITAPE5,ITAPE6,ITAP58,ITAP54,ITAP99,ITAP94
     *,             ITAPE3,ITAP95,ITAP96
      COMMON /ALL/VAL1,VAL2,VAL3,ARR,TR1,TR2,IA,JA,M,ISEG,N,N1,N2
     *,           IMAX,IMIN
      COMMON /COUNT/  ICOUNT,IXX4,IXX5,IXX6,IXX8,IWW4,IWW5,IWW6,IWW8
     #,               IWX7,IXW9,IXY3,IXY16,IXY18,IXY22,IWY2,IWY15,IWY17
     #,               IWY21,IYX20,IYW19
      COMMON /XX4X/   NIJVIR,NREFS
      COMMON /MINMAX/ IMING,IMAXG,JMING,JMAXG
      common /ets/ isym
      common /sqrts/ sqrt2,sqrt3,sqt1p5,asqrt2,hsqrt3
      REAL*8 VAL1,VAL2,VAL3
C
C
cets111090      SQRT2=DSQRT(2.0D+00)
cets111090      SQRT3=DSQRT(3.0D+00)
cets111090      SQT1P5=DSQRT(1.5D+00)
cets111090      ASQRT2=1.0D+00/SQRT2
cets111090      HSQRT3=0.5D+00*DSQRT(3.0D+00)
cets110990      RETURN
C
C******************************** YW ***********************************
C
cets110990      ENTRY YW
C
      IYW19=IYW19+1
      A=VAL1
      B=VAL1*VAL2
      INTAL=TR1
      INTB=TR2
      IF (IS.NE.0) GO TO 810
      IF (JS.NE.0) GO TO 802
C
C     ----- IS.EQ.0, JS.EQ.0 -----
C
      NUMI=NUMSYM(1)
      IF (NUMI.LT.1) RETURN
      CALL HI    (H1,0,NUMI,int,ijadd,kadd,ladd,h2)
      CALL SQUARW(C(JA),CI,NUMI)
      CALL APBC  (S(IA),H1,CI,1,NUMI,NUMI)
      CALL EBC   (SI,H1,C(IA),NUMI,1,NUMI)
      CALL FOLDW (S(JA),SI,NUMI)
      RETURN
C
C     ----- IS.EQ.0, JS.NE.0 -----
C
  802 CONTINUE
      NUMI=NUMSYM(JS+1)
      IF (NUMI.LT.1) RETURN
      NUMJ=NUMSYM(1)
      IF (NUMJ.LT.1) RETURN
      JAS=JA+WTW(MN(JS+1),JS+1)
      CALL HI    (H1,JS,NUMI,int,ijadd,kadd,ladd,h2)
      CALL APBCT (S(IA),H1,C(JAS),1,NUMI,NUMJ)
C     CALL APBTCT(S(JAS),C(IA),H1,NUMJ,1,NUMI)
      CALL ATPBC(S(JAS),H1,C(IA),NUMI,1,NUMJ)
      RETURN
C
C     ----- IS.NE.0 -----
C
  810 CONTINUE
      IF (JS.NE.0) GO TO 811
C
C     ----- IS.NE.0, JS.EQ.0 -----
C
      NUMI=NUMSYM(IS+1)
      IF (NUMI.LT.1) RETURN
      JAS=JA+WAB(MN(IS+1))
      CALL HI    (H1,IS,NUMI,int,ijadd,kadd,ladd,h2)
      CALL SQUARW(C(JAS),CI,NUMI)
      CALL APBC  (S(IA),H1,CI,1,NUMI,NUMI)
      CALL EBC   (SI,H1,C(IA),NUMI,1,NUMI)
      CALL FOLDW (S(JAS),SI,NUMI)
      RETURN
C
C     ----- IS.NE.0, JS.NE.0 -----
C
  811 CONTINUE
      ISYM=IEOR(IS,JS)
      NUMJ=NUMSYM(IS+1)
      IF (NUMJ.LT.1) RETURN
      NUMI=NUMSYM(ISYM+1)
      IF (NUMI.LT.1) RETURN
      IF (ISYM.LT.IS) GO TO 812
      JAS=JA+WTW(MN(ISYM+1),JS+1)
      CALL HI    (H1,ISYM,NUMI,int,ijadd,kadd,ladd,h2)
      CALL APBCT (S(IA),H1,C(JAS),1,NUMI,NUMJ)
C     CALL APBTCT(S(JAS),C(IA),H1,NUMJ,1,NUMI)
      CALL ATPBC(S(JAS),H1,C(IA),NUMI,1,NUMJ)
      RETURN
  812 CONTINUE
      JAS=JA+WTW(MN(IS+1),JS+1)
      CALL HI    (H1,ISYM,NUMI,int,ijadd,kadd,ladd,h2)
      CALL APBC  (S(IA),H1,C(JAS),1,NUMI,NUMJ)
      CALL APBC  (S(JAS),H1,C(IA),NUMI,1,NUMJ)
      RETURN
C
      END
