      SUBROUTINE START(DVDMAT,INTS,SIGMA,VECTOR,root,dvdvec,ndvdmx)
C
C
      IMPLICIT REAL*8 (A-H,O-Z)
      real*8 root(nroots),dvdvec(ndvdmx,nroots)
      integer ndvdmx
      REAL*8 DVDMAT(LOWTRI),SIGMA(NWKSMX),VECTOR(NWKSMX)
      REAL*8 INTS(NMAX)
      INTEGER BMAX,REFWLK,ORBFRM,SYMORB
      LOGICAL PAGEIN
      COMMON /TAPES/ITAP52,ITAPE5,ITAPE6,ITAP58,ITAP54,ITAP99,ITAP94
     *,             ITAPE3,ITAP95,ITAP96
      COMMON /DIMS/ NBF,NSYM,NORBS,NROWS,NROWS4,NWKS,NWKS2,NLEVS
     *,             NROWOC,LEVFRM
     *,             NWKSMX,NLWKMX,NUWKMX,BMAX,NROOTS,ORBFRM
      COMMON /OPS/  IGUESS,IPRINT,IRSTRT,IROOTI,IROOTF
      COMMON /DIAG/ REP,FZCORE,EGUESS,ECI,REFWLK,MXITER,CNVERG,ICNVG
     *,             ITER,SQCDIF,CZERO,NROOT
      COMMON /PAGE/ IWORD3,IWORD4,PAGEIN,NOFFI,NOFFJ,NPASS,NWORDL,IWORD6
      COMMON /RSTRT/  IBLCK1,INXT,LOWTRI,NDVDIT,IBLOCK
      COMMON /INTS/   NMAX,NMAX2,NGROUP,NBLKOC,NUMIJ,SYMORB,INTSRT
C
      DATA IFLAG1,IFLAG2/-99999999,0/
CTJL  DATA IFLAG1,IFLAG2/X'ABCDEF01',0/
      INXT=1
      ITER=0
      NDVDIT=0
      IBLCK1=1
      NWKMX2=NWKSMX*2
      return
cets110990      IF(IRSTRT.NE.0) ITAP96=96
CTJL  CALL RFILE(ITAP96)
CTJL  CALL SREW(ITAP96)
cets110990      IF(IRSTRT.LE.0) RETURN
cets110990      READ(ITAP95)NDVDIT,ITER,NROOT
cets110990      READ(ITAP95) DVDMAT
cets110990      READ(ITAP95) IBLCK1,INXT
cets110990      READ(ITAP95) IFLAG
cets110990      KSIZE=ITER*(ITER-1)/2
cets110990      KSIZE=NDVDIT*(NDVDIT-1)/2
cets110990      WRITE(ITAPE6,1)
cets110990    1 FORMAT(1X,'RESTART DATA'/' NDVDIT ITER NROOT IBLCK1 INXT')
cets110990      WRITE(ITAPE6,2)NDVDIT,ITER,NROOT,IBLCK1,INXT
cets110990    2 FORMAT(1X,I4,I6,I5,I7,I6)
cets110990      WRITE(ITAPE6,3)
cets110990    3 FORMAT(1X,'DAVIDSON MATRIX')
cets110990      K=0
cets110990      DO 5 I=1,NDVDIT-1
cets110990         WRITE(ITAPE6,4)(DVDMAT(J+K),J=1,I)
cets110990    4    FORMAT(5(1X,G15.9))
cets110990         K=K+I
cets110990    5 CONTINUE
cets110990      DO 10 I=KSIZE+1,LOWTRI
cets110990   10 DVDMAT(I)=0.0D+00
cets110990      IWORD4=1+NDVDIT*NWKS2
cets110990      IWORD3=IWORD4-NWKS2
cets110990      IF(INXT.LE.NORBS) GO TO 40
cets110990      WRITE(ITAPE6,20)
cets110990   20 FORMAT(1X,'ITERATION HAD BEEN COMPLETED. SIMPLY DO DAVIDSON.')
cets110990      ECI=EGUESS
cets110990      CALL DAVIDS(vector,sigma,root,dvdvec,dvdmat,ndvdmx)
cets110990      INXT=1
cets110990      RETURN
cets110990   40 CONTINUE
C*************** TJL
cets110990      WRITE(ITAPE3,*) ' IFLAG,IFLAG1 = ',IFLAG,IFLAG1
cets110990      IF(IFLAG.NE.IFLAG1) GO TO 70
cets110990C   PROGRAM DIED WHILE WRITING 106=>104, ITERATION SPOILED
cets110990      WRITE(ITAPE6,41)
cets110990   41 FORMAT(1X,'PROGRAM DIED WHILE WRITTING, ITERATION RESTARTED.')
cets110990      INXT=1
cets110990      IBLCK1=1
cets110990      DO 50 I=1,NWKSMX
cets110990   50 SIGMA(I)=0.0D+00
cets110990      FWORD=IWORD4
cets110990      NWORD=NWKMX2
cets110990      DO 60 I=1,NPASS
cets110990         IF(I.EQ.NPASS) NWORD=NWORDL
cets110990         CALL WWRITW(ITAP94,SIGMA,NWORD,FWORD,FWORD)
cets110990   60 CONTINUE
cets110990      RETURN
cets110990   70 NWORD=NWKMX2
cets110990      FWORD=IWORD4
cets110990      FWORD2=1
cets110990      DO 80 I=1,NPASS
cets110990         IF(I.EQ.NPASS) NWORD=NWORDL
cets110990         CALL WREADW(ITAP94,SIGMA,NWORD,FWORD,FWORD)
cets110990         CALL WWRITW(ITAP96,SIGMA,NWORD,FWORD2,FWORD2)
cets110990   80 CONTINUE
cets110990      IF(NWKS.LE.NWKSMX) CALL WREADW(ITAP99,VECTOR,NWKS2,IWORD3
cets110990     #,                             JUNK)
cets110990      RETURN
cets110990
cets110990      ENTRY SAVE(sigma)
cets110990      BACKSPACE ITAP95
cets110990      WRITE(ITAP95) IBLOCK,INXT
cets110990      WRITE(ITAP95) IFLAG1
cets110990      BACKSPACE ITAP95
cets110990      FWORD=1
cets110990      FWORD2=IWORD4
cets110990      NWORD=NWKMX2
cets110990      DO 110 I=1,NPASS
cets110990         IF(I.EQ.NPASS) NWORD=NWORDL
cets110990         CALL WREADW(ITAP96,SIGMA,NWORD,FWORD,FWORD)
cets110990         CALL WWRITW(ITAP94,SIGMA,NWORD,FWORD2,FWORD2)
cets110990  110 CONTINUE
cets110990      WRITE(ITAP95) IFLAG2
cets110990      BACKSPACE ITAP95
cets110990      RETURN
      END
