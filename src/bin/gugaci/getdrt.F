      SUBROUTINE GETDRT(LEVPT,      AVAL,BVAL,ROWSYM,ARC
     #,                 NLWKS,              WEIGHT,WAB,WTW,WTX
     #,                 WTY,KADD,LADD,IJADD,IJGRP,ININT,INEXT,JMNNXT
     #,                 JMXNXT,NINGRP,ORBSYM,IMNGRP,IMXGRP,JMNGRP,JMXGRP
     #,                 IJXX,KLXX,NKLXX,IJWW,KLWW,NKLWW,END)
C
C
      IMPLICIT INTEGER (A-Z)
CTJL 1               WTX,WTY,KADD,LADD,IJADD,IJGRP,ININT,INEXT,JMNNXT,
CTJL 2               JMXNXT,NINGRP,ORBSYM,IMNGRP,IMXGRP,JMNGRP,JMXGRP,
CTJL 3               IJXX,KLXX,NKLXX,IJWW,KLWW,NKLWW
      REAL*8 CIVER,DRTVER,Q
C
      COMMON /OPS/  IGUESS,IPRINT,IRSTRT,IROOTI,IROOTF,I34X
      COMMON /LBLS/ LBLINT(26),LBLDRT(26),CIVER,DRTVER
      COMMON /TAPES/ITAP52,ITAPE5,ITAPE6,ITAP58,ITAP54,ITAP99,ITAP94
     *,             ITAPE3,ITAP95,ITAP96
      COMMON /DIMS/ NBF,NSYM,NORBS,NROWS,NROWS4,NWKS,NWKS2,NLEVS
     *,             NROWOC,LEVFRM
     *,             NWKSMX,NLWKMX,NUWKMX,BMAX,NROOTS,ORBFRM
      COMMON /ALL/  Q(3),IQ,IX(6),LVFRM1,NLWKI,NLWKJ,IMAX,IMIN
      COMMON /INTS/   NMAX,NMAX2,NGROUP,NBLKOC,NUMIJ,SYMORB,INTSRT
      COMMON /SYMM/ JSM,JFSYM,IFSYM,MAXSYM(8),MINSYM(8),ISMOFF(8)
     #,             NUMSYM(8)
      COMMON /XX4X/   NIJVIR,NREFS
C
      DIMENSION LEVPT(NLEVS),AVAL(NROWS),BVAL(NROWS)
      DIMENSION ARC(NROWS4),NLWKS(NROWS),ROWSYM(NROWS)
      DIMENSION                WEIGHT(NROWS4),WAB(LVFRM1)
      DIMENSION WTW(LVFRM1,NSYM),WTX(LVFRM1,NSYM),WTY(LVFRM1)
      DIMENSION IJADD(NUMIJ),KADD(SYMORB),LADD(SYMORB)
      DIMENSION IJGRP(NUMIJ),ININT(NORBS),INEXT(NORBS)
      DIMENSION JMNNXT(NORBS),JMXNXT(NORBS),ORBSYM(NORBS)
      DIMENSION NINGRP(NGROUP),IMNGRP(NGROUP),IMXGRP(NGROUP)
      DIMENSION JMNGRP(NGROUP),JMXGRP(NGROUP)
      DIMENSION IJXX(NUMIJ ),KLXX(NIJVIR),NKLXX(NSYM,ORBFRM)
      DIMENSION IJWW(NUMIJ ),KLWW(NIJVIR),NKLWW(NSYM,ORBFRM)
C
      CALL WREADW(ITAP58,KADD,SYMORB,END,END)
      CALL WREADW(ITAP58,LADD,SYMORB,END,END)
      CALL WREADW(ITAP58,IJADD,NUMIJ,END,END)
      CALL WREADW(ITAP58,IJGRP,NUMIJ,END,END)
      CALL WREADW(ITAP58,ININT,NORBS,END,END)
      CALL WREADW(ITAP58,INEXT,NORBS,END,END)
      CALL WREADW(ITAP58,JMNNXT,NORBS,END,END)
      CALL WREADW(ITAP58,JMXNXT,NORBS,END,END)
      CALL WREADW(ITAP58,NINGRP,NGROUP,END,END)
      END=END+NBF
      CALL WREADW(ITAP58,ORBSYM,NORBS,END,END)
      END=END+NBF+NREFS*NBF+NORBS
      CALL WREADW(ITAP58,LEVPT,NLEVS,END,END)
      END=END+NLEVS
      CALL WREADW(ITAP58,AVAL,NROWS,END,END)
      CALL WREADW(ITAP58,BVAL,NROWS,END,END)
      CALL WREADW(ITAP58,ROWSYM,NROWS,END,END)
      CALL WREADW(ITAP58,ARC,NROWS4,END,END)
      CALL WREADW(ITAP58,NLWKS,NROWS,END,END)
      CALL WREADW(ITAP58,WEIGHT,NROWS4,END,END)
      CALL WREADW(ITAP58,WAB,LVFRM1,END,END)
      CALL WREADW(ITAP58,WTW,LVFRM1*NSYM,END,END)
      CALL WREADW(ITAP58,WTX,LVFRM1*NSYM,END,END)
      CALL WREADW(ITAP58,WTY,LVFRM1,END,END)
      CALL WREADW(ITAP58,IJXX,NUMIJ,END,END)
      CALL WREADW(ITAP58,KLXX,NIJVIR,END,END)
      CALL WREADW(ITAP58,NKLXX,NSYM*ORBFRM,END,END)
      CALL WREADW(ITAP58,IJWW,NUMIJ,END,END)
      CALL WREADW(ITAP58,KLWW,NIJVIR,END,END)
      CALL WREADW(ITAP58,NKLWW,NSYM*ORBFRM,END,END)
C
C
C     WRITE (ITAPE6,*) ' KADD '
C     WRITE (ITAPE6,710) KADD
C     WRITE (ITAPE6,*) ' LADD '
C     WRITE (ITAPE6,710) LADD
C     WRITE (ITAPE6,*) ' IJADD'
C     WRITE (ITAPE6,710) IJADD
C     WRITE (ITAPE6,*) ' IJGRP'
C     WRITE (ITAPE6,710) IJGRP
C     WRITE (ITAPE6,*) ' ININT'
C     WRITE (ITAPE6,710) ININT
C     WRITE (ITAPE6,*) ' INEXT'
C     WRITE (ITAPE6,710) INEXT
C     WRITE (ITAPE6,*) ' JMNNXT'
C     WRITE (ITAPE6,710) JMNNXT
C     WRITE (ITAPE6,*) ' JMXNXT'
C     WRITE (ITAPE6,710) JMXNXT
C     WRITE (ITAPE6,*) ' NINGRP'
C     WRITE (ITAPE6,710) NINGRP
C     WRITE (ITAPE6,*) ' ORBSYM'
C     WRITE (ITAPE6,710) ORBSYM
C     WRITE (ITAPE6,*) ' LEVPT'
C     WRITE (ITAPE6,710) LEVPT
C     WRITE (ITAPE6,*) ' AVAL '
C     WRITE (ITAPE6,710) AVAL
C     WRITE (ITAPE6,*) ' BVAL '
C     WRITE (ITAPE6,710) BVAL
C     WRITE (ITAPE6,*) ' ROWSYM'
C     WRITE (ITAPE6,710) ROWSYM
C     WRITE (ITAPE6,*) ' ARC  '
C     WRITE (ITAPE6,710) ARC
C     WRITE (ITAPE6,*) ' NLWKS'
C     WRITE (ITAPE6,710) NLWKS
C     WRITE (ITAPE6,*) ' WIEGHT'
C     WRITE (ITAPE6,710) WEIGHT
C     WRITE (ITAPE6,*) ' WAB  '
C     WRITE (ITAPE6,710) WAB
C     WRITE (ITAPE6,*) ' WTW  '
C     WRITE (ITAPE6,710) WTW
C     WRITE (ITAPE6,*) ' WTX  '
C     WRITE (ITAPE6,710) WTX
C     WRITE (ITAPE6,*) ' WTY  '
C     WRITE (ITAPE6,710) WTY
C     WRITE (ITAPE6,*) ' IJXX '
C     WRITE (ITAPE6,710) IJXX
C     WRITE (ITAPE6,*) ' KLXX '
C     WRITE (ITAPE6,710) KLXX
C     WRITE (ITAPE6,*) ' NKLXX'
C     WRITE (ITAPE6,710) NKLXX
C     WRITE (ITAPE6,*) ' IJWW '
C     WRITE (ITAPE6,710) IJWW
C     WRITE (ITAPE6,*) ' KLWW '
C     WRITE (ITAPE6,710) KLWW
C     WRITE (ITAPE6,*) ' NKLWW'
C     WRITE (ITAPE6,710) NKLWW
C
C
  710 FORMAT (20I5)
    9 CONTINUE
      NFRMIN=LEVPT(LEVFRM)+1
      NLWKMX=0
      DO 10 I=NFRMIN,NROWOC
         IF(NLWKS(I).GT.NLWKMX) NLWKMX=NLWKS(I)
   10 CONTINUE
      IBLK=1
      IMXGRP(IBLK)=NORBS
      JMXGRP(IBLK)=NORBS
      DO 25 I=NORBS,1,-1
         DO 20 J=I,1,-1
            IJ=I*(I-1)/2+J
C     PRINT '(' I,J',2I3,' IBLK AND IJGRP(IJ)',2I3)',I,J,IBLK,IJGRP(IJ)
            IF(IJGRP(IJ).EQ.IBLK) GO TO 20
            IF (I.EQ.J.AND.I.NE.IMXGRP(IBLK)) GO TO 22
            IMNGRP(IBLK)=I
            JMNGRP(IBLK)=J+1
            GO TO 24
  22        CONTINUE
            IMNGRP(IBLK)=I+1
            JMNGRP(IBLK)=1
  24        CONTINUE
            IBLK=IBLK+1
            IMXGRP(IBLK)=I
            JMXGRP(IBLK)=J
  20     CONTINUE
  25  CONTINUE
      IMNGRP(NGROUP)=1
      JMNGRP(NGROUP)=1
C     PRINT '(' IMX ',(20I3))',IMXGRP
C     PRINT '(' IMN ',(20I3))',IMNGRP
C     PRINT '(' JMX ',(20I3))',JMXGRP
C     PRINT '(' JMN ',(20I3))',JMNGRP
      IF(IBLK.EQ.NGROUP) GO TO 35
      WRITE(ITAPE6,30)IBLK,NGROUP
  30  FORMAT(1H ,'ERROR IN NUMBER OF BLOCKS,IBLK=',I3,' NGROUP=',I3)
      CALL MABORT
  35  CONTINUE
      DO 40 I=1,NSYM
         MINSYM(I)=1000
   40 MAXSYM(I)=0
      MINSYM(1)=1
      ISM=ORBSYM(1)
      DO 45 I=2,LVFRM1
         IF(ORBSYM(I).EQ.ISM) GO TO 45
         MAXSYM(ISM)=I-1
         ISM=ORBSYM(I)
         MINSYM(ISM)=I
   45 CONTINUE
      MAXSYM(ISM)=LVFRM1
      IF(IPRINT.GT.1) WRITE(ITAPE6,50) (MINSYM(J),J=1,NSYM)
   50 FORMAT(1H ,'MINSYM = ',8I9)
      IF(IPRINT.GT.1) WRITE(ITAPE6,55) (MAXSYM(J),J=1,NSYM)
   55 FORMAT(1H ,'MAXSYM = ',8I9)
      RETURN
      END
