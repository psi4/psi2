      SUBROUTINE ORTHOG(VEC1,VEC2,PROD,NVEC,ANORM)
C
C
      IMPLICIT REAL*8 (A-H,O-Z)
      DIMENSION VEC1(NWKSMX),VEC2(NWKSMX),PROD(NVEC)
      INTEGER BMAX,ORBFRM
      LOGICAL PAGEIN
      COMMON /TAPES/ITAP52,ITAPE5,ITAPE6,ITAP58,ITAP54,ITAP99,ITAP94
     *,             ITAPE3,ITAP95,ITAP96
      COMMON /DIMS/ NBF,NSYM,NORBS,NROWS,NROWS4,NWKS,NWKS2,NLEVS
     *,             NROWOC,LEVFRM
     *,             NWKSMX,NLWKMX,NUWKMX,BMAX,NROOTS,ORBFRM
      COMMON /PAGE/ IWORD3,IWORD4,PAGEIN,NOFFI,NOFFJ,NPASS,NWORDL,IWORD6
      NWKMX2=NWKSMX+NWKSMX
      NWORD=NWKMX2
      DO 10 I=1,NVEC
   10 PROD(I)=0.0D+00
      IWORD=1+(NVEC-1)*NWKS2
      IWORD1=1
      DO 40 K=1,NPASS
         IF(K.EQ.NPASS) NWORD=NWORDL
         NLOOP=NWORD/2
         IF(NPASS.GT.1) CALL WREADW(ITAP99,VEC2,NWORD,IWORD,IWORD)
         IWORD2=IWORD1
         DO 30 I=1,NVEC-1
            CALL WREADW(ITAP99,VEC1,NWORD,IWORD2,JUNK)
            Z=0.0D+00
            DO 20 L=1,NLOOP
   20       Z=Z+VEC1(L)*VEC2(L)
            PROD(I)=PROD(I)+Z
   30    IWORD2=IWORD2+NWKS2
   40 IWORD1=IWORD1+NWKMX2
      IWORD=1+(NVEC-1)*NWKS2
      IWORD1=1
      NWORD=NWKMX2
CC    PRINT *,'PRODUCT=',PROD
      DO 70 K=1,NPASS
         IF(K.EQ.NPASS) NWORD=NWORDL
         NLOOP=NWORD/2
         IF(NPASS.GT.1) CALL WREADW(ITAP99,VEC2,NWORD,IWORD,JUNK)
         IWORD2=IWORD1
         RENORM=ANORM
         DO 60 I=1,NVEC-1
            CALL WREADW(ITAP99,VEC1,NWORD,IWORD2,JUNK)
            Z=PROD(I)
            RENORM=1.0D+00/DSQRT(RENORM-Z*Z)
            DO 50 L=1,NLOOP
   50       VEC2(L)=(VEC2(L)-Z*VEC1(L))*RENORM
            RENORM=1.0D+00
   60    IWORD2=IWORD2+NWKS2
         CALL WWRITW(ITAP99,VEC2,NWORD,IWORD,IWORD)
CC    PRINT *,'FINAL VECTOR'
CC    PRINT *,VEC2
   70 IWORD1=IWORD1+NWKMX2
      RETURN
      END
