      SUBROUTINE VECOUT(C,S,E,NDVDMX,CONVGD)
C
C
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*8 E(NDVDMX,NROOTS),C(NWKSMX),S(NWKSMX)
      INTEGER REFWLK,OFFSET,BMAX,ORBFRM,FWORD,FWORD2
      LOGICAL PAGEIN
      LOGICAL CONVGD
C
      COMMON /DIMS/ NBF,NSYM,NORBS,NROWS,NROWS4,NWKS,NWKS2,NLEVS
     *,             NROWOC,LEVFRM
     *,             NWKSMX,NLWKMX,NUWKMX,BMAX,NROOTS,ORBFRM
      COMMON /DIAG/ REP,FZCORE,EGUESS,ECI,REFWLK,MXITER,CNVERG,ICNVG
     *,             ITER,SQCDIF,CZERO,NROOT
      COMMON /TAPES/ITAP52,ITAPE5,ITAPE6,ITAP58,ITAP54,ITAP99,ITAP94
     *,             ITAPE3,ITAP95,ITAP96
      COMMON /OPS/  IGUESS,IPRINT,IRSTRT,IROOTI,IROOTF
      COMMON /PAGE/ IWORD3,IWORD4,PAGEIN,NOFFI,NOFFJ,NPASS,NWORDL,IWORD6
      COMMON /LBLS/ IDENT(26),LBLDRT(26),CIVER,DRTVER
      COMMON /RSTRT/IBLCK1,INXT,LOWTRI,NDVDIT,IBLOCK
C
      DATA SMALL /0.022D+00/
C
      NWKMX2=NWKSMX+NWKSMX
C
C   CREATE COMPLETE NORMALIZED VECTOR
      NWORD=NWKMX2
      OFFSET=IROUND(112)+1+(NROOT-1)*NWKS2
      FWORD2=1
      ICOUNT=0
      DO 50 K=1,NPASS
         IF(K.EQ.NPASS) NWORD=NWORDL
         NLOOP=NWORD/2
         DO 20 I=1,NLOOP
   20    C(I)=0.0D+00
         FWORD=FWORD2
         DO 40 I=1,NDVDIT
            CALL WREADW(ITAP99,S,NWORD,FWORD,LWORD)
            FWORD=FWORD+NWKS2
            EI=E(I,NROOT)
            DO 30 J=1,NLOOP
   30       C(J)=C(J)+EI*S(J)
   40    CONTINUE
C
C     ----- FIND ALL COEFFICIENTS GREATER THAN 'SMALL' -----
C
         IF (.NOT.CONVGD) GO TO 46
         DO 44 J=1,NLOOP
            ICOUNT=ICOUNT+1
            IF (ABS(C(J)).GT.SMALL) WRITE(ITAPE6,43)ICOUNT,C(J)
   44    CONTINUE
   43    FORMAT('   WALK #',I8,' COEFFICIENT ',F20.10)
C
   46    CONTINUE
      CALL SREW(ITAP54)
CTJL  WRITE(*,*) ' IX,EGUESS,ECI,CZERO '
CTJL  WRITE(*,*)  IX,EGUESS,ECI,CZERO
      CALL NCDLBL(ITAP54,IDENT,LBLDRT,REFWLK,IX,IX,EGUESS,ECI,CZERO)
C
C
         CALL WWRITW(ITAP54,C,NWORD,OFFSET,JUNK)
         OFFSET=OFFSET+NWORD
         FWORD2=FWORD2+NWORD
   50 CONTINUE
CTJL
         CALL RCLOSE(ITAP54,3)
         CALL RFILE(ITAP54)
CTJL
      IF(NROOT.GT.1) RETURN
C     CALL SREW(ITAP54)
C     WRITE(*,*) ' IX,EGUESS,ECI,CZERO '
C     WRITE(*,*)  IX,EGUESS,ECI,CZERO
C     CALL NCDLBL(ITAP54,IDENT,LBLDRT,IX,IX,IX,EGUESS,ECI,CZERO)
      RETURN
      END
