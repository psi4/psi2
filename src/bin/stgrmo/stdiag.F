      SUBROUTINE STDIAG(NIJ,C,EIGC,EIVC,FV1,FV2,LBLI,BUFI,EIVT,NEVT,
     1                  NORD)
      IMPLICIT REAL*8 (A-H,O-Z)
      CHARACTER*3 ISMAT
      CHARACTER*3 ISYM,JSYM
      DIMENSION NIJ(NTRI,2),C(NDTRI)
      DIMENSION EIGC(NIND),EIVC(NIND,NIND),FV1(NIND),FV2(NIND)
      DIMENSION LBLI(MAXBF4),BUFI(MAXBF2)
      DIMENSION EIVT(NIND),NEVT(NIND),NORD(NIND)
      COMMON/BASIS/NBASIS,NTRI
      COMMON/LIMIT/MAXBAS,MAXBUF,MAXBF2,MAXBF4
      COMMON/ROOTS/NROOT,NPAIR
      COMMON/SDATA/ISMAT(8,8)
      COMMON/SIGNS/IOFF(32897),IPRNT
      COMMON/SYMTR/ISTYPE,MOSYM(256),MONUM(256)
      COMMON/TAPES/ITAP35,ITAP91,ITAP92
      COMMON/CI102/NIND,NDEP,NDTRI
      DATA CLIMIT / 1.0D-5 /
    1 FORMAT(//,2X,' C MATRIX'/)
    2 FORMAT(//,2X,' THE EIGENVALUES AND EIGENVECTORS OF THE C MATRIX'/)
    3 FORMAT(//,2X,' ROOT NUMBER     = ',I5/)
    4 FORMAT(2X,' EIGENVALUE      = ',3X,F20.10/)
    5 FORMAT(7X,'I',6X,'IX',14X,'JX',17X,'EIGENVECTOR',10X,'EIGENVECTOR*
     1*2'/)
    6 FORMAT(3X,I5,3X,I5,'(',I3,A3,')',3X,I5,'(',I3,A3,')',1X,F20.10,
     1 1X,F20.10)
    7 FORMAT(/)
C
CC    CALL SREW(ITAP91)
CC    CALL ZERO(C,NDTRI)
CC200 CONTINUE
CC    CALL SREAD(ITAP91,LBLI,MAXBF4)
CC    DO 101 M=1,MAXBUF
CC    II=LBLI(M+M-1)
CC    IF(II.EQ.0) GO TO 300
CC    JJ=LBLI(M+M)
CC    IIJJ=IOFF(II)+JJ
CC    C(IIJJ)=BUFI(MAXBUF+M)
CC101 CONTINUE
CC    GO TO 200
CC300 CONTINUE
CC    CALL SREW(ITAP91)
C
      IF(IPRNT.LE.2) GO TO 202
      WRITE(6,1)
      CALL PRINT(C,NDTRI,NIND,6)
  202 CONTINUE
C
C   DIAGONALIZE THE C MATRIX
      CALL RSP(NIND,NIND,NDTRI,C,EIGC,1,EIVC,FV1,FV2)
      IF(IPRNT.LE.2) GO TO 203
      WRITE(6,2)
      CALL EIVOUT(EIVC,EIGC,NIND,NIND,NIND,NIND,6)
  203 CONTINUE
C
C   LIST LOW-LYING EIGENVALUES AND THEIR COMPONENTS
      IF(NROOT.GT.NIND) NROOT=NIND
      IF(NPAIR.GT.NIND) NPAIR=NIND
C
      DO 105 II=1,NROOT
      WRITE(6,3) II
      WRITE(6,4) EIGC(II)
      CALL ZERO(EIVT,NIND)
      CALL IZERO(NEVT,NIND)
      III=0
      DO 102 I=1,NIND
      TEMP=EIVC(I,II)
      IF(DABS(TEMP).LT.CLIMIT) GO TO 102
      III=III+1
      EIVT(III)=TEMP
      NEVT(III)=I
  102 CONTINUE
C
      CALL SORT(EIVT,NEVT,NORD,III)
C
      NSET=MIN(III,NPAIR)
      WRITE(6,5)
      DO 103 I=1,NSET
      NN=NEVT(I)
      IX=NIJ(NN,1)
      JX=NIJ(NN,2)
      TEMP=EIVT(I)
      TEMPSQ=TEMP*TEMP
      IS=MOSYM(IX)
      JS=MOSYM(JX)
      ISX=MONUM(IX)
      JSX=MONUM(JX)
      ISYM=ISMAT(ISTYPE,IS)
      JSYM=ISMAT(ISTYPE,JS)
      WRITE(6,6) I,IX,ISX,ISYM,JX,JSX,JSYM,TEMP,TEMPSQ
  103 CONTINUE
      WRITE(6,7)
  105 CONTINUE
C
      RETURN
      END
