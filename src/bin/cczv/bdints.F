C
C-----------------------------------------------------------------------
C
      SUBROUTINE BDINTS(BMAT,MOINTS,NO2,NV2,T1,T2,NTRO,NTRV,NO,NV,LENINT
     .                 ,NTR,IOFF,JOUT,INO,INTRO,INTRV,NOV,INV,N2OV,FLOV,
     .                  ORBSYM,NIRRED,ZLX,UOFF,
     .                 DOFF,NOFF,DADD,NADD,
     .                 TOFF,TADD,NDIMT2,
     .                 AR5,AR6,SUX1,SUX2,SUX3,SFV,OMG3,FZO,FZV)
      IMPLICIT INTEGER(A-Z)
      COMMON/TAPES/TPBMAT,TPFMAT,TPHMAT,TPRMAT,TPQMAT,TPJMAT,ITAP71,
     .             TPAMAT
      COMMON/NEWPAR/NAB(8),NAI(8),NIJ(8),MAXOO,MAXVV,MAXOV
      REAL*8 T1(NO,NV),BMAT(NV2),VAL1,VAL2,T2(NDIMT2),MOINTS(LENINT)
      REAL*8 AR5(MAXOO,MAXVV),AR6(MAXOO,MAXVV),
     .       SUX1(NO*NO),SUX2(NO*NO),SUX3(NV*NV),SFV(NV*NV),
     .       OMG3(NV,NV),TMP,TMV
      INTEGER IOFF(NTR),FZO(*),FZV(*)
      INTEGER INO(NOV),INTRO(N2OV),INTRV(NO*NV),INV(NOV)
      INTEGER DOFF(NOFF),DADD(NADD)
      INTEGER TOFF(NO,NO,2),TADD(NV,NV)
      DIMENSION FLOV(NIRRED,4),ORBSYM(NO+NV)
      DIMENSION ZLX(NV,NV),UOFF(NO,NO,2)
    1 FORMAT (' B(',I2,',',I2,',',I2,',',I2,')=',F20.12)
C
      CALL RFILE(TPBMAT)
      PON=1
      DO 12392 TSYM=1,NIRRED
      XAB=0
      DO 33590 A=1,NV
      IF(FZV(A).EQ.1)GO TO 33590
      ASYM=ORBSYM(A+NO)
      DO 33580 B=1,A
      IF(FZV(B).EQ.1)GO TO 33580
      BSYM=ORBSYM(B+NO)
      ABSYM=IEOR(ASYM,BSYM)
      IF(ABSYM.NE.TSYM-1)GO TO 33580
      XAB=XAB+1
      XIJ=0
      DO 33570 I=1,NO
      IF(FZO(I).EQ.1)GO TO 33570
      ISYM=ORBSYM(I)
      JSYM=IEOR(ISYM,ABSYM)+1
      FJ=FLOV(JSYM,1)
      LJ=FLOV(JSYM,2)
      IF(LJ.GT.I)LJ=I
      DO 33560 J=FJ,LJ
      XIJ=XIJ+1
      IJAB=TOFF(I,J,1)+TADD(A,B)
      JIAB=TOFF(J,I,1)+TADD(A,B)
      VAL1=T2(IJAB)+T1(I,A)*T1(J,B)
      VAL2=T2(JIAB)+T1(J,A)*T1(I,B)
      AR5(XIJ,XAB)=VAL1+VAL2
      AR6(XIJ,XAB)=VAL1-VAL2
33560 CONTINUE
33570 CONTINUE
33580 CONTINUE
33590 CONTINUE
      LIMO=XIJ
      LIMV=XAB
C
      DO 12391 BE=1,NV
      IF(FZV(BE).EQ.1)GO TO 12391
      BESYM=ORBSYM(BE+NO)
      DO 12381 GA=1,BE
      IF(FZV(GA).EQ.1)GO TO 12381
      GASYM=ORBSYM(GA+NO)
      BEGAS=IEOR(BESYM,GASYM)
      IF(BEGAS.NE.TSYM-1)GO TO 12381
C
          XJI=0
          DO 15025 I=1,NO
          IF(FZO(I).EQ.1)GO TO 15025
          BEI=INO(BE)+I
          GAI=INO(GA)+I
          ISYM=ORBSYM(I)
          JSYM=IEOR(ISYM,BEGAS)
          FJ=FLOV(JSYM+1,1)
          LJ=FLOV(JSYM+1,2)
          IF(LJ.GT. I)LJ = I
             DO 15020 J=FJ,LJ
             BEJ=INO(BE)+J
             GAJ=INO(GA)+J
             BEIGAJ=DOFF(MAX0(BEI,GAJ))+DADD(MIN0(BEI,GAJ))
             BEJGAI=DOFF(MAX0(BEJ,GAI))+DADD(MIN0(BEJ,GAI))
             XJI=XJI+1
             VAL1=MOINTS(BEIGAJ)
             VAL2=MOINTS(BEJGAI)
             TMP=VAL1+VAL2
             TMV=VAL1-VAL2
            SUX1(XJI)= TMP*0.5D0
            SUX2(XJI)= TMV*0.5D0
15020        CONTINUE
             IF(ISYM.EQ.JSYM)SUX1(XJI)=SUX1(XJI)*0.5D0
15025 CONTINUE
      DO 14370 AB=1,LIMV
      TMP=0.0D0
      TMV=0.0D0
      DO 14350 IJ=1,LIMO
      TMP=TMP+SUX1(IJ)* AR5(IJ,AB)
      TMV=TMV+SUX2(IJ)* AR6(IJ,AB)
14350 CONTINUE
      SUX3(AB)=TMP
       SFV(AB)=TMV
14370 CONTINUE
C
      AB=0
      DO 14068 A=1,NV
      IF(FZV(A).EQ.1)GO TO 14068
      ASYM=ORBSYM(A+NO)
      BSYM=IEOR(ASYM,BEGAS)+1
      FB=FLOV(BSYM,3)-NO
      LB=FLOV(BSYM,4)-NO
      IF(LB.GT.A )LB=A
      DO 14063 B=FB,LB
      AB=AB+1
      OMG3(A,B)=SUX3(AB)+SFV (AB)
      OMG3(B,A)=SUX3(AB)-SFV (AB)
14063 CONTINUE
14068 CONTINUE
C
      IDIM=NAB(TSYM)
      CALL WREADW(TPBMAT,BMAT,INTOWP(IDIM),PON,IDUM)
      AB=0
      DO 14768 A=1,NV
      IF(FZV(A).EQ.1)GO TO 14768
      ASYM=ORBSYM(A+NO)
      BSYM=IEOR(ASYM,BEGAS)+1
      FB=FLOV(BSYM,3)-NO
      LB=FLOV(BSYM,4)-NO
      DO 14763 B=FB,LB
      AB=AB+1
      BMAT(AB)=BMAT(AB)-OMG3(A,B)
14763 CONTINUE
14768 CONTINUE
      CALL WWRITW(TPBMAT,BMAT,INTOWP(IDIM),PON,PON)
C
12381 CONTINUE
12391 CONTINUE
12392 CONTINUE
      CALL RCLOSE(TPBMAT,3)
      RETURN
      END
