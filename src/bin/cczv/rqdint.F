C
C-----------------------------------------------------------------------
C
      SUBROUTINE RQDINT(QMAT,RMAT,MOINTS,NO2,NV2,T1,T2,
     .                  NTRO,NTRV,NO,NV,
     .                  LENINT,NTR,IOFF,JOUT,INO,INTRO,INTRV,NOV,INV,
     .                  N2OV,ZLX,UOFF,FLOV,ORBSYM,NIRRED,
     .                  DOFF,NOFF,DADD,NADD,
     .                  TOFF,TADD,NDIMT2,
     .                  AR1,AR2,SUX1,SUX2,JAR,KAR,FZO,FZV)
      IMPLICIT INTEGER(A-Z)
      REAL*8 T2(NDIMT2),T1(NO,NV),QMAT(NV*NO),RMAT(NO*NV),MOINTS(LENINT)
     .       ,VAL,VAL1,VAL2,VAL3,VALR,VALQ
      COMMON/NEWPAR/NAB(8),NAI(8),NIJ(8),MAXOO,MAXVV,MAXOV
      REAL*8 AR1(MAXOV,MAXOV),AR2(MAXOV,MAXOV),
     .       SUX1(NO*NV),SUX2(NO*NV),JAR(NO*NV),KAR(NO*NV)
      INTEGER IOFF(NTR),FZO(*),FZV(*)
      INTEGER INO(NOV),INTRO(N2OV),INTRV(NO*NV),INV(NOV)
      INTEGER DOFF(NOFF),DADD(NADD)
      INTEGER TOFF(NO,NO,2),TADD(NV,NV)
      INTEGER ZLX(NV,NV),UOFF(NO,NO,2)
      DIMENSION FLOV(NIRRED,4),ORBSYM(NO+NV)
      COMMON/TAPES/TPBMAT,TPFMAT,TPHMAT,TPRMAT,TPQMAT,TPJMAT,ITAP71,
     .             TPAMAT
C
      CALL RFILE(TPRMAT)
      CALL RFILE(TPQMAT)
      POINTR=1
      POINTQ=1
C
      DO 16695 TSYM=1,NIRRED
      IDIM=NAI(TSYM)
C
      XVG=0
      DO 16790 GA=1,NV
      IF(FZV(GA).EQ.1)GO TO 16790
      GASYM=ORBSYM(GA+NO)
      DO 16770 V=1,NO
      IF(FZO(V).EQ.1)GO TO 16770
      VSYM=ORBSYM(V)
      VGASYM=IEOR(VSYM,GASYM)
      IF(VGASYM.NE.TSYM-1)GO TO 16770
      XVG=XVG+1
      XAI=0
      DO 16750 A=1,NV
      IF(FZV(A).EQ.1)GO TO 16750
      ASYM=ORBSYM(A+NO)
      ISYM=IEOR(ASYM,VGASYM)+1
      ZL=ZLX(GA,A)
      FI=FLOV(ISYM,1)
      LI=FLOV(ISYM,2)
      DO 16730 I=FI,LI
      XAI=XAI+1
      IVGAA=TOFF(I,V,ZL)+TADD(GA,A)
      VIGAA=TOFF(V,I,ZL)+TADD(GA,A)
      VAL1=T2(VIGAA)
      VAL2=T2(IVGAA)+T1(I,GA)*T1(V,A)
      AR1(XAI,XVG)=VAL1+VAL1-VAL2
      AR2(XAI,XVG)=-VAL2
16730 CONTINUE
16750 CONTINUE
16770 CONTINUE
16790 CONTINUE
      LIM=XVG
C
      DO 16690 BE=1,NV
      IF(FZV(BE).EQ.1)GO TO 16690
      BESYM=ORBSYM(BE+NO)
      DO 16680 U=1,NO
      IF(FZO(U).EQ.1)GO TO 16680
      USYM=ORBSYM(U)
      BEUSYM=IEOR(BESYM,USYM)
      IF(BEUSYM.NE.TSYM-1)GO TO 16680
      BEU=INO(BE)+U
      XAI=0
           DO 12300 A=1,NV
           IF(FZV(A).EQ.1)GO TO 12300
           ASYM=ORBSYM(A+NO)
           ISYM=IEOR(ASYM,BEUSYM)+1
           FI=FLOV(ISYM,1)
           LI=FLOV(ISYM,2)
            AU=INO( A)+U
           DO 12280 I=FI,LI
           BEI=INO(BE)+I
            AI=INO( A)+I
           BEUAI=DOFF(MAX0(BEU,AI))+DADD(MIN0(BEU,AI))
           BEIAU=DOFF(MAX0(BEI,AU))+DADD(MIN0(BEI,AU))
           VAL1=MOINTS(BEUAI)
           VAL2=MOINTS(BEIAU)
           XAI=XAI+1
           JAR(XAI)=VAL1+VAL1-VAL2
           KAR(XAI)=VAL2
12280 CONTINUE
12300 CONTINUE
C
      DO 15661 VGA=1,LIM
      VAL1=0.0D0
      VAL2=0.0D0
      DO 15391 AI=1,LIM
      VAL1=VAL1+JAR(AI)*AR1(AI,VGA)
      VAL2=VAL2+KAR(AI)*AR2(AI,VGA)
15391 CONTINUE
      SUX1(VGA)= VAL1
      SUX2(VGA)= VAL2
15661 CONTINUE
C
      CALL WREADW(TPRMAT,RMAT,INTOWP(IDIM),POINTR,DUM)
      CALL WREADW(TPQMAT,QMAT,INTOWP(IDIM),POINTQ,DUM)
      VGA=0
      DO 15660 GA=1,NV
      IF(FZV(GA).EQ.1)GO TO 15660
      GASYM=ORBSYM(GA+NO)
      VSYM=IEOR(GASYM,BEUSYM)+1
      FV=FLOV(VSYM,1)
      LV=FLOV(VSYM,2)
      DO 15410  V=FV,LV
      GAV=INO(GA)+V
      BEUGAV=DOFF(MAX0(BEU,GAV))+DADD(MIN0(BEU,GAV))
      VGA=VGA+1
      QMAT(VGA)=QMAT(VGA)+SUX1(VGA)+MOINTS(BEUGAV)+MOINTS(BEUGAV)
      RMAT(VGA)=RMAT(VGA)+SUX2(VGA)
15410 CONTINUE
15660 CONTINUE
      CALL WWRITW(TPRMAT,RMAT,INTOWP(IDIM),POINTR,POINTR)
      CALL WWRITW(TPQMAT,QMAT,INTOWP(IDIM),POINTQ,POINTQ)
16680 CONTINUE
16690 CONTINUE
16695 CONTINUE
      CALL RCLOSE(TPRMAT,3)
      CALL RCLOSE(TPQMAT,3)
C
      RETURN
      END
