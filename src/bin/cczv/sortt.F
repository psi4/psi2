C
C----------------------------------------------------------------------
C
      SUBROUTINE SORTT(TAU,T2,NTAU,ORBSYM,NO,NV,FLOV,NIRRED,NT3,TOFF,
     .           TADD,ITAP81,ITAP97,ZLX)
      IMPLICIT INTEGER (A-Z)
      REAL * 8 TAU(NTAU),T2(NTAU)
      DIMENSION ORBSYM(NO+NV),FLOV(NIRRED,4),NT3(NIRRED),
     .          TOFF(NO,NO,2,NIRRED),TADD(NV,NV,NIRRED),ZLX(NV,NV)
C
C     COPY TAPE81 ONTO FILE97
C
      I97=1
      I81=1
      DO  90 A=1,NV
      ASYM=ORBSYM(A+NO)
      DO  80 I=1,NO
      ISYM=ORBSYM(I)
      IASYM=IEOR(ASYM,ISYM)+1
      DIM=NT3(IASYM)
      CALL WREADW(ITAP81,TAU,INTOWP(DIM),I81,I81)
      CALL WWRITW(ITAP97,TAU,INTOWP(DIM),I97,I97)
   80 CONTINUE
   90 CONTINUE
C
C     SORT IJKABC TO IJKABC+JKIBCA+KIJCAB
C
      I81=1
      DO 290 A=1,NV
      ASYM=ORBSYM(A+NO)
      DO 280 I=1,NO
      ISYM=ORBSYM(I)
      IASYM=IEOR(ASYM,ISYM)+1
      DIM=NT3(IASYM)
      CALL WREADW(ITAP81,TAU,INTOWP(DIM),I81,I81)
      I97=1
      DO 170 B=1,NV
      BSYM=ORBSYM(B+NO)
      DO 160 J=1,NO
      JSYM=ORBSYM(J)
      JBSYM=IEOR(BSYM,JSYM)+1
      DAM=NT3(JBSYM)
      CALL WREADW(ITAP97,T2 ,INTOWP(DAM),I97,JUNK)
      IAJBS=IEOR(IASYM-1,JBSYM-1)
C
      DO 150 C=1,A
      CSYM=ORBSYM(C+NO)
      ZLCB=ZLX(C,B)
      KSYM=IEOR(IAJBS,CSYM)
      FK=FLOV(KSYM+1,1)
      LK=FLOV(KSYM+1,2)
      DO 140 K=FK,LK
      IKAC=TOFF(I,K,1   ,JBSYM)+TADD(A,C,JBSYM)
      KJCB=TOFF(K,J,ZLCB,IASYM)+TADD(C,B,IASYM)
      T2(IKAC)=T2(IKAC)+TAU(KJCB)
  140 CONTINUE
  150 CONTINUE
C
      DO 151 C=A,NV
      CSYM=ORBSYM(C+NO)
      ZLBC=ZLX(B,C)
      KSYM=IEOR(IAJBS,CSYM)
      FK=FLOV(KSYM+1,1)
      LK=FLOV(KSYM+1,2)
      DO 141 K=FK,LK
      KICA=TOFF(K,I,1   ,JBSYM)+TADD(C,A,JBSYM)
      JKBC=TOFF(J,K,ZLBC,IASYM)+TADD(B,C,IASYM)
      T2(KICA)=T2(KICA)+TAU(JKBC)
  141 CONTINUE
  151 CONTINUE
C
      CALL WWRITW(ITAP97,T2,INTOWP(DAM),I97,I97)
  160 CONTINUE
  170 CONTINUE
C
  280 CONTINUE
  290 CONTINUE
C
C     COPY TAPE97 ONTO FILE81
C
      I97=1
      I81=1
      DO 390 A=1,NV
      ASYM=ORBSYM(A+NO)
      DO 380 I=1,NO
      ISYM=ORBSYM(I)
      IASYM=IEOR(ASYM,ISYM)+1
      DIM=NT3(IASYM)
      CALL WREADW(ITAP97,TAU,INTOWP(DIM),I97,I97)
      CALL WWRITW(ITAP81,TAU,INTOWP(DIM),I81,I81)
  380 CONTINUE
  390 CONTINUE
C
      RETURN
      END
