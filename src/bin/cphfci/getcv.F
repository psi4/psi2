cets121890      SUBROUTINE GETCV(RS,EX,EAVF,LG,SS)
      subroutine RS1(IJDEP,FAC1,VAL2,VAL1,VAL3,KL,
     1 rs,ex,eavf,lg,ss)
      IMPLICIT INTEGER (A-Z)
      REAL*8 LG(NBF,NBF),SS(NUMIJ,NDF),EAVF(NUMIJ)
      REAL*8 RS(NUMDEP,NDF),EX(IJIND)
      REAL*8 A1,A4,VAL1,VAL2,VAL3,FAC1
      COMMON /TAPES/ NOUT,ICHK,IT30,IT42,IT47,IT52,IT58,IT94,IT96,IT98
      COMMON /DIMSG/ SYMORB,NUMIJ,NBF,NMAX,NBFORB,NSYM,NDF,NORBS
      COMMON /OCCS/ NSPE,NSA,NSB,NALP,NOP,NDOC,LFERM,NUOC,IJIND,IJIND3
      COMMON/OCCS2/NUMCOR,NCOR,FDOC,CORDOC,NUMVIR,FVIR,LUOC,NUMDEP,VUOC
      DATA A1,A4 /1.0D+00,4.0D+00/
C
C INITIALIZATION OF SUROUTINE GETCV
C
cets121890      RETURN
C
cets121890      ENTRY RS1(IJDEP,FAC1,VAL2,VAL1,VAL3,KL)
      DO 10 IDF = 1,NDF
      RS(IJDEP,IDF)=RS(IJDEP,IDF)+FAC1*SS(KL,IDF)*(A4*VAL2-VAL1-VAL3)
   10 CONTINUE
      RETURN
      end
C
      subroutine EX1(IJND,LL,KK,LOR,KOR,VAL2,VAL1,VAL3,
     1 rs,ex,eavf,lg,ss)
c
      IMPLICIT INTEGER (A-Z)
      REAL*8 LG(NBF,NBF),SS(NUMIJ,NDF),EAVF(NUMIJ)
      REAL*8 RS(NUMDEP,NDF),EX(IJIND)
      REAL*8 A1,A4,VAL1,VAL2,VAL3,EFAC
      COMMON /TAPES/ NOUT,ICHK,IT30,IT42,IT47,IT52,IT58,IT94,IT96,IT98
      COMMON /DIMSG/ SYMORB,NUMIJ,NBF,NMAX,NBFORB,NSYM,NDF,NORBS
      COMMON /OCCS/ NSPE,NSA,NSB,NALP,NOP,NDOC,LFERM,NUOC,IJIND,IJIND3
      COMMON/OCCS2/NUMCOR,NCOR,FDOC,CORDOC,NUMVIR,FVIR,LUOC,NUMDEP,VUOC
      DATA A1,A4 /1.0D+00,4.0D+00/
c
      EFAC = (A1/(EAVF(LL) - EAVF(KK)))*(LG(LOR,KOR)-LG(KOR,LOR))
      EX(IJND) = EX(IJND) + EFAC*(A4*VAL2-VAL1-VAL3)
      RETURN
      END
c
      subroutine DCICOF(DERC1,KK,LL,LOR,KOR,VAL2,VAL1,
     + rs,ex,eavf,lg,ss)
      IMPLICIT INTEGER (A-Z)
      REAL*8 LG(NBF,NBF),SS(NUMIJ,NDF),EAVF(NUMIJ)
      REAL*8 RS(NUMDEP,NDF),EX(IJIND)
      REAL*8 A1,A4,VAL1,VAL2,derc1,a2
      COMMON /TAPES/ NOUT,ICHK,IT30,IT42,IT47,IT52,IT58,IT94,IT96,IT98
      COMMON /DIMSG/ SYMORB,NUMIJ,NBF,NMAX,NBFORB,NSYM,NDF,NORBS
      COMMON /OCCS/ NSPE,NSA,NSB,NALP,NOP,NDOC,LFERM,NUOC,IJIND,IJIND3
      COMMON/OCCS2/NUMCOR,NCOR,FDOC,CORDOC,NUMVIR,FVIR,LUOC,NUMDEP,VUOC
      DATA A1,A4 /1.0D+00,4.0D+00/
      a2=2.0d+00
         DERC1 = DERC1 + (A2*VAL2-VAL1)*(LG(LOR,KOR)-LG(KOR,LOR))/
     1  (EAVF(KK)-EAVF(LL))
      junk=junk
      RETURN
      end
