      SUBROUTINE DERMAT(EAO,E1A,E2A,SS,U,T)
      IMPLICIT REAL*8 (A-H,O-Z)
      DIMENSION E1A(N3N),E2A(N3N,N3N),SS(NBATRI)
      DIMENSION EAO(NBFAO,NBASIS),U(NBFAO,NBFAO),T(NBFAO,NBFAO)
      COMMON/BASIS/NBASIS,NBFAO,NTRI,NTRI2,NBATRI,NBASQ
      COMMON/FUNCS/NTYPES,NTYPEP,NTREAD,NATOMS,N3N,N3NP3,N3NX3
      COMMON/SECTF/ISA(153),IHA(153),IFA(153),IEA(153),IBA(153),IUA(153)
      COMMON/SIGNS/IOFF(466),IPRNT
      COMMON/TAPES/ITAP36,ITAP42,ITAP43,ITAP44
      COMMON/WORKS/JTAPE1
    1 FORMAT(//,2X,' SCF FIRST DERIVATIVE MATRIX'/)
    2 FORMAT(//,2X,' SCF SECOND DERIVATIVE MATRIX'/)
    3 FORMAT(//,2X,' SA (AO BASIS) MATRIX, IABC = ',I5/)
    4 FORMAT(//,2X,' HA (AO BASIS) MATRIX, IABC = ',I5/)
    5 FORMAT(//,2X,' TA (AO BASIS) MATRIX, ITYP = ',I5,' IABC = ',I5/)
    6 FORMAT(//,2X,' TA (MO BASIS) MATRIX, ITYP = ',I5,' IABC = ',I5/)
C
      CALL RFILE(ITAP42)
      CALL RFILE(JTAPE1)
      NTREAD=NTYPES
      NBATR2=NBATRI*2
C
C   READ IN SCF FIRST DERIVATIVES
      CALL SREAD(ITAP42,E1A,N3N*2)
      IF(IPRNT.LE.2) GO TO 201
      WRITE(6,1)
      CALL MATOUT(E1A,3,NATOMS,3,NATOMS,6)
C
C   READ IN SCF SECOND DERIVATIVES
  201 CONTINUE
      CALL SREAD(ITAP42,E2A,N3N*N3N*2)
      IF(IPRNT.LE.2) GO TO 202
      WRITE(6,2)
      CALL MATOUT(E2A,N3N,N3N,N3N,N3N,6)
C
C   READ IN S FIRST DERIVATIVE INTEGRALS
  202 CONTINUE
      DO 101 IABC=1,N3N
      IS=ISA(IABC)
      CALL SREAD(ITAP42,SS,NBATR2)
      IF(IPRNT.LE.4) GO TO 101
      WRITE(6,3) IABC
      CALL PRINT(SS,NBATRI,NBASIS,6)
  101 CONTINUE
C
C   READ IN ONE ELECTRON FIRST DERIVATIVE INTEGRALS
      DO 102 IABC=1,N3N
      IH=IHA(IABC)
      CALL SREAD(ITAP42,SS,NBATR2)
      IF(IPRNT.LE.4) GO TO 102
      WRITE(6,4) IABC
      CALL PRINT(SS,NBATRI,NBFAO,6)
  102 CONTINUE
C
C   READ IN TWO ELECTRON FIRST DERIVATIVE INTEGRALS
C   AND TRANSFORM THEM FROM AO TO MO BASIS
      DO 104 ITYP=1,NTREAD
      DO 103 IABC=1,N3N
      CALL SREAD(ITAP42,SS,NBATR2)
      IF(IPRNT.LE.4) GO TO 203
      WRITE(6,5) ITYP,IABC
      CALL PRINT(SS,NBATRI,NBFAO,6)
  203 CALL MOCONV(SS,NBATRI,SS,NBATRI,EAO,U,T)
      CALL SWRIT(JTAPE1,SS,NTRI2)
      IF(IPRNT.LE.4) GO TO 103
      WRITE(6,6) ITYP,IABC
      CALL PRINT(SS,NBATRI,NBASIS,6)
  103 CONTINUE
  104 CONTINUE
C
      CALL SREW(ITAP42)
      CALL SREW(JTAPE1)
      RETURN
      END
