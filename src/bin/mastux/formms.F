      SUBROUTINE FORMMS(AI,IA,MAXCOR)
      REAL*8 AI
      DIMENSION AI(MAXCOR),IA(MAXCOR*2)
      COMMON/BASIS/NBASIS,NTRI,NST,NSYM,NBFAO,NBFSO,NBATRI
      COMMON/FUNCS/NTYPES,NATOM,N3N
      COMMON/LOCAT/LOCS(1024)
      COMMON/MFSEC/MFILE,NSECT
      COMMON/SIGNS/IOFF(256),IPRNT
      COMMON/CI101/IOPEN,IOCC,JOCC,KOCC
C
C  NO.  :  CONTENTS
C
C   TRIA. = LOWER TRIANGULAR MATRIX
C   SQUA. = SQUARE MATRIX
C   RECT. = RECTANGULAR MATRIX
C   1   : LOCATION
C   2   : PARAMETERS
C   3   : ENERGIES AND REAL CONSTANTS
C   4   : MO ORDERING IN SCF
C   5   : MO ORDERING IN DRT
C   6   : MO CODE FOR CI
C   7   : MO CODE FOR MCSCF
C   8   : NUCLEAR CHARGE AND GEOMETRY
C   9   : AO-SO TRANSFORMATION MATRIX (RECT.)
C  10   : EIGENVALUES IN PITZER'S SCF (SQUA.)
C  11   : OCCUPATION IN PITZER'S SCF
C  12   : SO-MO EIGENVECTORS IN PITZER'S SCF (SQUA.)
C  13   : AO-MO EIGENVECTORS IN PITZER'S SCF (RECT.)
C  14   : SO OVERLAP INTEGRALS IN PITZER'S SCF (TRIA.)
C  15   : ONE ELECTRON SO INTEGRALS IN PITZER'S SCF (TRIA.)
C  16   : ONE ELECTRON MO INTEGRALS IN PITZER'S SCF (TRIA.)
C  17   : EIGENVALUES IN SORTED SCF
C  18   : OCCUPATION IN SORTED SCF
C  19   : SO-MO EIGENVECTORS IN SORTED SCF (SQUA.)
C  20   : AO-MO EIGENVECTORS IN SORTED SCF (RECT.)
C  21   : SO OVERLAP INTEGRALS IN SORTED SCF (TRIA.)
C  22   : ONE ELECTRON SO INTEGRALS IN SORTED SCF (TRIA.)
C  23   : ONE ELECTRON MO INTEGRLAS IN SORTED SCF (TRIA.)
C  24   : LAGRANGIAN MATRIX FOR SCF IN AO BASIS (TRIA.)
C  25   : LAGRANGIAN MATRIX FOR SCF IN MO BASIS (TRIA.)
C  26   : K MATRIX FOR HIGH SPIN OPEN-SHELL SCF (TRIA.)
C  27   : FIRST ZETA MATRIX  FOR GENERALIZED OPEN-SHELL SCF (TRIA.)
C  28   : SECOND ZETA MATRIX FOR GENERALIZED OPEN-SHELL SCF (TRIA.)
C  29   : THIRD ZETA MATRIX  FOR GENERALIZED OPEN-SHELL SCF (TRIA.)
C  30   : FOURTH ZETA MATRIX FOR GENERALIZED OPEN-SHELL SCF (TRIA.)
C  31   : FIFTH ZETA MATRIX  FOR GENERALIZED OPEN-SHELL SCF (TRIA.)
C  32   : LAGRANGIAN MATRIX FOR CI IN AO BASIS (TRIA.)
C  33   : LAGRANGIAN MATRIX FOR CI IN MO BASIS (SQUA.)
C  34   : ONE PDM IN AO BASIS FOR CI (TRIA.)
C  35   : ONE PDM IN MO BASIS FOR CI (TRIA.)
C  36   : LAGRANGIAN MATRIX FOR MCSCF IN AO BASIS (TRIA.)
C  37   : LAGRANGIAN MATRIX FOR MCSCF IN MO BASIS (SQUA.)
C  38   : ONE PDM IN AO BASIS FOR MCSCF (TRIA.)
C  39   : ONE PDM IN MO BASIS FOR MCSCF (TRIA.)
C  40   : ALPA MATRIX MO BASIS (TRIA.)
C  41   : BETA MATRIX MO BASIS (TRIA.)
C  42   : AO-MO EIGENVECTORS IN DRT ORDER (RECT.)
C
      NSECT2=NSECT*2
      NSECTH=NSECT/2
      NBASL=((NBASIS-1)/NSECT+1)
      NGEOM=NATOM*8
      NGEOML=((NGEOM-1)/NSECT+1)
      NBAS2=NBASIS*2
      NBAS2L=((NBAS2-1)/NSECT+1)
      NBASQ=NBASIS*NBASIS*2
      NBASQL=((NBASQ-1)/NSECT+1)
      NBASR=NBFAO*NBFSO*2
      NBASRL=((NBASR-1)/NSECT+1)
      NTRI2=NTRI*2
      NTRIL=((NTRI2-1)/NSECT+1)
      NBATRI=IOFF(NBFAO+1)
      NBATR2=NBATRI*2
      NBATRL=((NBATR2-1)/NSECT+1)
      NBASA=NBFAO*NBFAO*2
      NBASAL=((NBASA-1)/NSECT+1)
C
      CALL RFILE(MFILE)
      DO 101 I=1,NBASA
      IA(I)=0
  101 CONTINUE
C
C***1ST MATRIX***
C   SET UP LOCATION OF PARAMETERS AND MATRICES
C   IA(N)         = STARTING POSITION OF THE "N"TH VECTOR
C   IA(N+NSECTH)  = LENGTH OF THE "N"TH VECTOR IN INTEGER WORDS
      IA(1)=1
      IA(1+NSECTH)=NSECT
      IA(2)=IA(1)+1
      IA(2+NSECTH)=NSECT
      IA(3)=IA(2)+1
      IA(3+NSECTH)=NSECT2
      IA(4)=IA(3)+2
      IA(4+NSECTH)=NBASIS
      IA(5)=IA(4)+NBASL
      IA(5+NSECTH)=NBASIS
      IA(6)=IA(5)+NBASL
      IA(6+NSECTH)=NBASIS
      IA(7)=IA(6)+NBASL
      IA(7+NSECTH)=NBASIS
      IA(8)=IA(7)+NBASL
      IA(8+NSECTH)=NGEOM
      IA(9)=IA(8)+NGEOML
      IA(9+NSECTH)=NBASR
      IA(10)=IA(9)+NBASRL
      IA(10+NSECTH)=NBAS2
      IA(11)=IA(10)+NBAS2L
      IA(11+NSECTH)=NBAS2
      IA(12)=IA(11)+NBAS2L
      IA(12+NSECTH)=NBASQ
      IA(13)=IA(12)+NBASQL
      IA(13+NSECTH)=NBASR
      IA(14)=IA(13)+NBASRL
      IA(14+NSECTH)=NTRI2
      IA(15)=IA(14)+NTRIL
      IA(15+NSECTH)=NTRI2
      IA(16)=IA(15)+NTRIL
      IA(16+NSECTH)=NTRI2
      IA(17)=IA(16)+NTRIL
      IA(17+NSECTH)=NBAS2
      IA(18)=IA(17)+NBAS2L
      IA(18+NSECTH)=NBAS2
      IA(19)=IA(18)+NBAS2L
      IA(19+NSECTH)=NBASQ
      IA(20)=IA(19)+NBASQL
      IA(20+NSECTH)=NBASR
      IA(21)=IA(20)+NBASRL
      IA(21+NSECTH)=NTRI2
      IA(22)=IA(21)+NTRIL
      IA(22+NSECTH)=NTRI2
      IA(23)=IA(22)+NTRIL
      IA(23+NSECTH)=NTRI2
      IA(24)=IA(23)+NTRIL
      IA(24+NSECTH)=NBATR2
      IA(25)=IA(24)+NBATRL
      IA(25+NSECTH)=NTRI2
      IA(26)=IA(25)+NTRIL
      IA(26+NSECTH)=NTRI2
      IA(27)=IA(26)+NTRIL
      IA(27+NSECTH)=NTRI2
      IA(28)=IA(27)+NTRIL
      IA(28+NSECTH)=NTRI2
      IA(29)=IA(28)+NTRIL
      IA(29+NSECTH)=NTRI2
      IA(30)=IA(29)+NTRIL
      IA(30+NSECTH)=NTRI2
      IA(31)=IA(30)+NTRIL
      IA(31+NSECTH)=NTRI2
      IA(32)=IA(31)+NTRIL
      IA(32+NSECTH)=NBATR2
      IA(33)=IA(32)+NBATRL
      IA(33+NSECTH)=NBASQ
      IA(34)=IA(33)+NBASQL
      IA(34+NSECTH)=NBATR2
      IA(35)=IA(34)+NBATRL
      IA(35+NSECTH)=NTRI2
      IA(36)=IA(35)+NTRIL
      IA(36+NSECTH)=NBATR2
      IA(37)=IA(36)+NBATRL
      IA(37+NSECTH)=NBASQ
      IA(38)=IA(37)+NBASQL
      IA(38+NSECTH)=NBATR2
      IA(39)=IA(38)+NBATRL
      IA(39+NSECTH)=NTRI2
      IA(40)=IA(39)+NBATRL
      IA(40+NSECTH)=NTRI2
      IA(41)=IA(40)+NBATRL
      IA(41+NSECTH)=NTRI2
      IA(42)=IA(41)+NBASRL
      IA(42+NSECTH)=NBASR
C
      DO 102 I=1,NSECT
  102 LOCS(I)=IA(I)
C
      CALL RWRIT(MFILE,IA,NSECT,LOCS(1))
C
C***2ND MATRIX***
C   STORE PARAMETERS
      IDUMP=0
      IA(1)=NSECT
      IA(2)=IDUMP
      IA(3)=NBASIS
      IA(4)=NTRI
C     IA(5)=NTOT
C$$$WARNING---DO NOT USE NTOT FOR A LARGE CASE...OVERFLOWS$$$
      IA(6)=IOPEN
C     IA(7)=IOCC
C     IA(8)=KOCC
C     IA(9)=JOCC
      IA(10)=NATOM
      IA(11)=NBFAO
      IA(12)=NBFSO
      IA(13)=NSYM
C     IA(14)=NWLK
C     IA(15)=NMCSCF
C     IA(16)=ITCSCF
      IA(17)=N3N
C     IA(18)=NTYPES
C     IA(19)='SCFTYP'
C     IA(20)='CITYP'
C     IA(21)='DERTYP'
      IA(30)=NST
C     IA(31)=NDEG(1)
C     IA(32)=NDEG(2)
C     IA(33)=NDEG(3)
C     IA(34)=NDEG(4)
C     IA(35)=NDEG(5)
C     IA(36)=NDEG(6)
C     IA(37)=NDEG(7)
C     IA(38)=NDEG(8)
C     IA(39)=NDEG(9)
C     IA(40)=NDEG(10)
C     IA(41)=NSORB(1)
C     IA(42)=NSORB(2)
C     IA(43)=NSORB(3)
C     IA(44)=NSORB(4)
C     IA(45)=NSORB(5)
C     IA(46)=NSORB(6)
C     IA(47)=NSORB(7)
C     IA(48)=NSORB(8)
C     IA(49)=NSORB(9)
C     IA(50)=NSORB(10)
      CALL RWRIT(MFILE,IA,NSECT,LOCS(2))
C
C***3RD MATRIX***
C   STORE ENERGIES AND REAL CONSTANTS
C     AI(1)=ENUC
C     AI(2)=ESCF
C     AI(3)=ECIFZC
C     AI(4)=ECI
C     AI(5)=ECICOR
C     AI(6)=CNOTCI
C     AI(7)=EMCFZC
C     AI(8)=EMC
C     AI(9)=EMCCOR
C     AI(10)=CNOTMC
C     AI(11)=ALPC(1)
C     AI(12)=ALPC(2)
C     AI(13)=ALPC(3)
C     AI(14)=ALPC(4)
C     AI(15)=ALPC(5)
C     AI(16)=ALPC(6)
C     AI(17)=ALPC(7)
C     AI(18)=ALPC(8)
C     AI(19)=ALPC(9)
C     AI(20)=ALPC(10)
C     AI(21)=ALPC(11)
C     AI(22)=ALPC(12)
C     AI(23)=ALPC(13)
C     AI(24)=ALPC(14)
C     AI(25)=ALPC(15)
C     AI(26)=BETC(1)
C     AI(27)=BETC(2)
C     AI(28)=BETC(3)
C     AI(29)=BETC(4)
C     AI(30)=BETC(5)
C     AI(31)=BETC(6)
C     AI(32)=BETC(7)
C     AI(33)=BETC(8)
C     AI(34)=BETC(9)
C     AI(35)=BETC(10)
C     AI(36)=BETC(11)
C     AI(37)=BETC(12)
C     AI(38)=BETC(13)
C     AI(39)=BETC(14)
C     AI(40)=BETC(15)
C     AI(41)=FOCC(1)
C     AI(42)=FOCC(2)
C     AI(43)=FOCC(3)
C     AI(44)=FOCC(4)
C     AI(45)=FOCC(5)
C     AI(46)=FOCC(6)
C     AI(47)=FOCC(7)
C     AI(48)=FOCC(8)
C     AI(49)=FOCC(9)
C     AI(50)=FOCC(10)
      CALL RWRIT(MFILE,IA,NSECT2,LOCS(3))
C
C***4TH MATRIX***
C   STORE MO ORDERING IN SCF
      CALL RWRIT(MFILE,IA,NBASIS,LOCS(4))
C
C***5TH MATRIX***
C   STORE MO ORDERING IN DRT
      CALL RWRIT(MFILE,IA,NBASIS,LOCS(5))
C
C***6TH MATRIX***
C   STORE MO CODE FOR CI
      CALL RWRIT(MFILE,IA,NBASIS,LOCS(6))
C
C***7TH MATRIX***
C   STORE MO CODE FOR MCSCF
      CALL RWRIT(MFILE,IA,NBASIS,LOCS(7))
C
C***8TH MATRIX***
C   STORE NUCLEAR CHARGE AND GEOMETRY
      CALL RWRIT(MFILE,IA,NGEOM,LOCS(8))
C
C***9TH MATRIX***
C   STORE AO-SO MATRIX (RECTANGULAR MATRIX)
      CALL RWRIT(MFILE,IA,NBASR,LOCS(9))
C
C***10 TH MATRIX***
C   STORE EIGENVALUES IN PITZER'S SCF
      CALL RWRIT(MFILE,IA,NBAS2,LOCS(10))
C
C***11TH MATRIX***
C   STORE OCCUPATION IN PITZER'S SCF
      CALL RWRIT(MFILE,IA,NBAS2,LOCS(11))
C
C***12TH MATRIX***
C   STORE SO-MO EIGENVECTORS IN PITZER'S SCF (SQUARE MATRIX)
      CALL RWRIT(MFILE,IA,NBASQ,LOCS(12))
C
C***13TH MATRIX***
C   STORE AO-MO EIGENVECTORS IN PITZER'S SCF (RECTANGULAR MATRIX)
      CALL RWRIT(MFILE,IA,NBASR,LOCS(13))
C
C***14TH MATRIX***
C   STORE SO OVERLAP INTEGRALS IN PITZER'S SCF (LOWER TRIANGLE)
      CALL RWRIT(MFILE,IA,NTRI2,LOCS(14))
C
C***15TH MATRIX***
C   STORE ONE ELECTRON SO INTEGRALS IN PITZER'S SCF (LOWER TRIANGLE)
      CALL RWRIT(MFILE,IA,NTRI2,LOCS(15))
C
C***16TH MATRIX***
C   STORE ONE ELECTRON MO INTEGRALS IN PITZER'S SCF (LOWER TRIANGLE)
      CALL RWRIT(MFILE,IA,NTRI2,LOCS(16))
C
C***17TH MATRIX***
C   STORE EIGENVALUES IN SORTED SCF
      CALL RWRIT(MFILE,IA,NBAS2,LOCS(17))
C
C***18TH MATRIX***
C   STORE OCCUPATION IN SORTED SCF
      CALL RWRIT(MFILE,IA,NBAS2,LOCS(18))
C
C***19TH MATRIX***
C   STORE SO-MO EIGENVECTORS IN SORTED SCF (SQUARE MATRIX)
      CALL RWRIT(MFILE,IA,NBASQ,LOCS(19))
C
C***20TH MATRIX***
C   STORE AO-MO EIGENVECTORS IN SORTED SCF (RECTANGULAR MATRIX)
      CALL RWRIT(MFILE,IA,NBASR,LOCS(20))
C
C***21ST MATRIX***
C   STORE SO OVERLAP INTEGRALS IN SORTED SCF (LOWER TRIANGLE)
      CALL RWRIT(MFILE,IA,NTRI2,LOCS(21))
C
C***22ND MATRIX***
C   STORE ONE ELECTRON SO INTEGRALS (LOWER TRIANGLE)
      CALL RWRIT(MFILE,IA,NTRI2,LOCS(22))
C
C***23RD MATRIX***
C   STORE ONE ELECTRON MO INTEGRALS IN SORTED SCF (LOWER TRIANGLE)
      CALL RWRIT(MFILE,IA,NTRI2,LOCS(23))
C
C***24TH MATRIX***
C   STORE LAGRANGIAN MATRIX FOR SCF IN AO BASIS (LOWER TRIANGLE)
      CALL RWRIT(MFILE,IA,NBATR2,LOCS(24))
C
C***25TH MATRIX***
C   STORE LAGRANGIAN MATRIX FOR SCF IN MO BASIS (LOWER TRIANGLE)
      CALL RWRIT(MFILE,IA,NTRI2,LOCS(25))
C
C***26TH MATRIX***
C   STORE K MATRIX FOR HIGH SPIN OPEN-SHELL SCF (LOWER TRIANGLE)
      CALL RWRIT(MFILE,IA,NTRI2,LOCS(26))
C
C***27TH MATRIX***
C   STORE FISRTST ZETA MATRIX FOR GENERALIZED OPEN-SHELL SCF
C   (LOWER TRIANGLE)
      CALL RWRIT(MFILE,IA,NTRI2,LOCS(27))
C
C***28TH MATRIX***
C   STORE SECOND ZETA MATRIX FOR GENERALIZED OPEN-SHELL SCF
C   (LOWER TRIANGLE)
      CALL RWRIT(MFILE,IA,NTRI2,LOCS(28))
C
C***29TH MATRIX***
C   STORE THIRD ZETA MATRIX FOR GENERALIZED OPEN-SHELL SCF
C   (LOWER TRIANGLE)
      CALL RWRIT(MFILE,IA,NTRI2,LOCS(29))
C
C***30TH MATRIX***
C   STORE FOURTH ZETA MATRIX FOR GENERALIZED OPEN-SHELL SCF
C   (LOWER TRIANGLE)
      CALL RWRIT(MFILE,IA,NTRI2,LOCS(30))
C
C***31ST MATRIX***
C   STORE FIFTH ZETA MATRIX FOR GENERALIZED OPEN-SHELL SCF
C   (LOWER TRIANGLE)
      CALL RWRIT(MFILE,IA,NTRI2,LOCS(31))
C
C***32ND MATRIX***
C   STORE LAGRANGIAN MATRIX FOR CI IN AO BASIS (LOWER TRIANGLE)
      CALL RWRIT(MFILE,IA,NBATR2,LOCS(32))
C
C***33RD MATRIX***
C   STORE LAGRANGIAN MATRIX FOR CI IN MO BASIS (SQUARE MATRIX)
      CALL RWRIT(MFILE,IA,NBASQ,LOCS(33))
C
C***34TH MATRIX***
C   STORE ONE PDM IN AO BASIS FOR CI (LOWER TRIANGLE)
      CALL RWRIT(MFILE,IA,NBATR2,LOCS(34))
C
C***35TH MATRIX***
C   STORE ONE PDM IN MO BASIS FOR CI (LOWER TRIANGLE)
      CALL RWRIT(MFILE,IA,NTRI2,LOCS(35))
C
C***36TH MATRIX***
C   STORE LAGRANGIAN MATRIX FOR MCSCF IN AO BASIS (LOWER TRIANGLE)
      CALL RWRIT(MFILE,IA,NBATR2,LOCS(36))
C
C***37TH MATRIX***
C   STORE LAGRANGIAN MATRIX FOR MCSCF IN MO BASIS (SQUARE MATRIX)
      CALL RWRIT(MFILE,IA,NBASQ,LOCS(37))
C
C***38TH MATRIX***
C   STORE ONE PDM IN AO BASIS FOR MCSCF (LOWER TRIANGLE)
      CALL RWRIT(MFILE,IA,NBATR2,LOCS(38))
C
C***39TH MATRIX***
C   STORE ONE PDM IN MO BASIS FOR MCSCF (LOWER TRIANGLE)
      CALL RWRIT(MFILE,IA,NTRI2,LOCS(39))
C
      RETURN
      END
