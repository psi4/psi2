      SUBROUTINE INTR(C,NAT,IW)
C
      IMPLICIT REAL*8 (A-H,O-Z)
C
      REAL*8 C(3,NAT)
C
C     ----- CALCULATE ATOM-ATOM DISTANCES -----
C
      DIMENSION R(30)
C
      DATA ONE,UNIT /1.0D+00,0.52917706D+00/
C
      IPASS=1
      FAC=ONE
      WRITE(IW,9995)
 9995 FORMAT(//10X,'INTERNUCLEAR DISTANCES ( A.U.)'/10X,30(1H-))
 9996 FORMAT(/10X,'INTERNUCLEAR DISTANCES (ANGS.)'/10X,30(1H-))
    5 CONTINUE
      MAXJ=0
   10 MINJ=MAXJ+1
      MAXJ=MAXJ+8
      MAXJ=MIN(MAXJ,NAT)
      WRITE(IW,9999)
      WRITE(IW,9998) (J,J=MINJ,MAXJ)
      WRITE(IW,9999)
      DO 30 I=1,NAT
        DO 20 J=MINJ,MAXJ
          RR=(C(1,I)-C(1,J))**2+(C(2,I)-C(2,J))**2+(C(3,I)-C(3,J))**2
   20   R(J)=DSQRT(RR)*FAC
        WRITE(IW,9997) I,(R(J),J=MINJ,MAXJ)
   30 CONTINUE
      IF(MAXJ.LT.NAT) GO TO 10
      FAC=UNIT
      WRITE(IW,9999)
      IF(IPASS.EQ.2) RETURN
      IPASS=2
      WRITE(IW,9996)
      GO TO 5
 9999 FORMAT(5X)
 9998 FORMAT(5X,8(7X,I2,6X))
 9997 FORMAT(I5,8F15.7)
      END
