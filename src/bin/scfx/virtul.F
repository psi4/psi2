C     ///////////////////////////////////////////////////////////////
      SUBROUTINE VIRTUL(NLAMDA,ITYP,SU,CM,EIG)
C
C
C
      IMPLICIT REAL*8 (A-H,O-Z)
C
C
      LOGICAL TWOCON
      INTEGER BLABEL,ALABEL
      CHARACTER*4 BLANK
      COMMON/SCFIN/REPNUC,IOPEN,ISCF,IPRCT,IVECT,NBFLD,ICUT
      COMMON /GVB/ ALPHA1,ALPHA2,ALPHA3,IJUP,TWOCON
      COMMON /INPT/  NSYM,IPMAX,NMAT,ITMAX,NSFMAX,NTOTAL,MXCOEF,MSFRU
      COMMON/HOLL/BLABEL(20),ALABEL(26),FMT(10),JL
      COMMON/TAPES/NIN,IR,IOUT,ICHECK,IFLAG3,ITAPE,ITERML
      DIMENSION NLAMDA(NSYM),ITYP(20),SU(MXCOEF),CM(2,NSYM),EIG(NTOTAL)
      DATA NCOL/9/,BLANK/' '/
      ASSIGN 2500 TO IFORM
      IF (TWOCON) ASSIGN 2510 TO IFORM
      ASSIGN 5000 TO IFRM
      IF (TWOCON) ASSIGN 5010 TO IFRM
      IOUT2=IOUT
C     IF(IFLAG3.GT.0) IOUT2=6
 910  CONTINUE
      WRITE (IOUT2,12)
      IEMAX=0
      ICMAX = 0
      DO 100 I=1,NSYM
         NN = NLAMDA(I)
         NNV = NN
         ICMIN = ICMAX + 1
         ICMAX = ICMAX + NN*NNV
         IEMIN = IEMAX + 1
         IEMAX = IEMAX + NNV
         DO 100 MM =1,NNV,NCOL
            WRITE (IOUT2,20)ITYP(I)
            K = MM + NCOL - 1
            IF(K.GT.NNV)K = NNV
            WRITE(IOUT2,110) (BLANK,KK, KK=MM,K)
            J0 = ICMIN + NN*MM - NN - 1
            JLIM = ICMIN + K*NN - 1
            DO 25 II=1,NN
               J0 = J0 + 1
   25       WRITE (IOUT2,3500) (SU(IC),IC=J0,JLIM,NN)
            J0 = IEMIN + MM - 1
            JLIM = IEMIN + K - 1
            WRITE (IOUT2,30) (EIG(IC), IC=J0,JLIM)
            WRITE (IOUT2,IFORM) (CM(1,IC), IC=J0,JLIM)
            IF(IOPEN.NE.0) WRITE (IOUT2,IFRM) (CM(2,IC), IC=J0,JLIM)
  100 CONTINUE
      IF (IOUT2 .NE. 6) THEN
         IOUT2=6
         GOTO 910
      END IF
      RETURN
CCC12 FORMAT(1H ,26A3,5X,18HMOLECULAR ORBITALS/1X,26A3)
   12 FORMAT(/,/,/,' ******************************** ',/,1X,
     *'       MOLECULAR ORBITALS',/,' ********************************')
   20 FORMAT(/,1X,20X,6HIRREP ,A3,1X,/)
   30 FORMAT(/,16H     EIGENVALUES,F15.6,8F12.6)
  110 FORMAT(24X,9(A1,2HC(,I2,1H),6X))
 3500 FORMAT(19X,9F12.6)
 2500 FORMAT(1H ,4X,12HCLOSED-SHELL/7X,12HOCCUPATION =,F9.1,8F12.1)
 2510 FORMAT(1H ,4X,12HCLOSED-SHELL/7X,12HOCCUPATION =,F9.3,8F12.3)
 5000 FORMAT(1H ,4X,12H  OPEN-SHELL/7X,12HOCCUPATION =,F9.1,8F12.1)
 5010 FORMAT(1H ,4X,12H  OPEN-SHELL/7X,12HOCCUPATION =,F9.3,8F12.3)
      END
