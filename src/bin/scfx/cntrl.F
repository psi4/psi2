C     //////////////////////////////////////////////////////////////
      SUBROUTINE CNTRL(DE,DEP,DEAVG,DAMP,EPS,INEW)
      IMPLICIT REAL*8 (A-H,O-Z)
      DFACT=8.0D0
      IF(INEW.EQ.1) DFACT=4.0D0
      D2 =  DSQRT(DFACT)
      D1=1.0D0/D2
      IF(ABS(DE).LT.EPS) GO TO 1408
      IF(DE.GT.0.0D0) GO TO 1400
      IF(DEP.GT.0.0D0) GO TO 1401
      IF(DE.LE.DEP)GO TO 1405
      IF(DE.GT.    D1*DEP)GO TO 1403
 1402 DAMP=((DE/DEP)**2)*MAX(DAMP,DEAVG)
      GO TO 145
 1400 IF(DEP.GT.0.0D0) GO TO 1404
      DAMP=MAX(DAMP,DEAVG)*D2
      IF(DE.GT.0.5D0*DEAVG)DAMP=DAMP*DFACT
      IF(DE-DEP.LT.0.2D0*DEAVG)GO TO 1403
      GO TO 145
 1404 DAMP= D2 *MAX(DAMP,DEAVG)
      IF(DE.LT. D2 *DEP)GO TO 1407
      IF (INEW .EQ. 1) GO TO 145
      DAMP=DFACT*MAX(DAMP,DEAVG)
      GO TO 145
 1401 DAMP=MAX(DEAVG,DAMP)*D2
      IF (INEW .EQ. 1) GO TO 145
      IF(-DE.GT.DEAVG)DAMP=DAMP*D2
      IF(-DE+DEP.LT.DEAVG)GO TO 1403
      GO TO 145
 1403 DAMP=DAMP/DFACT
      GO TO 145
 1405 IF(ABS(DE).LT.2.0D0*DEAVG) GO TO 1406
      DAMP=DFACT*MAX(DAMP,DEAVG)
      GO TO 145
 1406 IF(ABS(DE).GT.0.5D0*DEAVG)GO TO 145
      GO TO 1403
 1407 IF(DE.GT.   D1 *DEP)GO TO 1402
      GO TO 1403
 1408 DAMP = DAMP/DFACT
      IF (INEW .EQ. 1) DAMP = DAMP/DFACT
  145 RETURN
      END
