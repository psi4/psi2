      SUBROUTINE MOCONV(SA,SM,ESO,U,T)
      IMPLICIT REAL*8 (A-H,O-Z)
      DIMENSION ESO(NBASIS,NBASIS),U(NBASIS,NBASIS),T(NBASIS,NBASIS)
      DIMENSION SA(NTRI),SM(NTRI)
      COMMON/BASIS/NBASIS,NTRI
      COMMON/SIGNS/IOFF(257),IPRNT
      DATA A00 / 0.0D+00 /
C
C   TRANSFORM ONE-ELECTRON INTEGRALS FROM SO TO MO BASIS
      DO 101 II=1,NBASIS
      DO 101 JJ=1,II
      IIJJ=IOFF(II)+JJ
      T(II,JJ)=SA(IIJJ)
      T(JJ,II)=SA(IIJJ)
  101 CONTINUE
      DO 103 II=1,NBASIS
      DO 103 J=1,NBASIS
      SUM=A00
      DO 102 JJ=1,NBASIS
      SUM=SUM+ESO(JJ,J)*T(II,JJ)
  102 CONTINUE
      U(II,J)=SUM
  103 CONTINUE
      DO 105 I=1,NBASIS
      DO 105 J=1,I
      IJ=IOFF(I)+J
      SUM=A00
      DO 104 II=1,NBASIS
      SUM=SUM+ESO(II,I)*U(II,J)
  104 CONTINUE
      SM(IJ)=SUM
  105 CONTINUE
C
      RETURN
      END
