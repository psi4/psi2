C
C                         **********************
C-------------------------******  READ34  ******-----------------------
C                         **********************
C
      SUBROUTINE READ34(H,S,T,V,STVI,LBLI,IBUFHF,ITAP34,JOUT)
      IMPLICIT REAL*8 (A-H,O-Z)
      CHARACTER*4 BLABEL(20)
      INTEGER ND(10),MNL(142),MS(142),MTYPE(2,20),ITYP(20)
      COMMON/BASIS/NBASIS,MTRI,NSYM
      COMMON/SIGNS/IOFF(256),IPRNT
      COMMON/SYMMS/IDEG(10),NDEG(10),LSYM(10)
      DIMENSION S(MTRI),H(MTRI),T(MTRI),V(MTRI)
      DIMENSION LBLI(IBUFHF*2),STVI(IBUFHF)
C
      IPRNT=0
C
      IOFF(1)=0
      DO 101 I=1,255
  101 IOFF(I+1)=IOFF(I)+I
C
C   READ IN INTEGRAL INFORMATION FROM 34 FILE
      CALL RFILE(ITAP34)
C     WRITE (JOUT,*) ' RFILE TAPE 34'
      CALL WREADW(ITAP34,NKIND,1,1,IEND)
C     WRITE (JOUT,*) ' NKIND=',NKIND
      CALL WREADW(ITAP34,ICLOS,1,IEND,IEND)
C     WRITE (JOUT,*) ' ICLOS=',ICLOS
      CALL WREADW(ITAP34,BLABEL,20,IEND,IEND)
C     WRITE (JOUT,*) ' BLABEL=',BLABEL
      CALL WREADW(ITAP34,ENUC,2,IEND,IEND)
C     WRITE (JOUT,*) ' ENUC=',ENUC
      CALL WREADW(ITAP34,NST,1,IEND,IEND)
C     WRITE (JOUT,*) ' NST=',NST
      CALL WREADW(ITAP34,ND,NST,IEND,IEND)
C     WRITE (JOUT,*) ' ND=',ND
      CALL WREADW(ITAP34,ITYP,NST,IEND,IEND)
C     WRITE (JOUT,*) ' ITYP=',ITYP
      CALL WREADW(ITAP34,NDEG,NST,IEND,IEND)
C     WRITE (JOUT,*) ' NDEG=',NDEG
      CALL WREADW(ITAP34,NS,1,IEND,IEND)
C     WRITE (JOUT,*) ' NS=',NS
      CALL WREADW(ITAP34,MTYPE,2*NS,IEND,IEND)
C     WRITE (JOUT,*) ' MTYPE=',MTYPE
      CALL WREADW(ITAP34,LAPU,1,IEND,IEND)
C     WRITE (JOUT,*) ' LAPU=',LAPU
      CALL WREADW(ITAP34,MS,LAPU,IEND,IEND)
C     WRITE (JOUT,*) ' MS=',MS
      CALL WREADW(ITAP34,MNL,LAPU,IEND,IPARA)
      ITOT=25+INTOWP(1)+2*NS+3*NST+2*LAPU
      ISADR=I2SEC(ITOT)+1
      CALL RSETSA(ITAP34,ISADR)
      CALL RGETSA(ITAP34,IJUNK)
C     WRITE(*,*) ' TAPE 34 POSITIONED AT SECTOR ',IJUNK
C
      NSYM=0
      NBASIS=0
      DO 102 I=1,NST
      IF(NDEG(I).GT.0) NSYM=NSYM+1
      NBASIS=NBASIS+NDEG(I)
  102 CONTINUE
      IDEG(1)=0
      LSYM(1)=0
      IF(NSYM.EQ.1) GO TO 203
      II=0
      DO 103 I=2,NST
      IF(NDEG(I).LE.0) GO TO 202
  201 II=II+1
      NN=NDEG(II)
      IF(NN.EQ.0) GO TO 201
      IDEG(I)=IDEG(I-1)+NN
      LSYM(I)=LSYM(I-1)+IOFF(NN+1)
      GO TO 103
  202 LSYM(I)=LSYM(I-1)
      IDEG(I)=IDEG(I-1)
  103 CONTINUE
  203 CONTINUE
C     WRITE(*,*) ' NSYM,IBUFHF,MTRI',NSYM,IBUFHF,MTRI
C     WRITE(*,*) ' IDEG = ',IDEG
C
C   CREATE SO INTEGRAL FILES
C     WRITE(3,21)
C  21 FORMAT(//,2X,' NOW YOU ARE IN RDONE'/)
C     IBUFHF=4471
      CALL RDONE(S,H,T,V,LBLI,STVI,IBUFHF,ITAP34,JOUT)
C
      RETURN
      END
