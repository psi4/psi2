       SUBROUTINE CRUNCH(FORCEP,FORCEN,FORCE,H,U,DISP,YWGHT,GEOM,YFLAG)
       IMPLICIT DOUBLE PRECISION (A-H,O-Z)
       DIMENSION IQ(60),X(60)
       DIMENSION FORCE(N,N),FORCEP(N,N),FORCEN(N,N),H(N,N),U(N,N),
     * DISP(N),YWGHT(ICEN),GEOM(3,ICEN)
      REAL*8 MDYNE
      INTEGER SYM,FLAG,YFLAG
       COMMON /PARAM/VECT(60),ANGS,FRCS,MDYNE
     1,SYM(60),ICEN,N,ISYM,ITYPE(20),IATNO(20),ITAPE5
       DO 10 I=1,N
       DO 10 J=1,N
 10    FORCE(I,J) = FRCS * (FORCEP(I,J) - FORCEN(I,J))/DISP(J)
       CALL YUKIO(FORCE)
       DO 15 I=1,N
       DO 15 J=1,N
 15    FORCE(I,J) = FORCE(I,J) * MDYNE
       WRITE(6,11)
 11    FORMAT(//,'    NORMALIZED TWO POINT DIFFERENCE MATRIX OF FORCE CO
     +NSTANTS',/)
       CALL PRINMA(N,FORCE)
       CALL MASS(FORCE,YWGHT)
       DO 20 I=1,N
       DO 20 J=1,I
       H(I,J) = FORCE(I,J)
 20    H(J,I) = H(I,J)
       CALL HDIAG(H,U,X,N,IQ,0)
       DO 30 I=1,N
 30    X(I) = H(I,I)
       CALL VIB(N,X)
       WRITE (6,31)
 31    FORMAT(//,'    FORCES AND VIBRATIONAL FREQUENCIES FROM LOWER HALF
     + MATRIX',/)
       CALL PRINFO(N,H,X,U)
       DO 40 I=1,N
       DO 40 J=1,I
       H(I,J) = FORCE(J,I)
 40    H(J,I) = H(I,J)
       CALL HDIAG(H,U,X,N,IQ,0)
       DO 50 I=1,N
 50    X(I) = H(I,I)
       CALL VIB(N,X)
       WRITE (6,51)
 51    FORMAT(//,'    FORCES AND VIBRATIONAL FREQUENCIES FROM UPPER HALF
     + MATRIX'/)
       CALL PRINFO(N,H,X,U)
       DO 60 I=1,N
       DO 60 J=1,I
       H(I,J) = (FORCE(I,J) + FORCE(J,I)) / 2.0
   60  H(J,I)=H(I,J)
       CALL HDIAG(H,U,X,N,IQ,0)
       DO 70 I=1,N
 70    X(I) = H(I,I)
       CALL VIB(N,X)
       WRITE (6,71)
 71    FORMAT(//,'    FORCES AND VIBRATIONAL FREQUENCIES FROM SYMMETRIZE
     +D MATRIX'/)
       CALL PRINFO(N,H,X,U)
       RETURN
       END
