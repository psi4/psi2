      SUBROUTINE INPUT(FORCEP,FORCEN,REF,DISP2,GEOM,FLAG,YFLAG)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      INTEGER SYM,FLAG,SCRCOD,SCRNUM,ATNUM,TYPE,YFLAG
      REAL*8 MDYNE
      COMMON /PARAM/ VECT(60),ANGS,FRCS,MDYNE
     1,SYM(60),ICEN,N,ISYM,ITYPE(20),IATNO(20),ITAPE5
      COMMON /MASSES/ AMASS(30)
      DIMENSION FORCEP(N,N),FORCEN(N,N),REF(N),ILBL(15),DISP(10)
      DIMENSION SCRCOD(20),SCRNUM(20),LABEL(4,2),DISP2(N),GEOM(3,ICEN)
      DATA MINUS/1H-/
      DATA ILBL/3HFIN,3HDIS,3HCEN,3HSYM,3HFOR,3HREF,3HINC,3HANG,3HFRC,
     * 3HYUK,3HMAS,4*3H   /
      DATA LABEL/3HWIT,3HH N,3HORM,3HAL ,3HALO,3HNG ,3H   ,3H   /
      DATA LBLPL,LBLIR /2HPL,2HIR/
      DO 4 I=1,30
 4    SYM(I) = 0
      LBLS = 10
      NELEM = 20
      FRCS=1.0D+00
      ANGS=0.52917706D+00
      MDYNE=8.238880749D+00
      ISYM = 1
      FLAG=0
      NSYMS=0
      DO 5 I=1,N
   5  DISP2(I)=1.0D+00
      GO TO 300
   10 READ(ITAPE5,15) LBL,IATOM,INUM,ISIGN,NPAIR
   15 FORMAT(A3,4X,A2,I1,A1,I3)
      DO 20 I=1,LBLS
 20   IF(ILBL(I).EQ.LBL) GO TO 30
 30   GO TO (100,200,300,400,500,600,700,800,900,1000,1100),I
      WRITE(6,31)LBL
 31   FORMAT(16H INVALID LABEL ',A3,12H'ENCOUNTERED)
      ISTOP=0
      IF(ISTOP.EQ.0)STOP
 100  WRITE (6,101)
 101  FORMAT ( '    END OF DATA INPUT ')
      RETURN
 200  WRITE(6,201)
 201  FORMAT( ' THE CARTESIAN DISPLACEMENT IS ')
      IF(INUM.EQ.0) INUM=1
      DO 210 J=1,INUM
      READ(ITAPE5,202)DISP(J)
 202  FORMAT(F10.6)
      WRITE(6,203)DISP(J)
 203  FORMAT(32X,F10.6,' BOHR ')
C     CONVERT TO ANGSTROMS
      TWO=2.0D+00
 210  DISP(J)=TWO*DISP(J)*ANGS
      GO TO 10
 300  CONTINUE
      READ(ITAPE5,301)(SCRCOD(J),SCRNUM(J),J=1,ICEN)
 301  FORMAT(20(A2,I1,1X))
      WRITE(6,302) ICEN
      WRITE (6,303) (SCRCOD(J),SCRNUM(J),J=1,ICEN)
302   FORMAT (//,5X,'PROGRAM HVIB',//,5X,'VIBRATIONAL FREQUENCIES BY FIN
     +ITE-DIFFERENCE OF ANALYTIC GRADIENTS ',///,' THERE ARE ',I2,' CENT
     +ERS')
303   FORMAT(1X,10(A2,I1,1X))
      DO 310 J=1,ICEN
310   CALL CODE(SCRCOD(J),SCRNUM(J),IATNO(J),ITYPE(J))
      GO TO 10
400   NSYMS=NSYMS+1
      IF(NPAIR.EQ.0) NPAIR=1
      IF(IATOM.NE.LBLPL) GO TO 410
      WRITE (6,401)
401   FORMAT( ' THERE IS A PLANE CONNECTING')
      TYPE=1
      SYM(ISYM)=1
      SYM(ISYM+1)=NPAIR
      INUM=2
      ISYM=ISYM+2
      GO TO 420
410   IF(IATOM.EQ.LBLIR) GO TO 415
      WRITE (6,411) INUM
411   FORMAT( ' THERE IS A C',I1,' AXIS CONNECTING ')
      TYPE=2
      SYM(ISYM)=2
      SYM(ISYM+1)=NPAIR
      SYM(ISYM+2)=INUM
      IF(ISIGN.EQ.MINUS) SYM(ISYM+2)=-INUM
      ISYM=ISYM+3
      GO TO 420
415   SYM(ISYM)=3
      SYM(ISYM+1)=NPAIR
      SYM(ISYM+2)=INUM
      IF(ISIGN.EQ.MINUS) SYM(ISYM+2)=-INUM
      SYM(ISYM+3)=NPAIR
      TYPE=2
      WRITE (6,416) INUM
416   FORMAT( ' THERE IS A S',I1,' AXIS CONNECTING')
      INUM=2
      ISYM=ISYM+4
420   DO 425 I=1,NPAIR
      J1=INUM*(I-1)+1
      J2=J1+(INUM-1)
      READ(ITAPE5,301) (SCRCOD(J),SCRNUM(J),J=J1,J2)
      WRITE (6,303) (SCRCOD(J),SCRNUM(J),J=J1,J2)
425   CONTINUE
      INUM=INUM*NPAIR
      DO 430 J=1,INUM
      CALL CODE(SCRCOD(J),SCRNUM(J),ATNUM,SYM(ISYM))
430   ISYM=ISYM+1
      K=3*(NSYMS-1)+1
      K1=K+2
      READ(ITAPE5,440)(VECT(J),J=K,K1)
440   FORMAT(3F10.8)
      WRITE (6,441) (LABEL(J,TYPE),J=1,4),(VECT(KJ),KJ=K,K1)
441   FORMAT (7X,4A3,/,16X,'X',12X,'Y',12X,'Z',/,10X,3F13.7,/)
       GO TO 10
500    CONTINUE
       CALL CODE(IATOM,INUM,ATNUM,ICODE)
       DO 510 I=1,ICEN
 510   IF(ICODE.EQ.ITYPE(I)) GO TO 520
       WRITE(6,511)IATOM,INUM
 511   FORMAT(' ',A2,I1,' DID NOT APPEAR IN CENTERS LIST')
       ISTOP=0
       IF(ISTOP.EQ.0)STOP
520    WRITE (6,512) IATOM,INUM
512    FORMAT(3X,' PROCESSING ',A2,I1,2X)
      CALL INITM(I,FORCEP,FORCEN,REF)
      IF(NPAIR.EQ.0) NPAIR=1
      DISP2(I)=DISP(NPAIR)
       GO TO 10
  600 DO 610 I=1,N
  610 REF(I)=0.0D+00
      K=0
      DO 630 I=1,ICEN
      K=(I-1)*3
      READ(ITAPE5,620) REF(K+1),REF(K+2),REF(K+3)
  620 FORMAT(3F10.8)
  630 CONTINUE
      GO TO 10
  700 FLAG=1
      WRITE (6,701)
  701 FORMAT(1X,' INCOMPLETE FORCE DATA,BYE ')
      RETURN
  800 ANGS=1.0 D+00
      MDYNE=1.0 D+00
      GO TO 10
  900 FRC=-1.0 D+00
      GO TO 10
 1000 YFLAG=1
      GO TO 10
 1100 CALL CODE(IATOM,INUM,ATNUM,ICODE)
      DO 1110 I=1,ICEN
 1110 IF(ICODE.EQ.ITYPE(I)) GO TO 1120
      WRITE(6,1115)IATOM,INUM
 1115 FORMAT( A2,I1,' DID NOT APPEAR IN CENTERS LIST')
      ISTOP=0
      IF(ISTOP.EQ.0)STOP
 1120 READ(ITAPE5,1125) AMASS1
 1125 FORMAT(F20.12)
      WRITE(6,1130) IATOM,AMASS1
 1130 FORMAT( 'CHANGING MASS FOR ',A2,' TO ',F10.6)
      AMASS(ATNUM)=AMASS1
      GO TO 10
      END
