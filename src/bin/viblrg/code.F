       SUBROUTINE CODE(ATOM,NUM,ATNUM,CDE)
       IMPLICIT DOUBLE PRECISION (A-H,O-Z)
       INTEGER ATOM,ATNUM,PERTAB(30),CDE
       DATA PERTAB/2H H,2HHE,2HLI,2HBE,2H B,2H C,2H N,2H O,2H F,2HNE,
     * 2HNA,2HMG,2HAL,2HSI,2H P,2H S,2HCL,2HAR,2H K,2HCA,2HSC,2HTI,2H V,
     * 2HCR,2HMN,2HFE,2HCO,2HNI,2HCU,2HZN/
       NELEM = 30
       DO 10 I=1,NELEM
 10    IF(PERTAB(I).EQ.ATOM) GO TO 20
       WRITE(6,1)ATOM
 1     FORMAT( ' UNKNOWN ELEMENT ENCOUNTERED...',A2)
       ISTOP=0
       IF(ISTOP.EQ.0)STOP
 20    CDE = I + 1000 * NUM
       ATNUM = I
       RETURN
      END
