C     ////////////////////////////////////////////////////////////
C LIN2
      SUBROUTINE VECT4(NAD,K1,K2,K3,K4,V1,V2,V3,XA,W)
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*8 V1(3),V2(3),V3(3),XA(NAD,3),E21(3),E23(3)
      DIMENSION E2M(3),EA(3),V4(3),V5(3)
      PARAMETER(ONE=1.0D0)
      CALL VECT1(NAD,K1,K2,E21,XA,T21)
      CALL VECT1(NAD,K3,K2,E23,XA,T23)
      CALL VECT1(NAD,K4,K2,E2M,XA,W)
      CALL SCAPRO(E21,E2M,W1)
      W2=DSQRT(ONE-W1*W1)
      DO 5  I=1,3
  5   EA(I)=(W1*E21(I)-E2M(I))/W2
      CALL VECPRO(E23,E21,E2M)
      CALL SCAPRO(EA,E2M,STHETA)
      W=DASIN(STHETA)
      CTHETA=DCOS(W)
      TTHETA=STHETA/CTHETA
      CALL VECPRO(EA,E23,V4)
      CALL VECPRO(EA,E21,V5)
      DO 15  I=1,3
      V1(I)=(V4(I)/CTHETA-E21(I)*TTHETA)/T21
      V3(I)=-(V5(I)/CTHETA+E23(I)*TTHETA)/T23
 15   V2(I)=-(V1(I)+V3(I))
      RETURN
      END
