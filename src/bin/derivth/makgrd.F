      SUBROUTINE MAKGRD(N)
      IMPLICIT REAL*8 (A-H,O-Z)
ctph  COMMON/ABDEN/ABDENS(1296)
c11-14-88  (For  7Mb)  COMMON/ABDEN/ABDENS(10000)
c11-14-88  (For 15Mb)  COMMON/ABDEN/ABDENS(50625)
      COMMON/ABDEN/ABDENS(10000)
ctph  COMMON/DERIN/DERINT(1296,9)
C11-14-88  (For  7Mb) COMMON/DERIN/DERINT(10000,9)
C11-14-88  (For 15Mb) COMMON/DERIN/DERINT(50625,9)
      COMMON/DERIN/DERINT(10000,9)
      COMMON/D1INT/XIDER,YIDER,ZIDER,XJDER,YJDER,ZJDER,
     1             XKDER,YKDER,ZKDER
      COMMON/PARA3/NATMS(4),NPASS
      COMMON/TOLER/DLIM
C
ctph  write(6,*) 'derint(n,3)',(derint(i,3),i=1,n)
ctph  write(6,*) 'abdens',(abdens(i),i=1,n)
      IF(NPASS.EQ.1) THEN
      XIDER=DOT(DERINT(1,1),ABDENS,N)
      YIDER=DOT(DERINT(1,2),ABDENS,N)
      ZIDER=DOT(DERINT(1,3),ABDENS,N)
      XJDER=DOT(DERINT(1,4),ABDENS,N)
      YJDER=DOT(DERINT(1,5),ABDENS,N)
      ZJDER=DOT(DERINT(1,6),ABDENS,N)
      XKDER=DOT(DERINT(1,7),ABDENS,N)
      YKDER=DOT(DERINT(1,8),ABDENS,N)
      ZKDER=DOT(DERINT(1,9),ABDENS,N)
      ELSE IF(NPASS.EQ.2) THEN
      XIDER=DOT(DERINT(1,1),ABDENS,N)
      YIDER=DOT(DERINT(1,2),ABDENS,N)
      ZIDER=DOT(DERINT(1,3),ABDENS,N)
      XJDER=DOT(DERINT(1,4),ABDENS,N)
      YJDER=DOT(DERINT(1,5),ABDENS,N)
      ZJDER=DOT(DERINT(1,6),ABDENS,N)
      ELSE IF(NPASS.EQ.3) THEN
      XIDER=DOT(DERINT(1,1),ABDENS,N)
      YIDER=DOT(DERINT(1,2),ABDENS,N)
      ZIDER=DOT(DERINT(1,3),ABDENS,N)
      XKDER=DOT(DERINT(1,4),ABDENS,N)
      YKDER=DOT(DERINT(1,5),ABDENS,N)
      ZKDER=DOT(DERINT(1,6),ABDENS,N)
      ELSE IF(NPASS.EQ.4) THEN
      XIDER=DOT(DERINT(1,1),ABDENS,N)
      YIDER=DOT(DERINT(1,2),ABDENS,N)
      ZIDER=DOT(DERINT(1,3),ABDENS,N)
      ELSE
        STOP 'INVALID VALUE OF NPASS IN MAKGRD'
      END IF
      RETURN
      END
