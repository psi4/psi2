      SUBROUTINE mk2i
      IMPLICIT REAL*8 (A-H,O-Z)
      DIMENSION XIDINT(1),YIDINT(1),ZIDINT(1)
      DIMENSION XJDINT(1),YJDINT(1),ZJDINT(1)
      DIMENSION XKDINT(1),YKDINT(1),ZKDINT(1)
CTPH  COMMON/ABDEN/ABDENS(1296)
CTPH  COMMON/DERIN/DERINT(1296,9)
c11-14-88  (For  7Mb)  COMMON/ABDEN/ABDENS(10000)
c11-14-88  (For 15Mb)  COMMON/ABDEN/ABDENS(50625)
      COMMON/ABDEN/ABDENS(10000)
C11-14-88  (For  7Mb) COMMON/DERIN/DERINT(10000,9)
C11-14-88  (For 15Mb) COMMON/DERIN/DERINT(50625,9)
      COMMON/DERIN/DERINT(10000,9)
ctph  COMMON/DINDX/IJX(100),IJY(100),IJZ(100),KLX(100),KLY(100),KLZ(100)
      COMMON/DINDX/IJX(225),IJY(225),IJZ(225),KLX(225),KLY(225),KLZ(225)
      COMMON/D2INT/DXIDXI,DXIDXJ,DXIDXK,
     1             DXJDXJ,DXJDXK,DXKDXK,
     2             DYIDYI,DYIDYJ,DYIDYK,
     3             DYJDYJ,DYJDYK,DYKDYK,
     4             DZIDZI,DZIDZJ,DZIDZK,
     5             DZJDZJ,DZJDZK,DZKDZK,
     6             DXIDYI,DXJDYI,DXKDYI,
     7             DXIDYJ,DXJDYJ,DXKDYJ,
     8             DXIDYK,DXJDYK,DXKDYK,
     9             DXIDZI,DXJDZI,DXKDZI,
     A             DXIDZJ,DXJDZJ,DXKDZJ,
     B             DXIDZK,DXJDZK,DXKDZK,
     C             DYIDZI,DYJDZI,DYKDZI,
     D             DYIDZJ,DYJDZJ,DYKDZJ,
     E             DYIDZK,DYJDZK,DYKDZK
      COMMON/PARA4/MIJ,MKL,ISAME(100)
      COMMON/ROOTS/NONZER
      COMMON/TOLER/DLIM
ctph  COMMON/TWOD0/XIN(2304),YIN(2304),ZIN(2304)
ctph  COMMON/TWODI/DXI(2304),DYI(2304),DZI(2304)
ctph  COMMON/TWODJ/DXJ(2304),DYJ(2304),DZJ(2304)
ctph  COMMON/TWODK/DXK(2304),DYK(2304),DZK(2304)
ctph  COMMON/TWDII/DXIXI(2304),DYIYI(2304),DZIZI(2304)
ctph  COMMON/TWDJJ/DXJXJ(2304),DYJYJ(2304),DZJZJ(2304)
ctph  COMMON/TWDKK/DXKXK(2304),DYKYK(2304),DZKZK(2304)
ctph  COMMON/TWDIJ/DXIXJ(2304),DYIYJ(2304),DZIZJ(2304)
ctph  COMMON/TWDIK/DXIXK(2304),DYIYK(2304),DZIZK(2304)
ctph  COMMON/TWDJK/DXJXK(2304),DYJYK(2304),DZJZK(2304)
      COMMON/TWOD0/XIN(6250),YIN(6250),ZIN(6250)
      COMMON/TWODI/DXI(6250),DYI(6250),DZI(6250)
      COMMON/TWODJ/DXJ(6250),DYJ(6250),DZJ(6250)
      COMMON/TWODK/DXK(6250),DYK(6250),DZK(6250)
      COMMON/TWDII/DXIXI(6250),DYIYI(6250),DZIZI(6250)
      COMMON/TWDJJ/DXJXJ(6250),DYJYJ(6250),DZJZJ(6250)
      COMMON/TWDKK/DXKXK(6250),DYKYK(6250),DZKZK(6250)
      COMMON/TWDIJ/DXIXJ(6250),DYIYJ(6250),DZIZJ(6250)
      COMMON/TWDIK/DXIXK(6250),DYIYK(6250),DZIZK(6250)
      COMMON/TWDJK/DXJXK(6250),DYJYK(6250),DZJZK(6250)
      EQUIVALENCE (DERINT(1,1),XIDINT(1))
      EQUIVALENCE (DERINT(1,2),YIDINT(1))
      EQUIVALENCE (DERINT(1,3),ZIDINT(1))
      EQUIVALENCE (DERINT(1,4),XJDINT(1))
      EQUIVALENCE (DERINT(1,5),YJDINT(1))
      EQUIVALENCE (DERINT(1,6),ZJDINT(1))
      EQUIVALENCE (DERINT(1,7),XKDINT(1))
      EQUIVALENCE (DERINT(1,8),YKDINT(1))
      EQUIVALENCE (DERINT(1,9),ZKDINT(1))
      DATA ZERO,ONE,TWO / 0.0D+00 , 1.0D+00 , 2.0D+00 /
C
cets071389      ENTRY MK2I
C
      N=0
      DO 104 I=1,MIJ
      NX=IJX(I)
      NY=IJY(I)
      NZ=IJZ(I)
      DO 104 K=1,MKL
      MX=NX+KLX(K)
      MY=NY+KLY(K)
      MZ=NZ+KLZ(K)
      N=N+1
      X=XIN(MX)
      Y=YIN(MY)
      Z=ZIN(MZ)
      XY=X*Y
      XZ=X*Z
      YZ=Y*Z
      XI=DXI(MX)
      YI=DYI(MY)
      ZI=DZI(MZ)
C
      XIDINT(N)=XIDINT(N) + XI * YZ
      YIDINT(N)=YIDINT(N) + YI * XZ
      ZIDINT(N)=ZIDINT(N) + ZI * XY
C
      DENSTY=ABDENS(N)
      IF(DABS(DENSTY).LT.DLIM) GO TO 104
      XITZ=XI*Z*DENSTY
      XITY=XI*Y*DENSTY
      XTYI=X*YI*DENSTY
C
      DXIDXI = DXIDXI + DXIXI(MX) * YZ * DENSTY
C
      DYIDYI = DYIDYI + DYIYI(MY) * XZ * DENSTY
C
      DZIDZI = DZIDZI + DZIZI(MZ) * XY * DENSTY
C
      DXIDYI = DXIDYI + XITZ * YI
C
      DXIDZI = DXIDZI + XITY  * ZI
C
      DYIDZI = DYIDZI + XTYI * ZI
C
  104 CONTINUE
      RETURN
      END

