      SUBROUTINE FORMEG(D1T)
      IMPLICIT REAL*8 (A-H,O-Z)
      COMMON/D1INT/XIDER,YIDER,ZIDER,XJDER,YJDER,ZJDER,
     1             XKDER,YKDER,ZKDER
      COMMON/FUNCS/NTYPES,NTYPEP,NTREAD,NATOM,N3N,NATRI,NSYM
      COMMON/PARA3/NATMS(4),NPASS
      COMMON/TOLER/DLIM
      DIMENSION D1T(3,NATOM)
C
      IF(NPASS.EQ.1) THEN
        D1T(1,NATMS(1))=D1T(1,NATMS(1))+XIDER
        D1T(2,NATMS(1))=D1T(2,NATMS(1))+YIDER
        D1T(3,NATMS(1))=D1T(3,NATMS(1))+ZIDER
        D1T(1,NATMS(2))=D1T(1,NATMS(2))+XJDER
        D1T(2,NATMS(2))=D1T(2,NATMS(2))+YJDER
        D1T(3,NATMS(2))=D1T(3,NATMS(2))+ZJDER
        D1T(1,NATMS(3))=D1T(1,NATMS(3))+XKDER
        D1T(2,NATMS(3))=D1T(2,NATMS(3))+YKDER
        D1T(3,NATMS(3))=D1T(3,NATMS(3))+ZKDER
        D1T(1,NATMS(4))=D1T(1,NATMS(4))-XIDER-XJDER-XKDER
        D1T(2,NATMS(4))=D1T(2,NATMS(4))-YIDER-YJDER-YKDER
        D1T(3,NATMS(4))=D1T(3,NATMS(4))-ZIDER-ZJDER-ZKDER
ctph  WRITE(6,*) 'XIDER,ETC.'
ctph  WRITE(6,*) XIDER,YIDER,ZIDER,XJDER,YJDER,ZJDER,XKDER,YKDER,ZKDER
      ELSE IF(NPASS.EQ.2) THEN
        D1T(1,NATMS(1))=D1T(1,NATMS(1))+XIDER
        D1T(2,NATMS(1))=D1T(2,NATMS(1))+YIDER
        D1T(3,NATMS(1))=D1T(3,NATMS(1))+ZIDER
        D1T(1,NATMS(2))=D1T(1,NATMS(2))+XJDER
        D1T(2,NATMS(2))=D1T(2,NATMS(2))+YJDER
        D1T(3,NATMS(2))=D1T(3,NATMS(2))+ZJDER
        D1T(1,NATMS(3))=D1T(1,NATMS(3))-XIDER-XJDER
        D1T(2,NATMS(3))=D1T(2,NATMS(3))-YIDER-YJDER
        D1T(3,NATMS(3))=D1T(3,NATMS(3))-ZIDER-ZJDER
ctph  WRITE(6,*) 'XIDER,ETC.'
ctph  WRITE(6,*) NPASS,XIDER,YIDER,ZIDER,XJDER,YJDER,ZJDER
      ELSE IF(NPASS.EQ.3) THEN
        D1T(1,NATMS(1))=D1T(1,NATMS(1))+XIDER
        D1T(2,NATMS(1))=D1T(2,NATMS(1))+YIDER
        D1T(3,NATMS(1))=D1T(3,NATMS(1))+ZIDER
        D1T(1,NATMS(2))=D1T(1,NATMS(2))+XKDER
        D1T(2,NATMS(2))=D1T(2,NATMS(2))+YKDER
        D1T(3,NATMS(2))=D1T(3,NATMS(2))+ZKDER
        D1T(1,NATMS(3))=D1T(1,NATMS(3))-XIDER-XKDER
        D1T(2,NATMS(3))=D1T(2,NATMS(3))-YIDER-YKDER
        D1T(3,NATMS(3))=D1T(3,NATMS(3))-ZIDER-ZKDER
ctph  WRITE(6,*) 'XIDER,ETC.'
ctph  WRITE(6,*) NPASS,XIDER,YIDER,ZIDER,XKDER,YKDER,ZKDER
      ELSE IF(NPASS.EQ.4) THEN
        D1T(1,NATMS(1))=D1T(1,NATMS(1))+XIDER
        D1T(2,NATMS(1))=D1T(2,NATMS(1))+YIDER
        D1T(3,NATMS(1))=D1T(3,NATMS(1))+ZIDER
        D1T(1,NATMS(2))=D1T(1,NATMS(2))-XIDER
        D1T(2,NATMS(2))=D1T(2,NATMS(2))-YIDER
        D1T(3,NATMS(2))=D1T(3,NATMS(2))-ZIDER
ctph  WRITE(6,*) 'XIDER,ETC.'
ctph  WRITE(6,*) NPASS,XIDER,YIDER,ZIDER
      ELSE
        STOP 'INVALID VALUE OF NPASS IN FORMEG'
      END IF
      RETURN
      END
