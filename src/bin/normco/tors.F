      SUBROUTINE TORS(B,EX,EY,EZ,NXYZ,NNE)
      IMPLICIT REAL*8 (A-H,O-Z)
      DIMENSION B(NXYZ,NXYZ),EX(NNE,NNE),EY(NNE,NNE),EZ(NNE,NNE)
      COMMON/VIB103/NST,NBND,NLIB,NDEF,NTORS
      COMMON/VIB202/R(1275)
      COMMON/VIB205/IOFF(150)
      COMMON/VIB305/KT(150),LT(150),MT(150),NT(150)
      COMMON/VIB306/AGLB(150),AGLT(150),AGLO(150),AGLR(150)
C
C   THE CALCULATION OF S VECTORS FOR TORSIONS
C   BASED ON DEFINITION OF WILSON-DECIOUS-CROSS
      DO 101 I=1,NTORS
      II=I+NST+NBND+NLIB+NDEF
      K=KT(I)
      L=LT(I)
      M=MT(I)
      N=NT(I)
      KX=3*K-2
      KY=3*K-1
      KZ=3*K
      LX=3*L-2
      LY=3*L-1
      LZ=3*L
      MX=3*M-2
      MY=3*M-1
      MZ=3*M
      NX=3*N-2
      NY=3*N-1
      NZ=3*N
      KL=IOFF(MAX0(K,L))+MIN0(K,L)
      MN=IOFF(MAX0(M,N))+MIN0(M,N)
      ML=IOFF(MAX0(M,L))+MIN0(M,L)
      AL=AGLT(I)
      AM=AGLO(I)
      CEXKM=EY(K,L)*EZ(L,M)-EZ(K,L)*EY(L,M)
      CEYKM=EZ(K,L)*EX(L,M)-EX(K,L)*EZ(L,M)
      CEZKM=EX(K,L)*EY(L,M)-EY(K,L)*EX(L,M)
      CEXNL=EY(N,M)*EZ(M,L)-EZ(N,M)*EY(M,L)
      CEYNL=EZ(N,M)*EX(M,L)-EX(N,M)*EZ(M,L)
      CEZNL=EX(N,M)*EY(M,L)-EY(N,M)*EX(M,L)
      RS2K=R(KL)*DSIN(AL)**2
      RS2M=R(ML)*DSIN(AM)**2
      RS2N=R(MN)*DSIN(AM)**2
      RS2L=R(ML)*DSIN(AL)**2
      B(II,KX)=-CEXKM/RS2K
      B(II,KY)=-CEYKM/RS2K
      B(II,KZ)=-CEZKM/RS2K
      B(II,LX)=(R(ML)-R(KL)*DCOS(AL))*CEXKM/(R(ML)*RS2K)+
     1 DCOS(AM)*CEXNL/RS2M
      B(II,LY)=(R(ML)-R(KL)*DCOS(AL))*CEYKM/(R(ML)*RS2K)+
     1 DCOS(AM)*CEYNL/RS2M
      B(II,LZ)=(R(ML)-R(KL)*DCOS(AL))*CEZKM/(R(ML)*RS2K)+
     1 DCOS(AM)*CEZNL/RS2M
      B(II,MX)=(R(ML)-R(MN)*DCOS(AM))*CEXNL/(R(ML)*RS2N)+
     1 DCOS(AL)*CEXKM/RS2L
      B(II,MY)=(R(ML)-R(MN)*DCOS(AM))*CEYNL/(R(ML)*RS2N)+
     1 DCOS(AL)*CEYKM/RS2L
      B(II,MZ)=(R(ML)-R(MN)*DCOS(AM))*CEZNL/(R(ML)*RS2N)+
     1 DCOS(AL)*CEZKM/RS2L
      B(II,NX)=-CEXNL/RS2N
      B(II,NY)=-CEYNL/RS2N
  101 B(II,NZ)=-CEZNL/RS2N
      RETURN
      END
