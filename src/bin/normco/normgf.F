      SUBROUTINE NORMGF(F,G,S,WW,H,AA,Y,ELIN,ELL,POT,EKED,EE,GIN,
     1                  VALU,ROOT,FV1,FV2,NXYZ,NPQR,NABC)
      IMPLICIT REAL*8 (A-H,O-Z)
cets030991
#include <error.h>
      integer ip,prcntr
      DIMENSION F(NXYZ,NXYZ),G(NPQR),S(NPQR),WW(NABC,NABC),H(NABC,NABC)
      DIMENSION AA(NABC,NABC),Y(NABC,NABC),ELIN(NABC,NABC)
      DIMENSION ELL(NABC,NABC),POT(NABC,NABC),EKED(NABC,NABC)
      DIMENSION EE(NABC,NABC),GIN(NABC,NABC)
      DIMENSION VALU(NABC),ROOT(NABC),FV1(NABC),FV2(NABC)
      COMMON/VIB101/NATOM,NAT1,N3N,ILIN,NVIB,IDIPOL,IPOLAR
      COMMON/VIB104/PARA,WAVE,CONST,CYCL,CONV
      COMMON/VIB108/IZVLIM,IPLOT
      COMMON/VIB206/ROGAM(150),DEL(150),FREQ(150)
      COMMON/VIB207/VZERO
      DATA PH,BK,AVN / 6.626176D+00 , 1.380662D+00 , 6.022045D+00 /
      DATA CL,TEMP / 2.99792458D+00 , 298.15D+00 /
      DATA A00,HALF,ONE / 0.0D+00 , 0.5D+00 , 1.0D+00 /
    1 FORMAT(//,2X,' G MATRIX'/)
    2 FORMAT(//,2X,' F MATRIX'/)
    3 FORMAT(//,2X,' EIGENVALUES OF G MATRIX')
    4 FORMAT(13X,8H GAMMA-G,9X,13H ROOT GAMMA-G/)
    5 FORMAT(2X,I2,2(5X,F12.5))
    6 FORMAT(//,2X,' H MATRIX'/)
    7 FORMAT(//,2X,' EIGENVALUES OF H MATRIX')
    8 FORMAT(13X,8H GAMMA-H,6X,10H FREQUENCY/)
    9 FORMAT(//,2X,' EIGENVECTORS OF H MATRIX'/)
   10 FORMAT(//,2X,' ZERO-POINT VIBRATIONAL ENERGY'//
     1          2X,F20.5,' IN CM-1',5X,F20.5,' IN KCAL/MOL'/)
   11 FORMAT(//,2X,' L INVERSE MATRIX'/)
   12 FORMAT(//,2X,' L MATRIX'/)
   13 FORMAT(//,2X,' L X L(T) = G'/)
   14 FORMAT(//,2X,' L X L(-1) = E'/)
   15 FORMAT(//,2X,' POTENTIAL ENERGY DISTRIBUTION'/)
   16 FORMAT(//,2X,' KINETIC ENERGY DISTRIBUTION'/)
C
      WRITE(6,1)
      CALL PRINT(G,NPQR,NVIB,6)
      WRITE(6,2)
      CALL MATOUT(F,NXYZ,NXYZ,NVIB,NVIB,6)
C
C  LOWER LIMIT TO THE ZPVE CORRECTION
      ZLIMIT=FLOAT(IZVLIM)
C
C  A CONVERSION FACTOR FROM CM-1 TO KCAL.MOLE-1
      CMKM=(CL*PH*AVN*1.0D-04)/4.184D+00
C
C   THE CALCULATION OF EIGENVALUE AND EIGENVECTOR OF G MATRIX
      CALL RSP(NABC,NVIB,NPQR,G,VALU,1,WW,FV1,FV2)
      WRITE(6,3)
      WRITE(6,4)
      DO 101 I=1,NVIB
      ROGAM(I)=A00
      IF(VALU(I).LE.A00) GO TO 201
      ROGAM(I)=DSQRT(VALU(I))
  201 WRITE(6,5) I,VALU(I),ROGAM(I)
  101 CONTINUE
C
C   THE CALCULATION OF LGZERO MATRIX
      DO 102 I=1,NVIB
      DO 102 J=1,NVIB
  102 WW(I,J)=WW(I,J)*ROGAM(J)
C
C   THE CALCULATION OF H MATRIX
C     H MATRIX CORRESPONDS TO W*F*W
      CALL MTXMPY(WW,NABC,F,NXYZ,H,NABC,AA,NABC,NVIB,5)
      WRITE(6,6)
      IJ=0
      DO 103 I=1,NVIB
      DO 103 J=1,I
      IJ=IJ+1
      S(IJ)=H(I,J)
  103 CONTINUE
      CALL PRINT(S,NPQR,NVIB,6)
C
C   THE CALCULATION OF FREQUENCIES
      CALL RSP(NABC,NVIB,NPQR,S,ROOT,1,AA,FV1,FV2)
      WRITE(6,7)
      WRITE(6,8)
      DO 104 I=1,NVIB
      FREQ(I)=DSIGN(ONE,ROOT(I))*WAVE*DSQRT(DABS(ROOT(I)))
      WRITE(6,5) I,ROOT(I),FREQ(I)
  104 CONTINUE
      WRITE(6,9)
      CALL FRQOUT(AA,FREQ,NABC,NABC,NVIB,NVIB,6)
C
C   EVALUATE VIBRATIONAL ZERO-POINT ENERGY
C   THE SMALLEST FREQUENCY IS LIMITED TO ZLIMIT
      VZERO=A00
cets111690      DO 105 I=1,NVIB
      do 105 i=1,n3n-5
         IF(FREQ(I).LT.ZLIMIT) GO TO 105
         VZERO=VZERO+FREQ(I)
  105 CONTINUE
      VZERO=VZERO*HALF
      VKM=VZERO*CMKM
      WRITE(6,10) VZERO,VKM
C
C   THE CALCULATION OF L INVERSE MATRIX
      DO 106 I=1,NVIB
      DO 106 J=1,NVIB
      Y(I,J)=AA(J,I)/VALU(J)
  106 CONTINUE
      CALL MTXMPY(Y,NABC,WW,NABC,ELIN,NABC,EE,NABC,NVIB,3)
      WRITE(6,11)
      CALL FRQOUT(ELIN,FREQ,NABC,NABC,NVIB,NVIB,6)
C
C   THE CALCULATION OF L MATRIX
      CALL MTXMPY(WW,NABC,AA,NABC,ELL,NABC,EE,NABC,NVIB,1)
      WRITE(6,12)
      CALL FRQOUT(ELL,FREQ,NABC,NABC,NVIB,NVIB,6)
C
C   THE EXAMINATION OF ABOVE CALCULATION ACCORDING TO G MATRIX
      CALL MTXMPY(ELL,NABC,ELL,NABC,AA,NABC,EE,NABC,NVIB,3)
cets030991
      ip=prcntr('IS_ON BRIEF')
      if(ip.eq.0) then
        WRITE(6,13)
        CALL MATOUT(AA,NABC,NABC,NVIB,NVIB,6)
      endif
      CALL MTXMPY(ELL,NABC,ELIN,NABC,AA,NABC,EE,NABC,NVIB,1)
cets030991
      ip=prcntr('IS_ON BRIEF')
      if(ip.eq.0) then
        WRITE(6,14)
        CALL MATOUT(AA,NABC,NABC,NVIB,NVIB,6)
      endif
C
C   THE CALCULATION OF POTENTIAL ENERGY DISTRIBUTION
      DO 110 I=1,NVIB
      DO 110 J=1,NVIB
  110 POT(I,J)=A00
      DO 111 I=1,NVIB
      DO 111 J=1,NVIB
      POT(I,J)=POT(I,J)+(ELL(I,J)**2*F(I,I))/ROOT(J)
  111 CONTINUE
      WRITE(6,15)
      CALL FRQOUT(POT,FREQ,NABC,NABC,NVIB,NVIB,6)
C
C   THE CALCULATION OF KINETIC ENERGY DISTRIBUTION
      CALL MTXMPY(ELIN,NABC,ELIN,NABC,GIN,NABC,AA,NABC,NVIB,2)
      DO 112 I=1,NVIB
      DO 112 J=1,NVIB
  112 EKED(I,J)=A00
      DO 113 I=1,NVIB
      DO 113 J=1,NVIB
  113 EKED(I,J)=EKED(I,J)+GIN(I,I)*ELL(I,J)**2
      WRITE(6,16)
      CALL FRQOUT(EKED,FREQ,NABC,NABC,NVIB,NVIB,6)
C
      RETURN
      END
