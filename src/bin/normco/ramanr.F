      SUBROUTINE RAMANR(BIN,ELL)
      IMPLICIT REAL*8 (A-H,O-Z)
      integer n3n,nvib
      DIMENSION BIN(N3N,N3N),ELL(NVIB,NVIB)
      DIMENSION POLD(6,150),POLDD(6,150),GSQ(150)
      COMMON/VIB101/NATOM,NAT1,N3N,ILIN,NVIB,IDIPOL,IPOLAR
      COMMON/VIB204/DIPDR(3,150),POLDR(6,150)
      COMMON/VIB205/IOFF(150)
      COMMON/VIB206/ALP(150),ASQ(150),FREQ(150)
      DATA A00,HALF,THREE / 0.0D+00 , 0.5D+00 , 3.0D+00 /
    1 FORMAT(//,2X,' POLARIZABILITY DERIVATIVES W.R.T. INTERNAL COORDINA
     1TE'/)
    2 FORMAT(//,2X,' POLARIZABILITY DERIVATIVES W.R.T. NORMAL COORDINATE
     1S (IN A+2.AMU(-1/2))'/)
    3 FORMAT(//,2X,' NORMAL FREQUENCIES, SCATTERING ACTIVITY AND DEPOLAR
     1IZATION RATIO'/13X,' IN CM-1',13X,' A+4.AMU-1',18X,' RHO'/)
    4 FORMAT(2X,I5,4(F15.6,10X))
C
C   TRANSFORM POLARIZABILITY DERIVATIVES FROM CARTESIAN TO INTERNAL
C   COORDINATE
      CALL MATOUT(BIN,N3N,N3N,N3N,N3N,6)
      CALL MATOUT(ELL,NVIB,NVIB,NVIB,NVIB,6)
      DO 102 I=1,6
      DO 102 J=1,NVIB
      VALU=A00
      DO 101 K=1,N3N
  101 VALU=VALU+POLDR(I,K)*BIN(K,J)
      POLDD(I,J)=VALU
  102 CONTINUE
      WRITE(6,1)
      CALL MATOUT(POLDD,6,150,6,NVIB,6)
C
C   TRANSFORM POLARIZABILITY DERIVATIVES FROM INTERNAL TO NORMAL
C   COORDINATE
      DO 104 I=1,6
      DO 104 J=1,NVIB
      VALU=A00
      DO 103 K=1,NVIB
  103 VALU=VALU+POLDD(I,K)*ELL(K,J)
      POLD(I,J)=VALU
  104 CONTINUE
      WRITE(6,2)
      CALL FRQOUT(POLD,FREQ,6,150,6,NVIB,6)
C
C   CALCULATE ALPH'S
      DO 105 I=1,NVIB
      ALP(I)=(POLD(1,I)+POLD(3,I)+POLD(6,I))/THREE
      ASQ(I)=ALP(I)*ALP(I)
  105 CONTINUE
C
C   CALCULATE GAMMA SQUARE'S
      DO 107 I=1,NVIB
      VALU=A00
      DO 106 J=1,3
      DO 106 K=1,3
      JK=IOFF(MAX0(J,K))+MIN0(J,K)
  106 VALU=VALU+POLD(JK,I)*POLD(JK,I)
      GSQ(I)=(VALU*THREE-ASQ(I)*9.0D+00)*HALF
  107 CONTINUE
C
C   CALCULATE SCATTERING ACTIVITY AND DEPOLARIZATION RATIO
      WRITE(6,3)
      DO 108 I=1,NVIB
      SACT=ASQ(I)*45.0D+00+GSQ(I)*7.0D+00
      RHO=(GSQ(I)*THREE)/(ASQ(I)*45.0D+00+GSQ(I)*4.0D+00)

Crawdad.9.19.93 Set Depolarization ratio to zero if both
Crawdad.9.19.93 alpha^2 and gamma^2 are zero.
       if(asq(i).lt.1.0d-7.and.gsq(i).lt.1.0d-7) rho = a00
Crawdad.9.19.93

      WRITE(6,4) I,FREQ(I),SACT,RHO
  108 CONTINUE
C
      RETURN
      END
