      SUBROUTINE AMPFX(ELX,NABC)
      IMPLICIT REAL*8 (A-H,O-Z)
      DIMENSION ELX(NABC,NABC)
      COMMON/VIB101/NATOM,NAT1,N3N,ILIN,NVIB,IDIPOL,IPOLAR
      COMMON/VIB104/PARA,WAVE,CONST,CYCL,CONV
      COMMON/VIB201/CHG(50),X(50),Y(50),Z(50),W(50)
      COMMON/VIB202/R(1275)
      COMMON/VIB205/IOFF(150)
      COMMON/VIB206/SQM(150),DEL(150),FREQ(150)
      DATA A00,ONE / 0.0D+00 , 1.0D+00 /
    1 FORMAT(//,2X,' MEAN SQUARE AMPLITUDES OF NORMAL VIBRATIONS'/
     1 2X,4H NO.,5X,11H DEL IN A+2/)
    2 FORMAT(2X,I2,5X,F12.5)
    3 FORMAT(//,2X,' MEAN SQUARE AND ROOT MEAN SQUARE AMPLITUDES (AT 298
     1.15 K)'/
     2 2X,4H NO.,5X,2H X,5X,2H Y,5X,8H L2(X-Y),7X,7H L(X-Y)/
     3 25X,7H IN A+2,8X,5H IN A/)
    4 FORMAT(2X,I2,2X,2(5X,I2),3X,2(F10.5,5X))
C
      WRITE(6,1)
      DO 101 I=1,NVIB
      F2X=EXP(2.0D+00*CONV*DABS(FREQ(I)))
      COTH=(F2X+ONE)/(F2X-ONE)
      DEL(I)=(CONST/FREQ(I))*COTH
  101 WRITE(6,2) I,DEL(I)
      WRITE(6,3)
      IAM=0
      DO 103 I=1,NAT1
      IR=I+1
      DO 103 J=IR,NATOM
      IAM=IAM+1
      IJ=I+IOFF(J)
      R0=R(IJ)
      XR=X(I)-X(J)
      YR=Y(I)-Y(J)
      ZR=Z(I)-Z(J)
      IX=3*I-2
      IY=3*I-1
      IZ=3*I
      JX=3*J-2
      JY=3*J-1
      JZ=3*J
      SAMPXY=A00
      DO 102 K=1,NVIB
      SAMPXY=SAMPXY+DEL(K)*((XR/R0)*(ELX(IX,K)-ELX(JX,K))+
     1 (YR/R0)*(ELX(IY,K)-ELX(JY,K))+(ZR/R0)*(ELX(IZ,K)-ELX(JZ,K)))**2
  102 CONTINUE
      RMSXY=DSQRT(SAMPXY)
      WRITE(6,4) IAM,I,J,SAMPXY,RMSXY
  103 CONTINUE
C
      RETURN
      END
