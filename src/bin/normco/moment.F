      SUBROUTINE MOMENT
      IMPLICIT REAL*8 (A-H,O-Z)
      DIMENSION T(6),PR(3),EG(3,3),FV1(3),FV2(3)
      COMMON/VIB101/NATOM,NAT1,N3N,ILIN,NVIB,IDIPOL,IPOLAR
      COMMON/VIB104/PARA,WAVE,CONST,CYCL,CONV
      COMMON/VIB105/AIXX,AIYY,AIZZ,SUMW,ROTCM(3)
      COMMON/VIB201/CHG(50),X(50),Y(50),Z(50),W(50)
      DATA A00 / 0.0D+00 /
    1 FORMAT(//,2X,' CENTER OF MASS'/8X,' CMX',11X,' CMY',11X,' CMZ'//
     1 2X,3(5X,F10.7)/)
    2 FORMAT(//,2X,' CARTESIAN COORDINATES W.R.T. CENTER OF MASS'/
     1 5X,4H NO.,11X,2H X,13X,2H Y,13X,2H Z,13X,2H W/)
    3 FORMAT(2X,I7,5X,4F15.7)
    4 FORMAT(//,2X,' INERTIA TENSOR'/)
Crawdad.6.10.93
    5 FORMAT(//,2X,'PRINCIPAL MOM.OF INERTIA AND ROTATIONAL CONSTANTS'/)
    8 format(2X,4H NO.,7X,11H IN AMU.A+2,7X,10H IN G.CM+2,8X,
     1 8H IN CM-1,10X,7H IN MHZ/31X,8H (*D+39)/)
    6 FORMAT(2X,I2,3X,4D18.5)
    7 FORMAT(//,2X,' EIGENVECTOR OF INERTIA TENSOR'/)
C
C   THE CALCULATION OF CENTER OF MASS
      SUMW=A00
      SUMWX=A00
      SUMWY=A00
      SUMWZ=A00
      DO 101 I=1,NATOM
      SUMW=SUMW+W(I)
      SUMWX=SUMWX+W(I)*X(I)
      SUMWY=SUMWY+W(I)*Y(I)
      SUMWZ=SUMWZ+W(I)*Z(I)
  101 CONTINUE
      CMX=SUMWX/SUMW
      CMY=SUMWY/SUMW
      CMZ=SUMWZ/SUMW
      WRITE(6,1) CMX,CMY,CMZ
C   THE CARTESIAN COORDINATES W.R.T. CENTER OF MASS
      WRITE(6,2)
      DO 102 I=1,NATOM
      X(I)=X(I)-CMX
      Y(I)=Y(I)-CMY
      Z(I)=Z(I)-CMZ
      WRITE(6,3) I,X(I),Y(I),Z(I),W(I)
  102 CONTINUE
C
C   THE CALCULATION OF INERTIA TENSOR
      DO 103 I=1,6
  103 T(I)=A00
      DO 104 I=1,NATOM
      T(1)=T(1)+W(I)*(Y(I)**2+Z(I)**2)
      T(3)=T(3)+W(I)*(Z(I)**2+X(I)**2)
      T(6)=T(6)+W(I)*(X(I)**2+Y(I)**2)
      T(2)=T(2)-W(I)*X(I)*Y(I)
      T(4)=T(4)-W(I)*Z(I)*X(I)
      T(5)=T(5)-W(I)*Y(I)*Z(I)
  104 CONTINUE
      AIXX=T(1)
      AIYY=T(3)
      AIZZ=T(6)
      ILIN=0
      IF(AIXX.LE.1.0D-2) ILIN=1
      IF(AIYY.LE.1.0D-2) ILIN=1
      IF(AIZZ.LE.1.0D-2) ILIN=1
      WRITE(6,4)
      CALL PRINT(T,6,3,6)
C
C   THE CALCULATION OF PRINCIPAL MOMENTS OF INERTIA
      IF(ILIN.NE.0) GO TO 201
      CALL RSP(3,3,6,T,PR,1,EG,FV1,FV2)
      WRITE(6,5)
Crawdad.6.10.93
      write(6,8)
      DO 105 I=1,3
      PA=PR(I)*PARA
      PB=CONST/PR(I)
      PC=CYCL/PR(I)
      ROTCM(I)=PB
      WRITE(6,6) I,PR(I),PA,PB,PC
  105 CONTINUE
      WRITE(6,7)
      CALL MATOUT(EG,3,3,3,3,6)
      GO TO 205
C
C   DIATOMIC AND LINEAR POLYATOMIC MOLECULES
  201 WRITE(6,5)
      III=0
      DO 106 I=1,3
      II=I*(I+1)/2
      PA=A00
      PB=A00
      PC=A00
      IF(T(II).LE.1.0D-2) GO TO 202
      PA=T(II)*PARA
      PB=CONST/T(II)
      PC=CYCL/T(II)
      III=III+1
      ROTCM(III)=PB
      GO TO 203
  202 T(II)=A00
  203 WRITE(6,6) I,T(II),PA,PB,PC
  106 CONTINUE
  205 RETURN
      END
