      SUBROUTINE CHECKD(D,DMAX,DD,SKAL,NVAR)
      IMPLICIT REAL*8(A-H,O-Z)
      REAL*8 D(1)
      COMMON/IO/IN,IOUT
C
C  GET CURRENT STEPSIZE
C
      DD=DVTV(D,D,NVAR)
      DD=DSQRT(DD)
C
      IF(DD.GT.DMAX) THEN
      SKAL=DMAX/DD
      WRITE(IOUT,1000) SKAL
      CALL DVSKAL(D,D,SKAL,NVAR)
      DD=DMAX
      ENDIF
C
      WRITE(IOUT,1010) DD
      RETURN
C
1000  FORMAT(' CALCULATED STEP TOO LARGE. STEP SCALED BY ',F9.6)
C
1010  FORMAT(' STEP TAKEN. STEPSIZE IS ',F9.6)
C
      END
