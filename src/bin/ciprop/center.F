      SUBROUTINE CENTER(ICENT)
      IMPLICIT REAL*8 (A-H,O-Z)
      DIMENSION ATM(92)
      COMMON/COORD/CHGS(112),X(3,112),W(112)
      COMMON/FUNCS/NATOM,N3N,NSYM
      COMMON/QVALS/QORB(256),QATM(112),QNET(112)
      COMMON/SIGNS/IPQ(500),IPRNT
      DATA ZERO / 0.0D+00 /
      DATA DLIM / 1.0D-10 /
      DATA ATM / 1.007825D+00 , 4.00260D+00 , 7.01600D+00 ,
     *           9.01218D+00  , 11.00931D+00 , 12.00000D+00 ,
     *           14.00307D+00 , 15.99491D+00 , 18.99840D+00 ,
     *           19.99244D+00 , 22.98977D+00  , 23.98504D+00 ,
     *           26.98153D+00 , 27.97693D+00 , 30.97376D+00 ,
     *           31.97207D+00 , 34.96885D+00 , 39.96238D+00 ,
     *           38.96371D+00 , 39.96259D+00 , 44.95591D+00 ,
     *           47.94795D+00 , 50.94396D+00 , 51.94051D+00 ,
     *           54.93805D+00 , 55.93494D+00 , 58.93320D+00 ,
     *           57.93535D+00 , 62.92960D+00 , 63.92915D+00 ,
     *           68.92558D+00 , 73.92118D+00 , 74.92160D+00 ,
     *           79.91652D+00 , 78.91834D+00 , 83.91151D+00 ,
     + 84.9117996d+0, 87.9056249d+0, 88.9058560d+0, 89.9047080d+0,
     + 92.9063780d+0, 97.9054050d+0, 0.0d+0, 101.9043475d+0,
     + 102.905503d+0, 105.903475d+0, 106.905095d+0, 113.9033607d+0,
     + 114.903875d+0, 119.9021990d+0, 120.9038237d+0, 129.906229d+0,
     + 126.904477d+0, 131.904148d+0, 132.905433d+0, 137.905236d+0,
     + 138.906355d+0, 139.905442d+0, 140.907657d+0, 141.907731d+0,
     + 0.0d+0, 151.919741d+0, 152.921243d+0, 157.924111d+0,
     + 158.925350d+0, 163.929183d+0, 164.930332d+0, 165.930305d+0,
     + 168.934225d+0, 173.938873d+0, 174.940785d+0, 179.946561d+0,
     + 180.948014d+0, 183.950953d+0, 186.955765d+0, 191.961487d+0,
     + 192.962942d+0, 194.964785d+0, 196.966560d+0, 201.970632d+0,
     + 204.974410d+0, 207.976641d+0, 208.980388d+0, 0.0d+0,
     + 0.0d+0, 0.0d+0, 0.0d+0, 0.0d+0, 0.0d+0, 232.038053805d+0,
     + 0.0d+0, 238.050785782d+0/
    1 FORMAT(//,2X,' CARTESIAN COORDINATES'/
     1 5X,' NO.',11X,' X',13X,' Y',13X,' Z',13X,' NUC'/)
    2 FORMAT(2X,I7,5X,4F15.7)
    3 FORMAT(//,2X,' CENTER OF MASS'/
     1 8X,' CMX',11X,' CMY',11X,' CMZ'//2X,3(5X,F10.7)/)
    4 FORMAT(//,2X,' CARTESIAN COORDINATES W.R.T. CENTER OF MASS'/
     1 5X,' NO.',11X,' X',13X,' Y',13X,' Z',13X,' W'/)
    5 FORMAT(//,2X,' CARTESIAN COORDINATES W.R.T. ORIGIN'/
     1 5X,' NO.',11X,' X',13X,' Y',13X,' Z',13X,' NUC'/)
    6 FORMAT(//,2X,' CENTER OF ELECTRONIC CHARGE'/
     1 8X,' CCX',11X,' CCY',11X,' CCZ'//2X,3(5X,F10.7)/)
    7 FORMAT(//,2X,' CARTESIAN COORDINATES W.R.T. CENTER OF ELECTRONIC C
     1HARGE'/5X,' NO.',11X,' X',13X,' Y',13X,' Z',13X,' Q'/)
    8 FORMAT(//,2X,' CENTER OF NUCLEAR CHARGE'/
     1 8X,' CNX',11X,' CNY',11X,' CNZ'//2X,3(5X,F10.7)/)
    9 FORMAT(//,2X,' CARTESIAN COORDINATES W.R.T. CENTER OF NUCLEAR CHAR
     1GE'/5X,' NO.',11X,' X',13X,' Y',13X,' Z',13X,' NUC'/)
   10 FORMAT(//,2X,' CENTER OF NET CHARGE'/
     1 8X,' CTX',11X,' CTY',11X,' CTZ'//2X,3(5X,F10.7)/)
   11 FORMAT(//,2X,' CARTESIAN COORDINATES W.R.T. CENTER OF NET CHARGE'/
     1 5X,' NO.',11X,' X',13X,' Y',13X,' Z',13X,' QNET'/)
C
      WRITE(6,1)
      DO 101 I=1,NATOM
  101 WRITE(6,2) I,X(1,I),X(2,I),X(3,I),CHGS(I)
C
      GO TO (301,302,303,304,305),ICENT
C
C   CALCULATE THE CENTER OF MASS
  301 CONTINUE
      SUMW=ZERO
      SUMWX=ZERO
      SUMWY=ZERO
      SUMWZ=ZERO
      DO 102 I=1,NATOM
      II=CHGS(I)
      W(I)=ATM(II)
      SUMW=SUMW+W(I)
      SUMWX=SUMWX+X(1,I)*W(I)
      SUMWY=SUMWY+X(2,I)*W(I)
      SUMWZ=SUMWZ+X(3,I)*W(I)
  102 CONTINUE
      CMX=SUMWX/SUMW
      CMY=SUMWY/SUMW
      CMZ=SUMWZ/SUMW
      WRITE(6,3) CMX,CMY,CMZ
C
C   NOW DETERMINE THE COORDINATES FOR A CENTER OF MASS FRAME
      WRITE(6,4)
      DO 103 I=1,NATOM
      X(1,I)=X(1,I)-CMX
      X(2,I)=X(2,I)-CMY
      X(3,I)=X(3,I)-CMZ
      WRITE(6,2) I,X(1,I),X(2,I),X(3,I),W(I)
  103 CONTINUE
      GO TO 310
C
C   REFERENCE POINT IS ORIGIN OF SPACED FIXED COORDINATE
  302 CONTINUE
      WRITE(6,5)
      DO 104 I=1,NATOM
      WRITE(6,2) I,X(1,I),X(2,I),X(3,I),CHGS(I)
  104 CONTINUE
      GO TO 310
C
C   CALCULATE THE CENTER OF ELECTRONIC CHARGE
C   BASED ON MULLIKEN POPULATION
  303 CONTINUE
      SUMC=ZERO
      SUMCX=ZERO
      SUMCY=ZERO
      SUMCZ=ZERO
      DO 105 I=1,NATOM
      SUMC=SUMC+QATM(I)
      SUMCX=SUMCX+X(1,I)*QATM(I)
      SUMCY=SUMCY+X(2,I)*QATM(I)
      SUMCZ=SUMCZ+X(3,I)*QATM(I)
  105 CONTINUE
      CCX=ZERO
      CCY=ZERO
      CCZ=ZERO
      IF(DABS(SUMC).LT.DLIM) GO TO 201
      CCX=SUMCX/SUMC
      CCY=SUMCY/SUMC
      CCZ=SUMCZ/SUMC
  201 WRITE(6,6) CCX,CCY,CCZ
C
C   NOW DETERMINE THE COORDINATES FOR A CENTER OF ELECTRONIC CHARGE
C   FRAME
      WRITE(6,7)
      DO 106 I=1,NATOM
      X(1,I)=X(1,I)-CCX
      X(2,I)=X(2,I)-CCY
      X(3,I)=X(3,I)-CCZ
      WRITE(6,2) I,X(1,I),X(2,I),X(3,I),QATM(I)
  106 CONTINUE
      GO TO 310
C
C   CALCULATE THE CENTER OF NUCLEAR CHARGE
  304 CONTINUE
      SUMN=ZERO
      SUMNX=ZERO
      SUMNY=ZERO
      SUMNZ=ZERO
      DO 107 I=1,NATOM
      SUMN=SUMC+CHGS(I)
      SUMNX=SUMNX+X(1,I)*CHGS(I)
      SUMNY=SUMNY+X(2,I)*CHGS(I)
      SUMNZ=SUMNZ+X(3,I)*CHGS(I)
  107 CONTINUE
      CNX=ZERO
      CNY=ZERO
      CNZ=ZERO
      IF(DABS(SUMN).LT.DILM) GO TO 202
      CNX=SUMNX/SUMN
      CNY=SUMNY/SUMN
      CNZ=SUMNZ/SUMN
  202 WRITE(6,8) CNX,CNY,CNZ
C
C   NOW DETERMINE THE COORDINATES FOR A CENTER OF NUCLEAR CHARGE FRAME
      WRITE(6,9)
      DO 108 I=1,NATOM
      X(1,I)=X(1,I)-CNX
      X(2,I)=X(2,I)-CNY
      X(3,I)=X(3,I)-CNZ
      WRITE(6,2) I,X(1,I),X(2,I),X(3,I),CHGS(I)
  108 CONTINUE
      GO TO 310
C
C   CALCULATE THE CENTER OF NET CHARGE
  305 CONTINUE
      SUMT=ZERO
      SUMTX=ZERO
      SUMTY=ZERO
      SUMTZ=ZERO
      DO 109 I=1,NATOM
      SUMT=SUMT+QNET(I)
      SUMTX=SUMTX+X(1,I)*QNET(I)
      SUMTY=SUMTY+X(2,I)*QNET(I)
      SUMTZ=SUMTZ+X(3,I)*QNET(I)
  109 CONTINUE
      CTX=ZERO
      CTY=ZERO
      CTZ=ZERO
      IF(DABS(SUMT).LT.DLIM) GO TO 203
      CTX=SUMTX/SUMT
      CTY=SUMTY/SUMT
      CTZ=SUMTZ/SUMT
  203 WRITE(6,10) CTX,CTY,CTZ
C
C   NOW DETERMINE THE COORDINATES FOR A CENTER OF NUCLEAR CHARGE FRAME
      WRITE(6,11)
      DO 110 I=1,NATOM
      X(1,I)=X(1,I)-CTX
      X(2,I)=X(2,I)-CTY
      X(3,I)=X(3,I)-CTZ
      WRITE(6,2) I,X(1,I),X(2,I),X(3,I),QNET(I)
  110 CONTINUE
C
  310 CONTINUE
      RETURN
      END
