C     /////////////////////////////////////////////////////////////////
      SUBROUTINE AHY4(NC,NSX,L1,L2,L3,L4,H111,H112,H221,H222,H113,H123,
     $      H223,H331,H332,H333,H411,H421,H422,H431,H432,H433,H441,
     $      H442,H443,H444,A,Y)
      IMPLICIT REAL*8 (A-H,O-Z)
      INTEGER P,NSX
      DIMENSION A(NC,NC),Y(NC,NC,NC)
      DIMENSION H111(3,3,3),H112(3,3,3),H221(3,3,3),H222(3,3,3)
      DIMENSION H113(3,3,3),H123(3,3,3),H223(3,3,3),H331(3,3,3)
      DIMENSION H332(3,3,3),H333(3,3,3),H411(3,3,3),H421(3,3,3)
      DIMENSION H422(3,3,3),H431(3,3,3),H432(3,3,3),H433(3,3,3)
      DIMENSION H441(3,3,3),H442(3,3,3),H443(3,3,3),H444(3,3,3)
      DO 10  P=1,NSX
      DO 10  N=1,P
      DO 10  M=1,N
         DO 12  I=1,3
         DO 12  J=1,3
         V1=A(L1+I,M)*A(L1+J,N)
         V2=A(L2+I,M)*A(L2+J,N)
         V3=A(L3+I,M)*A(L3+J,N)
         V4=A(L4+I,M)*A(L4+J,N)
         V5=A(L1+I,M)*A(L1+J,P)
         V6=A(L1+I,N)*A(L1+J,P)
         V7=A(L2+I,M)*A(L2+J,P)
         V8=A(L2+I,N)*A(L2+J,P)
         V9=A(L3+I,M)*A(L3+J,P)
         V10=A(L3+I,N)*A(L3+J,P)
         V11=A(L4+I,M)*A(L4+J,P)
         V12=A(L4+I,N)*A(L4+J,P)
         V13=A(L1+I,M)*A(L2+J,N)
         V14=A(L1+I,M)*A(L2+J,P)
         V15=A(L1+I,N)*A(L2+J,M)
         V16=A(L1+I,N)*A(L2+J,P)
         V17=A(L1+I,P)*A(L2+J,M)
         V18=A(L1+I,P)*A(L2+J,N)
         V19=A(L4+I,M)*A(L2+J,N)
         V20=A(L4+I,M)*A(L2+J,P)
         V21=A(L4+I,N)*A(L2+J,M)
         V22=A(L4+I,N)*A(L2+J,P)
         V23=A(L4+I,P)*A(L2+J,M)
         V24=A(L4+I,P)*A(L2+J,N)
         V25=A(L4+I,M)*A(L3+J,N)
         V26=A(L4+I,M)*A(L3+J,P)
         V27=A(L4+I,N)*A(L3+J,M)
         V28=A(L4+I,N)*A(L3+J,P)
         V29=A(L4+I,P)*A(L3+J,M)
         V30=A(L4+I,P)*A(L3+J,N)
C
         DO 14  K=1,3
         W1=V1*A(L1+K,P)
         W2=V2*A(L2+K,P)
         W3=V3*A(L3+K,P)
         W4=V4*A(L4+K,P)
         Y(M,N,P)=Y(M,N,P)+W1*H111(I,J,K)+W2*H222(I,J,K)
         Y(M,N,P)=Y(M,N,P)+W3*H333(I,J,K)+W4*H444(I,J,K)
         W1=V1*A(L2+K,P)+V5*A(L2+K,N)+V6*A(L2+K,M)
         W2=V1*A(L3+K,P)+V5*A(L3+K,N)+V6*A(L3+K,M)
         W3=V3*A(L2+K,P)+V9*A(L2+K,N)+V10*A(L2+K,M)
         W4=V3*A(L1+K,P)+V9*A(L1+K,N)+V10*A(L1+K,M)
         W5=V2*A(L1+K,P)+V7*A(L1+K,N)+V8*A(L1+K,M)
         W6=V2*A(L3+K,P)+V7*A(L3+K,N)+V8*A(L3+K,M)
         W7=V1*A(L4+K,P)+V5*A(L4+K,N)+V6*A(L4+K,M)
         W8=V2*A(L4+K,P)+V7*A(L4+K,N)+V8*A(L4+K,M)
         W9=V3*A(L4+K,P)+V9*A(L4+K,N)+V10*A(L4+K,M)
         W10=V4*A(L1+K,P)+V11*A(L1+K,N)+V12*A(L1+K,M)
         W11=V4*A(L2+K,P)+V11*A(L2+K,N)+V12*A(L2+K,M)
         W12=V4*A(L3+K,P)+V11*A(L3+K,N)+V12*A(L3+K,M)
         Y(M,N,P)=Y(M,N,P)+W1*H112(I,J,K)+W2*H113(I,J,K)+W3*H332(I,J,K)
         Y(M,N,P)=Y(M,N,P)+W4*H331(I,J,K)+W5*H221(I,J,K)+W6*H223(I,J,K)
         Y(M,N,P)=Y(M,N,P)+W7*H411(K,I,J)+W8*H422(K,I,J)+W9*H433(K,I,J)
      Y(M,N,P)=Y(M,N,P)+W10*H441(I,J,K)+W11*H442(I,J,K)+W12*H443(I,J,K)
         W1=A(L3+K,P)*(V13+V15)+A(L3+K,N)*(V14+V17)+A(L3+K,M)*(V16+V18)
         W2=A(L1+K,P)*(V19+V21)+A(L1+K,N)*(V20+V23)+A(L1+K,M)*(V22+V24)
         W3=A(L1+K,P)*(V25+V27)+A(L1+K,N)*(V26+V29)+A(L1+K,M)*(V28+V30)
         W4=A(L2+K,P)*(V25+V27)+A(L2+K,N)*(V26+V29)+A(L2+K,M)*(V28+V30)
         Y(M,N,P)=Y(M,N,P)+W1*H123(I,J,K)+W2*H421(I,J,K)
 14      Y(M,N,P)=Y(M,N,P)+W3*H431(I,J,K)+W4*H432(I,J,K)
 12   CONTINUE
 10   CONTINUE
      RETURN
      END
