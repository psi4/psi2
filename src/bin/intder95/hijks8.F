C     /////////////////////////////////////////////////////////////////
      SUBROUTINE HIJKS8(NAD,K1,K2,K3,K4,XA,H111,H112,H221,H222,H113,
     $       H123,H223,H331,H332,H333,H411,H421,H422,H431,H432,H433,
     $       H441,H442,H443,H444)
      IMPLICIT REAL*8 (A-H,O-Z)
      DIMENSION XA(NAD,3),Q1(3),Q2(3),Q3(3),Q4(3),QB(3),QC(3)
      DIMENSION Q11(3,3),Q21(3,3),Q31(3,3),Q41(3,3)
      DIMENSION Q22(3,3),Q32(3,3)
      DIMENSION Q42(3,3),Q33(3,3),Q43(3,3),Q44(3,3)
      DIMENSION H111(3,3,3),H112(3,3,3),H221(3,3,3),H222(3,3,3)
      DIMENSION H113(3,3,3),H123(3,3,3),H223(3,3,3),H331(3,3,3)
      DIMENSION H332(3,3,3),H333(3,3,3),H411(3,3,3),H421(3,3,3)
      DIMENSION H422(3,3,3),H431(3,3,3),H432(3,3,3),H433(3,3,3)
      DIMENSION H441(3,3,3),H442(3,3,3),H443(3,3,3),H444(3,3,3)
      DIMENSION Q221(3,3,3),Q222(3,3,3),Q111(3,3,3),Q112(3,3,3)
      DIMENSION Q113(3,3,3),Q123(3,3,3),Q223(3,3,3),Q331(3,3,3)
      DIMENSION Q332(3,3,3),Q444(3,3,3)
      DIMENSION Q1111(3,3,3,3),Q1112(3,3,3,3),Q1113(3,3,3,3)
      DIMENSION Q1122(3,3,3,3),Q1123(3,3,3,3),Q1133(3,3,3,3)
      DIMENSION Q1222(3,3,3,3),Q1223(3,3,3,3),Q1233(3,3,3,3)
      DIMENSION Q1333(3,3,3,3),Q2222(3,3,3,3),Q2223(3,3,3,3)
      DIMENSION Q2233(3,3,3,3),Q2333(3,3,3,3),Q4444(3,3,3,3)
      PARAMETER(ZERO=0.0D0,SIX=6.0D0,TWO=2.0D0)
      CALL VECT1(NAD,K2,K3,QB,XA,R23)
      CALL VECT1(NAD,K4,K3,QC,XA,R34)
      CALL VECT2(NAD,K1,K2,K3,Q1,Q2,Q3,XA,PHI)
      CALL HIJS2(NAD,K1,K2,K3,XA,Q11,Q21,Q31,Q22,Q32,Q33)
      CALL HIJKS1(NAD,K4,K3,XA,Q444)
      CALL H4TH1(NAD,K4,K3,XA,Q4444)
      DO 1 I=1,3
      DO 1 J=1,3
      DO 1 K=1,3
      H444(I,J,K)=0.0D0
      H441(I,J,K)=0.0D0
      H442(I,J,K)=0.0D0
      DO 1 L=1,3
      H444(I,J,K)=H444(I,J,K)-R23*Q4444(L,I,J,K)*Q3(L)
      H441(I,J,K)=H441(I,J,K)-R23*Q444(L,I,J)*Q31(L,K)
  1   H442(I,J,K)=H442(I,J,K)-R23*Q444(L,I,J)*Q32(L,K)
      CALL HIJS1(NAD,K4,K3,XA,Q44)
      CALL HIJKS2(NAD,K1,K2,K3,XA,Q111,Q112,Q113,Q123,Q221,
     $    Q222,Q223,Q331,Q332,Q444)
      CALL H4TH2(NAD,K1,K2,K3,XA,Q1111,Q1112,Q1113,Q1122,
     $    Q1123,Q1133,Q1222,Q1223,Q1233,Q1333,Q2222,Q2223,Q2233,
     $    Q2333,Q4444)
      DO 2 I=1,3
      DO 2 J=1,3
      DO 2 K=1,3
      H111(I,J,K)=0.0D0
      H112(I,J,K)=0.0D0
      H221(I,J,K)=0.0D0
      H222(I,J,K)=0.0D0
      H421(I,J,K)=0.0D0
      H422(I,J,K)=0.0D0
      H411(I,J,K)=0.0D0
      DO 2 L=1,3
      H111(I,J,K)=H111(I,J,K)-R23*Q1113(I,J,K,L)*QC(L)
      H112(I,J,K)=H112(I,J,K)-R23*Q1123(I,J,K,L)*QC(L)
      H221(I,J,K)=H221(I,J,K)-R23*Q1223(K,J,I,L)*QC(L)
      H222(I,J,K)=H222(I,J,K)-R23*Q2223(I,J,K,L)*QC(L)
      H421(I,J,K)=H421(I,J,K)-R23*Q123(K,J,L)*Q44(L,I)
      H422(I,J,K)=H422(I,J,K)-R23*Q223(J,K,L)*Q44(L,I)
  2   H411(I,J,K)=H411(I,J,K)-R23*Q113(J,K,L)*Q44(L,I)
      CALL HIJS8(NAD,K1,K2,K3,K4,XA,Q11,Q21,Q31,Q41,
     $               Q22,Q32,Q42,Q33,Q43,Q44)
      DO 5 I=1,3
      DO 5 J=1,3
      DO 5 K=1,3
      H442(I,J,K)=H442(I,J,K)+Q44(I,J)*QB(K)/R23
      H421(I,J,K)=H421(I,J,K)+Q41(I,K)*QB(J)/R23
      H112(I,J,K)=H112(I,J,K)+Q11(I,J)*QB(K)/R23
      H222(I,J,K)=H222(I,J,K)+Q22(J,K)*QB(I)/R23
      H222(I,J,K)=H222(I,J,K)+(Q22(I,K)*QB(J)+Q22(I,J)*QB(K))/R23
      H221(I,J,K)=H221(I,J,K)+(Q21(I,K)*QB(J)+Q21(J,K)*QB(I))/R23
  5   H422(I,J,K)=H422(I,J,K)+(Q42(I,K)*QB(J)+Q42(I,J)*QB(K))/R23
      CALL VECT8(NAD,K1,K2,K3,K4,Q1,Q2,Q3,Q4,XA,W)
      CALL HIJS1(NAD,K2,K3,XA,Q22)
      CALL HIJKS1(NAD,K2,K3,XA,Q222)
      DO 6 I=1,3
      DO 6 J=1,3
      DO 6 K=1,3
      H422(I,J,K)=H422(I,J,K)+Q22(J,K)*Q4(I)/R23
      H422(I,J,K)=H422(I,J,K)-2.0D0*QB(J)*QB(K)*Q4(I)/R23/R23
      H221(I,J,K)=H221(I,J,K)+Q22(I,J)*Q1(K)/R23
      H221(I,J,K)=H221(I,J,K)-2.0D0*QB(I)*QB(J)*Q1(K)/R23/R23
      H222(I,J,K)=H222(I,J,K)+(Q22(I,J)*Q2(K)+Q22(J,K)*Q2(I))/R23
      H222(I,J,K)=H222(I,J,K)+Q22(I,K)*Q2(J)/R23
      H222(I,J,K)=H222(I,J,K)+SIX*W*QB(I)*QB(J)*QB(K)/R23/R23/R23 -
     $       (QB(I)*QB(J)*Q2(K)+QB(J)*QB(K)*Q2(I)+QB(I)*QB(K)*Q2(J))*
     $       2.0D0/R23/R23 + W*Q222(I,J,K)/R23 -
     $ TWO*W*(Q22(I,J)*QB(K)+Q22(I,K)*QB(J)+Q22(J,K)*QB(I))/R23/R23
  6   CONTINUE
      DO 7 I=1,3
      DO 7 J=1,3
      DO 7 K=1,3
      H223(I,J,K)=-H222(I,J,K)-H221(I,J,K)-H422(K,I,J)
      H113(I,J,K)=-H112(I,J,K)-H111(I,J,K)-H411(K,I,J)
      H123(I,J,K)=-H112(I,K,J)-H221(K,J,I)-H421(K,J,I)
      H443(I,J,K)=-H442(I,J,K)-H441(I,J,K)-H444(I,J,K)
      H431(I,J,K)=-H421(I,J,K)-H411(I,J,K)-H441(I,J,K)
  7   H432(I,J,K)=-H422(I,J,K)-H421(I,K,J)-H442(I,J,K)
      DO 8 K=1,3
      DO 8 I=1,3
      DO 8 J=1,3
      H331(I,J,K)=-H431(I,J,K)-H123(K,I,J)-H113(I,K,J)
      H332(I,J,K)=-H432(I,J,K)-H223(I,K,J)-H123(I,K,J)
  8   H433(I,J,K)=-H431(I,J,K)-H432(I,J,K)-H443(K,I,J)
      DO 9 K=1,3
      DO 9 I=1,3
      DO 9 J=1,3
  9   H333(I,J,K)=-H433(I,J,K)-H331(J,K,I)-H332(J,K,I)
      RETURN
      END
