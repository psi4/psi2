C     ////////////////////////////////////////////////////////////
      SUBROUTINE VCDER1(NA,NC,NSX,NINV,XMASS,XKI,A,F1,F2,F3,F4,V,NRUN)
      IMPLICIT REAL*8 (A-H,O-Z)
      INTEGER QQ
      DIMENSION DIP(3),XKI(NC,3),A(NC,NC),V(NC)
      DIMENSION F1(NC),F2(NC,NC),F3(NC,NC,NC),F4(NC,NC,NC,NC)
      DIMENSION AA(3,3),VK(3),XMASS(NA)
      PARAMETER(ZERO=0.0D0)
      COMMON /IO/ IIN1,IOUT,IIN2,ICHECK,NPRT,
     $   I11,I15,I17,I20,I24,
     $   I12,I16,I18,I21,I25,
     $   I31,I32,I33,I35,I36,I37,
     $   ISCR1,ISCR2,ISCR3,ISCR4,ISCR5,ISCR6,ISCR7,ISCR8,ISCR9,ISCR10,
     $   ISCR11,ISCR12,ISCR13,ISCR14
      COMMON /DIPOLE/DIP,QQ
      COMMON /PHYCON/ BOHR,DEBYE,HART,WAVE0,CINT
      XMT=ZERO
      DO 10  I=1,NA
 10   XMT=XMT+XMASS(I)
      DO 15  I=1,NC
 15   V(I)=ZERO
      IF(NINV.NE.0) THEN
      DO 100  I=1,NC
      K=(I-1)/3+1
 100  V(I)=DEBYE*QQ*XMASS(K)/XMT
      ELSE
      DO 105  I=1,NSX
         XX=ZERO
         DO 110  J=1,NC
         K=(J-1)/3+1
 110     XX=XX+XMASS(K)*A(J,I)
 105  V(I)=-DEBYE*QQ*XX/XMT
      END IF
      IF(NINV.NE.0) THEN
      DO 120  I=1,NC
         DO 125  KK=1,3
 125     VK(KK)=XKI(I,KK)
         CALL MAT2(AA,VK)
         DO 130 KK=1,3
 130     V(I)=V(I)+AA(NRUN,KK)*DIP(KK)
 120  CONTINUE
      ELSE
      DO 140  I=1,NSX
         DO 145  KK=1,3
         VK(KK)=ZERO
         DO 145  J=1,NC
 145     VK(KK)=VK(KK)+A(J,I)*XKI(J,KK)
         CALL MAT2(AA,VK)
         DO 150 KK=1,3
 150     V(I)=V(I)-AA(NRUN,KK)*DIP(KK)
 140  CONTINUE
      END IF
      DO 200 I=1,NC
 200  F1(I)=F1(I)+V(I)
      END
