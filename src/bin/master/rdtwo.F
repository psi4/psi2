      SUBROUTINE RDTWO(LBLI,PKI,LBLO,BUFO,INBUFS)
      IMPLICIT REAL*8 (A-H,O-Z)
      integer inbufs,maxbf4,maxbf2
      DIMENSION LBLI(INBUFS*2),PKI(INBUFS),LBLO(MAXBF4),BUFO(MAXBF2)
      COMMON/LIMIT/MAXBAS,MAXBUF,MAXBF2,MAXBF4
      COMMON/SIGNS/IOFF(256),IPRNT
      COMMON/SYMMS/IDEG(10),NDEG(10),LSYM(10)
      COMMON/TAPES/ITAP34,ITAP36
      DATA ZERO / 0.0D+00 /
    1 FORMAT(2X,' ILSTI = ',I5/
     1       2X,' NBUF  = ',I5/)
    2 FORMAT(2X,9I5,3F15.7)
C
      CALL RFILE(ITAP36)
C
      IBUFSZ=8942
      IBUFQT=2236
      IBL=0
      INTI=0
      INTO=0
      NBLI=0
      NBLO=0
      NINT=0
  201 NBLI=NBLI+1
      CALL SREAD(ITAP34,LBLI,IBUFSZ)
      ILSTI=LBLI(1)
      NBUF=LBLI(2)
      IF(IPRNT.GE.5)
     *WRITE(6,1) ILSTI,NBUF
C***  WRITE(8,15) NBUF
C**15 FORMAT(I5)
      DO 101 I=1,NBUF
      LOR=ISHFT(LBLI(I+I+2),-2)
      LSM=ISHFT(LOR,-8)
      KOR=ISHFT(LSM,-3)
      KSM=ISHFT(KOR,-8)+1
      KOR=IAND(KOR,255)
      LSM=IAND(LSM,7)+1
      LOR=IAND(LOR,255)
      III=IAND(LBLI(I+I+2),3)
      JSM=ISHFT(LBLI(I+I+1),-8)
      IOR=ISHFT(JSM,-3)
      ISM=ISHFT(IOR,-8)+1
      IOR=IAND(IOR,255)
      JSM=IAND(JSM,7)+1
      JOR=IAND(LBLI(I+I+1),255)
      II=IOR+IDEG(ISM)
      JJ=JOR+IDEG(JSM)
      KK=KOR+IDEG(KSM)
      LL=LOR+IDEG(LSM)
      PKII=PKI(I+IBUFQT)
C     IF(IPRNT.LE.4) GO TO 202
C     IJ=IOFF(IOR)+JOR+LSYM(ISM)
C     IF(IOR.LT.JOR) IJ=IOFF(JOR)+IOR+LSYM(JSM)
C     KL=IOFF(KOR)+LOR+LSYM(KSM)
C     IF(KOR.LT.LOR) KL=IOFF(LOR)+KOR+LSYM(LSM)
C     WRITE(6,2) III,IOR,ISM,JOR,JSM,KOR,KSM,LOR,LSM,PKII
C     WRITE(6,20) II,JJ,KK,LL,PKII
C***  WRITE(8,20) II,JJ,KK,LL,PKII
C  20 FORMAT(4I5,F20.10)
  202 CALL PACK(II,JJ,KK,LL,IX,JA,JAA)
      IBL=IBL+1
      LBLO(IBL+IBL-1)=JA
      LBLO(IBL+IBL)=JAA
      BUFO(IBL+MAXBUF)=PKII
      IF(IBL.LT.MAXBUF) GO TO 101
      IBL=0
      NBLO=NBLO+1
      CALL SWRIT(ITAP36,LBLO,MAXBF4)
  101 CONTINUE
      INTI=INTI+NBUF
      IF(ILSTI.EQ.0) GO TO 201
C
      IBL=IBL+1
      NBLO=NBLO+1
      INTO=INTO+IBL
      LBLO(IBL+IBL-1)=0
      LBLO(IBL+IBL)=0
      BUFO(IBL+MAXBUF)=ZERO
      CALL SWRIT(ITAP36,LBLO,MAXBF4)
      CALL SREW(ITAP36)
C
      RETURN
      END
