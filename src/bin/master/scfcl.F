      SUBROUTINE SCFCL(EIG,OCC,EAO,WM,WA,DC)
      IMPLICIT REAL*8 (A-H,O-Z)
      integer nbasis,nbfao,nbatri
      DIMENSION EIG(NBASIS),OCC(NBASIS),EAO(NBFAO,NBASIS)
      DIMENSION WM(NBATRI),WA(NBATRI),DC(NBATRI)
      DIMENSION IFCB49(16)
      CHARACTER*8 SCFTYP,CITYP,DERTYP
      COMMON/BASIS/NBASIS,NTRI,NSYM,NBFAO,NBFSO,NBATRI
      COMMON/ENRGY/ESCF,ENUC
      COMMON/SIGNS/IOFF(256),IPRNT
      COMMON/TAPES/ITAP34,ITAP36
      COMMON/TEMPS/I30(400)
      COMMON/TYPES/SCFTYP,CITYP,DERTYP
      COMMON/CI101/IOPEN,IOCC,JOCC,KOCC
      DATA ZERO,TWO / 0.0D+00 , 2.0D+00 /
    1 FORMAT(//,2X,' CLOSED SHELL MO (AO BASIS)'/)
    2 FORMAT(//,2X,' LAGRANGIAN MATRIX (MO BASIS)'/)
    3 FORMAT(//,2X,' LAGRANGIAN MATRIX (AO BASIS)'/)
    4 FORMAT(//,2X,' DENSITY MATRIX (AO BASIS)'/)
C
      IF(IPRNT.LE.2) GO TO 301
      WRITE(6,1)
      CALL EIGOUT(EAO,EIG,OCC,NBFAO,NBASIS,NBFAO,NBASIS,6)
C
C   FORM THE LAGRANGIAN MATRIX IN MO BASIS
  301 DO 101 I=1,NTRI
  101 WM(I)=ZERO
      DO 102 I=1,IOCC
      II=IOFF(I+1)
      WM(II)=EIG(I)*TWO
  102 CONTINUE
      CALL MWRIT(WM,25)
      IF(IPRNT.LE.2) GO TO 302
      WRITE(6,2)
      CALL PRINT(WM,NBATRI,NBASIS,6)
C
C   TRANSFORM THE LAGRANGIAN MATRIX FROM MO TO AO BASIS
  302 CONTINUE
      DO 104 II=1,NBFAO
      DO 104 JJ=1,II
      IIJJ=IOFF(II)+JJ
      VALU=ZERO
      DO 103 I=1,NBASIS
      ID=IOFF(I+1)
      VALU=VALU+WM(ID)*EAO(II,I)*EAO(JJ,I)
  103 CONTINUE
      WA(IIJJ)=VALU
  104 CONTINUE
      CALL MWRIT(WA,24)
      IF(IPRNT.LE.2) GO TO 303
      WRITE(6,3)
      CALL PRINT(WA,NBATRI,NBFAO,6)
C
C   FORM THE DENSITY MATRIX IN AO BASIS
  303 IJ=0
      DO 106 I=1,NBFAO
      DO 106 J=1,I
      IJ=IJ+1
      VALC=ZERO
      DO 105 K=1,IOCC
  105 VALC=VALC+EAO(I,K)*EAO(J,K)
      DC(IJ)=VALC
  106 CONTINUE
      IF(IPRNT.LE.2) GO TO 305
      WRITE(6,4)
      CALL PRINT(DC,NBATRI,NBFAO,6)
C
  305 CONTINUE
      RETURN
      END
