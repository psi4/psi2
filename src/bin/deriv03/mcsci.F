      SUBROUTINE MCSCI(D1N,D1O,D1F,D1W,D1T,D1TOT,
     1                 D2N,D2O,D2F,D2W,D2T,D2TOT,DENT,WAO,
     2                 IA,CC,MAXLFT)
      IMPLICIT REAL*8 (A-H,O-Z)
      CHARACTER*52 TITLE
      COMMON/BASIS/NBASIS,NBFAO,NBATRI,NBATR2,NTRI,NTRI2
      COMMON/CALCS/ISTYPE,ICTYPE,IRAMAN,IAFOCK,IDFOCK,IDINT
      COMMON/FUNCS/NTYPES,NTYPEP,NTREAD,NATOM,N3N,NATRI,NSYM
      COMMON/NDERS/NDERIV
      COMMON/SIGNS/IOFF(256),IPRNT
      COMMON/TOLER/DLIM
      DIMENSION D1N(3,NATOM),D1O(3,NATOM),D1F(3,NATOM),D1W(3,NATOM)
      DIMENSION D1T(3,NATOM),D1TOT(3,NATOM)
      DIMENSION D2N(N3N,N3N),D2O(N3N,N3N),D2F(N3N,N3N),D2W(N3N,N3N)
      DIMENSION D2T(N3N,N3N),D2TOT(N3N,N3N)
      DIMENSION DENT(NBATRI),WAO(NBATRI)
      DIMENSION IA(1),CC(MAXLFT)
    1 FORMAT(//,2X,' ONE PARTICLE DENSITY MATRIX'/)
    2 FORMAT(//,2X,' LAGRANGIAN MATRIX'/)
C
C   OPEN THE MASTER FILE
      CALL INITMF(1)
C
C   READ IN THE ONE PARTICLE DENSITY MATRIX
      CALL MREAD(DENT,34)
      IF(IPRNT.LE.2) GO TO 201
      WRITE(6,1)
      CALL PRINT(DENT,NBATRI,NBFAO,6)
C
C   READ IN THE LAGRANGIAN MATRIX
  201 CONTINUE
      CALL MREAD(WAO,32)
      IF(IPRNT.LE.2) GO TO 202
      WRITE(6,2)
      CALL PRINT(WAO,NBATRI,NBFAO,6)
C
C   CALCULATE DERIVATIVES OF ONE-ELECTRON AND OVERLAP TERMS
  202 CONTINUE
      IC1=1
      IC2=IC1+NBATRI*N3N
      IC3=IC2+NBATRI*3
      IC4=IC3+NBATRI*NATRI
      ICMAX=IC4+NBATRI*6
C.................                                 DFH     DFS.....
      CALL MAKONE(DENT,WAO,D1O,D1F,D1W,D2O,D2F,D2W,CC(IC1),CC(IC2),
C.................DSH     DSS.....
     1            CC(IC3),CC(IC4))
C
C     TITLE='HELLMAN-FEYNMAN CONTRIBUTION TO FIRST DERIVATIVES '
C     CALL PRNONE(TITLE,D1F)
      CALL VADD(D1O,D1O,D1F,N3N)
      TITLE='ONE-ELECTRON CONTRIBUTION TO FIRST DERIVATIVES    '
      CALL PRNONE(TITLE,D1O)
      TITLE='OVERLAP CONTRIBUTION TO FIRST DERIVATIVES         '
      CALL PRNONE(TITLE,D1W)
C
C     CALL JK2DER
C
C     CALL SYMD
C
C     CALL SYMF
C
      RETURN
      END
