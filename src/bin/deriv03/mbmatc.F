      SUBROUTINE mbmatc(b,dc,mc,nnc,isetc)
      IMPLICIT REAL*8 (A-H,O-Z)
      DIMENSION D(6),D2(6),DC(6),M(6),M2(6),MC(6)
      COMMON/BASIS/NBASIS,NBFAO,NBATRI,NBATR2
      COMMON/CENTR/NCENTR
CTPH  COMMON/DERIN/DERINT(1296,3,3)
C11-14-88  (For  7Mb) COMMON/DERIN/DERINT(10000,9)
C11-14-88  (For 15Mb) COMMON/DERIN/DERINT(50625,9)
      COMMON/DERIN/DERINT(10000,3,3)
      COMMON/FUNCS/NTYPES,NTYPEP,NTREAD,NATOM,N3N,NATRI,NSYM
      COMMON/PARA3/NATMS(4),NPASS
      COMMON/TOLER/DLIM
      DIMENSION B(NBATRI,3,NATOM,NTREAD)
      DATA ZERO / 0.0D+00 /
C
cges  ENTRY MBMATC(B,DC,MC,NNC,ISETC)
C
      IBSET=ISETC*2-1
      JBSET=ISETC*2
      DO 116 IXYZ=1,3
      TEMP=ZERO
      DO 113 I=1,NCENTR-1
      T=DERINT(NNC,IXYZ,I)
      TEMP=TEMP+T
      IATOM=NATMS(I)
      DO 111 J=1,2
      B(MC(J),IXYZ,IATOM,IBSET)=B(MC(J),IXYZ,IATOM,IBSET)+T*DC(J)
  111 CONTINUE
      DO 112 J=3,6
      B(MC(J),IXYZ,IATOM,JBSET)=B(MC(J),IXYZ,IATOM,JBSET)+T*DC(J)
  112 CONTINUE
  113 CONTINUE
C
C   USE TRANSLATIONAL INVARIANCE FOR LAST ATOM
      IATOM=NATMS(NCENTR)
      DO 114 J=1,2
      B(MC(J),IXYZ,IATOM,IBSET)=B(MC(J),IXYZ,IATOM,IBSET)-TEMP*DC(J)
  114 CONTINUE
      DO 115 J=3,6
      B(MC(J),IXYZ,IATOM,JBSET)=B(MC(J),IXYZ,IATOM,JBSET)-TEMP*DC(J)
  115 CONTINUE
C
  116 CONTINUE
C
      RETURN
      END
