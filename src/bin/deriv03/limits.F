      SUBROUTINE LIMITS
      IMPLICIT REAL*8 (A-H,O-Z)
cets030691
#include <error.h>
      integer ip, prcntr
      COMMON/FUNCS/NTYPES,NTYPEP,NTREAD,NATOM,N3N,NATRI,NSYM
      COMMON/GAUSB/KATOM(200),KTYPE(200),KSTART(200),KLOC(200),
     1             KMIN(200),KMAX(200),KNG(200)
CTPH  COMMON/GAUSE/MXSPDF(50),MINSH(3,50),MAXSH(3,50)
      COMMON/GAUSE/MXSPDF(50),MINSH(5,50),MAXSH(5,50)
      COMMON/PARA1/NSHELL,NT,MXT,NISO
      COMMON/SIGNS/IOFF(256),IPRNT
      COMMON/TOLER/DLIM
    1 FORMAT (/,' ATOM # ',I2,' MAXSPDF',I2,/,('   SPDF ',I1,5X,I3
     1  ,          '-',I3))
C
CTPH  MXANGM=3
      MXANGM=5
      DO 102 I=1,NATOM
      MXSPDF(I)=0
      DO 101 J=1,MXANGM
      MINSH(J,I)=0
      MAXSH(J,I)=0
  101 CONTINUE
  102 CONTINUE
C
      DO 103 I=1,NSHELL
      IATOM=KATOM(I)
      IF(KTYPE(I).GT.MXSPDF(IATOM)) MXSPDF(IATOM)=KTYPE(I)
  103 CONTINUE
C
      DO 106 IATOM=1,NATOM
      DO 105 ISPDF=1,MXSPDF(IATOM)
      DO 104 ISHELL=1,NSHELL
        IF(KATOM(ISHELL).EQ.IATOM.AND.KTYPE(ISHELL).EQ.ISPDF) THEN
          IF(MINSH(ISPDF,IATOM).EQ.0) MINSH(ISPDF,IATOM)=ISHELL
          MAXSH(ISPDF,IATOM)=ISHELL
        END IF
  104 CONTINUE
  105 CONTINUE
  106 CONTINUE
C
      DO 109 IATOM=1,NATOM
      DO 108 ISPDF=1,MXSPDF(IATOM)
      DO 107 ISHELL=MINSH(ISPDF,IATOM),MAXSH(ISPDF,IATOM)
ctph    IF(KTYPE(ISHELL).NE.ISPDF.OR.KATOM(ISHELL).NE.IATOM)
ctph 1      STOP ' # DERIV # ERROR: BASIS FUNCTION ORDER'
  107 CONTINUE
  108 CONTINUE
  109 CONTINUE
C
cets030691      IF(IPRNT.LE.3) GO TO 201
      ip = prcntr('IS_ON DEBUG')
      if(ip.eq.1) then
        DO 110 IATOM=1,NATOM
          MX=MXSPDF(IATOM)
          WRITE(6,1) IATOM,MXSPDF(IATOM),(I,MINSH(I,IATOM),
     1       MAXSH(I,IATOM),I=1,MX)
  110   CONTINUE
      endif
C
  201 CONTINUE
      RETURN
      END
