      SUBROUTINE GETBAS
      IMPLICIT REAL*8 (A-H,O-Z)
      DIMENSION I30(200),A30(100),CSPD(600),LISO(1600),LICT(400)
      COMMON/BASIS/NBASIS,NBFAO,NBATRI,NBATR2
      COMMON/COORD/ZAN(50),X(3,50)
      COMMON/FUNCS/NTYPES,NTYPEP,NTREAD,NATOM,N3N,NATRI,NSYM
      COMMON/GAUSA/EX(200),CS(200)
      COMMON/GAUSB/KATOM(200),KTYPE(200),KSTART(200),KLOC(200),
     1             KMIN(200),KMAX(200),KNG(200)
      COMMON/GAUSC/T(36),PTR(3,3,8),DTR(6,6,8)
      COMMON/GAUSD/INVT(8),ISO(200,8),LBLAT(2,50),ICT(50,8)
      COMMON/PARA1/NSHELL,NT,MXT,NISO
      COMMON/PARA2/NPRIM
      COMMON/SIGNS/IOFF(256),IPRNT
      COMMON/TAPES/ITAP30,ITAP44
      EQUIVALENCE (I30,A30)
C
    1 FORMAT(/,3X,20A4/)
    2 FORMAT(2X,' NUCLEAR REPULSION ENERGY:',F20.10)
    3 FORMAT(2X,'               SCF ENERGY:',F20.10)
    4 FORMAT(/,2X,' NPRIM  = ',I5/)
    5 FORMAT(2X,I5,2F20.10)
    6 FORMAT(/,2X,' NSHELL = ',I5/)
    7 FORMAT(2X,8I5)
    8 FORMAT(/,2X,' NATOM = ',I5/)
    9 FORMAT(2X,I5,4F20.10)
C
C   GET CONSTANTS FROM TAPE30
      CALL RFILE(ITAP30)
      CALL WREADW(ITAP30,I30,200,101,JUNK)
C
      IEND    = I30(1)
      MPOINT  = I30(2)
      MCONST  = I30(3)
      MCALCS  = I30(4)
      NCALCS  = I30(5)
      NBASIS  = I30(18)
      NATOM   = I30(19)
      NBFAO   = I30(22)
      NSHELL  = I30(27)
      NT      = I30(29)
      NPRIM   = I30(32)
      MXT     = I30(36)
      NISO    = I30(40)
      NSYM    = I30(41)
      NBATRI=IOFF(NBASIS+1)
      NBATR2=NBATRI*2
      N3N=NATOM*3
C
C   READ POINTERS FROM TAPE30
      IPOS=101+MCONST
      CALL WREADW(ITAP30,I30,MPOINT,IPOS,JUNK)
C
C   READ BASIS SET INFO ETC.
      CALL WREADW(ITAP30,ZAN,NATOM*2,I30(1),JUNK)
      CALL WREADW(ITAP30,LICT,NATOM*NT,I30(2),JUNK)
      CALL WREADW(ITAP30,EX,NPRIM*2,I30(5),JUNK)
      CALL WREADW(ITAP30,CSPD,NPRIM*6,I30(6),JUNK)
      CALL WREADW(ITAP30,KSTART,NSHELL,I30(7),JUNK)
      CALL WREADW(ITAP30,KATOM,NSHELL,I30(8),JUNK)
      CALL WREADW(ITAP30,KTYPE,NSHELL,I30(9),JUNK)
      CALL WREADW(ITAP30,KNG,NSHELL,I30(10),JUNK)
      CALL WREADW(ITAP30,KLOC,NSHELL,I30(11),JUNK)
      CALL WREADW(ITAP30,KMIN,NSHELL,I30(12),JUNK)
      CALL WREADW(ITAP30,KMAX,NSHELL,I30(13),JUNK)
      CALL WREADW(ITAP30,T,MXT*2,I30(25),JUNK)
      CALL WREADW(ITAP30,INVT,NT,I30(26),JUNK)
      CALL WREADW(ITAP30,LISO,NSHELL*NISO,I30(27),JUNK)
      CALL WREADW(ITAP30,LBLAT,2*NATOM,I30(28),JUNK)
      CALL WREADW(ITAP30,PTR,3*3*NT*2,I30(31),JUNK)
      CALL WREADW(ITAP30,DTR,6*6*NT*2,I30(32),JUNK)
C
C   AND GET LOCATION OF INDIVIDUAL CALCULATION TO GET GEOM
      IPOS=101+MCONST+MPOINT+NCALCS-1
      CALL WREADW(ITAP30,LOCCAL,1,IPOS,JUNK)
      CALL WREADW(ITAP30,I30,60,LOCCAL,JUNK)
      WRITE(6,1) (I30(I),I=1,20)
C
      IPOS=LOCCAL+80
      CALL WREADW(ITAP30,X,NATOM*6,IPOS,JUNK)
C
C   GET ENERGIES AND WRITE OUT
      IPOS=LOCCAL+80+NATOM*6
      CALL WREADW(ITAP30,I30,20,IPOS,JUNK)
      ENUC=A30(1)
      ESCF=A30(2)
      WRITE(6,2) ENUC
      WRITE(6,3) ESCF
C
C   COLLAPSE CONTRACTION COEFFICIENTS INTO ONE-D ARRAY
      IJ=0
      DO 102 I=1,3
      DO 101 J=1,NPRIM
      IJ=IJ+1
      VALU=CSPD(IJ)
      IF(VALU.EQ.ZERO) GO TO 101
      CS(J)=VALU
  101 CONTINUE
  102 CONTINUE
C
      DO 104 I=1,NISO
      II=(I-1)*NSHELL
      DO 103 ISHELL=1,NSHELL
      II=II+1
      ISO(ISHELL,I)=LISO(II)
  103 CONTINUE
  104 CONTINUE
C
      DO 106 I=1,NT
      II=(I-1)*NATOM
      DO 105 IATOM=1,NATOM
      II=II+1
      ICT(IATOM,I)=LICT(II)
  105 CONTINUE
  106 CONTINUE
C
      IF(IPRNT.LE.3) GO TO 205
      WRITE(6,4) NPRIM
      DO 107 I=1,NPRIM
      WRITE(6,5) I,EX(I),CS(I)
  107 CONTINUE
      WRITE(6,6) NSHELL
      DO 108 I=1,NSHELL
      WRITE(6,7) I,KATOM(I),KTYPE(I),KSTART(I),KLOC(I),
     1           KMIN(I),KMAX(I),KNG(I)
  108 CONTINUE
      WRITE(6,8) NATOM
      DO 109 I=1,NATOM
  109 WRITE(6,9) I,ZAN(I),X(1,I),X(2,I),X(3,I)
C
  205 CONTINUE
      CALL SREW(ITAP30)
      RETURN
      END
