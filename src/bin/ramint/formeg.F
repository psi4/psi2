      SUBROUTINE FORMEG(D1T)
      IMPLICIT REAL*8 (A-H,O-Z)
      DIMENSION D1T(3,NATOM,NMAXD)
      COMMON/D1INT/XIDER(10),YIDER(10),ZIDER(10),
     1             XJDER(10),YJDER(10),ZJDER(10),
     2             XKDER(10),YKDER(10),ZKDER(10)
      COMMON/FUNCS/NTYPES,NTYPEP,NTREAD,NATOM,N3N,NATRI,NSYM
      COMMON/MAXDS/NMAXD
      COMMON/PARA3/NATMS(4),NPASS
C
      IF (NPASS.EQ.1) THEN
        DO 101 I=1,NMAXD
        D1T(1,NATMS(1),I)=D1T(1,NATMS(1),I)+XIDER(I)
        D1T(2,NATMS(1),I)=D1T(2,NATMS(1),I)+YIDER(I)
        D1T(3,NATMS(1),I)=D1T(3,NATMS(1),I)+ZIDER(I)
        D1T(1,NATMS(2),I)=D1T(1,NATMS(2),I)+XJDER(I)
        D1T(2,NATMS(2),I)=D1T(2,NATMS(2),I)+YJDER(I)
        D1T(3,NATMS(2),I)=D1T(3,NATMS(2),I)+ZJDER(I)
        D1T(1,NATMS(3),I)=D1T(1,NATMS(3),I)+XKDER(I)
        D1T(2,NATMS(3),I)=D1T(2,NATMS(3),I)+YKDER(I)
        D1T(3,NATMS(3),I)=D1T(3,NATMS(3),I)+ZKDER(I)
        D1T(1,NATMS(4),I)=D1T(1,NATMS(4),I)-XIDER(I)-XJDER(I)-XKDER(I)
        D1T(2,NATMS(4),I)=D1T(2,NATMS(4),I)-YIDER(I)-YJDER(I)-YKDER(I)
        D1T(3,NATMS(4),I)=D1T(3,NATMS(4),I)-ZIDER(I)-ZJDER(I)-ZKDER(I)
  101   CONTINUE
      ELSE IF (NPASS.EQ.2) THEN
        DO 102 I=1,NMAXD
        D1T(1,NATMS(1),I)=D1T(1,NATMS(1),I)+XIDER(I)
        D1T(2,NATMS(1),I)=D1T(2,NATMS(1),I)+YIDER(I)
        D1T(3,NATMS(1),I)=D1T(3,NATMS(1),I)+ZIDER(I)
        D1T(1,NATMS(2),I)=D1T(1,NATMS(2),I)+XJDER(I)
        D1T(2,NATMS(2),I)=D1T(2,NATMS(2),I)+YJDER(I)
        D1T(3,NATMS(2),I)=D1T(3,NATMS(2),I)+ZJDER(I)
        D1T(1,NATMS(3),I)=D1T(1,NATMS(3),I)-XIDER(I)-XJDER(I)
        D1T(2,NATMS(3),I)=D1T(2,NATMS(3),I)-YIDER(I)-YJDER(I)
        D1T(3,NATMS(3),I)=D1T(3,NATMS(3),I)-ZIDER(I)-ZJDER(I)
  102   CONTINUE
      ELSE IF (NPASS.EQ.3) THEN
        DO 103 I=1,NMAXD
        D1T(1,NATMS(1),I)=D1T(1,NATMS(1),I)+XIDER(I)
        D1T(2,NATMS(1),I)=D1T(2,NATMS(1),I)+YIDER(I)
        D1T(3,NATMS(1),I)=D1T(3,NATMS(1),I)+ZIDER(I)
        D1T(1,NATMS(2),I)=D1T(1,NATMS(2),I)+XKDER(I)
        D1T(2,NATMS(2),I)=D1T(2,NATMS(2),I)+YKDER(I)
        D1T(3,NATMS(2),I)=D1T(3,NATMS(2),I)+ZKDER(I)
        D1T(1,NATMS(3),I)=D1T(1,NATMS(3),I)-XIDER(I)-XKDER(I)
        D1T(2,NATMS(3),I)=D1T(2,NATMS(3),I)-YIDER(I)-YKDER(I)
        D1T(3,NATMS(3),I)=D1T(3,NATMS(3),I)-ZIDER(I)-ZKDER(I)
  103   CONTINUE
      ELSE IF (NPASS.EQ.4) THEN
        DO 104 I=1,NMAXD
        D1T(1,NATMS(1),I)=D1T(1,NATMS(1),I)+XIDER(I)
        D1T(2,NATMS(1),I)=D1T(2,NATMS(1),I)+YIDER(I)
        D1T(3,NATMS(1),I)=D1T(3,NATMS(1),I)+ZIDER(I)
        D1T(1,NATMS(2),I)=D1T(1,NATMS(2),I)-XIDER(I)
        D1T(2,NATMS(2),I)=D1T(2,NATMS(2),I)-YIDER(I)
        D1T(3,NATMS(2),I)=D1T(3,NATMS(2),I)-ZIDER(I)
  104   CONTINUE
      ELSE
        STOP 'INVALID VALUE OF NPASS IN FORMEG'
      END IF
      RETURN
      END
