      SUBROUTINE FORM18(D1T)
      IMPLICIT REAL*8 (A-H,O-Z)
      DIMENSION D1T(N3N,NMAXD)
      DIMENSION AFG(6,150),POLDR(6,150)
      CHARACTER*52 TITLE
      COMMON/FUNCS/NTYPES,NTYPEP,NTREAD,NATOM,N3N,NATRI,NSYM
      COMMON/MAXDS/NMAXD
      COMMON/SIGNS/IOFF(256),IPRNT
      DATA A00 / 0.52917706D+00 /
    1 FORMAT(2I5)
    2 FORMAT(3F20.10)
    3 FORMAT(//,2X,' FIRST DERIVATIVES OF POLARIZABILITIES (PART I) IN (
     1BOHR+2)'/)
    4 FORMAT(//,2X,' FIRST DERIVATIVES OF POLARIZABILITIES (PART II) IN
     1(BOHR+2)'/)
    5 FORMAT(//,2X,' FIRST DERIVATIVES OF POLARIZABILITIES IN (BOHR+2)'/
     1)
    6 FORMAT(//,2X,' FIRST DERIVATIVES OF POLARIZABILITIES IN (A+2)'/)
C
C   PRINT OUT D1T MATRIX
      TITLE='TWO-ELECTRON CONTRIBUTION TO FIRST DERIVATIVES'
      CALL PRNONE(TITLE,D1T(1,NMAXD))
C
C   READ IN PART I RESULTS
      ITAP18=18
      call ffile(itap18,' ',0)
      REWIND ITAP18
      READ(ITAP18,1) NNATOM,NN3N
      READ(ITAP18,2) ((AFG(IXYZ,IABC),IABC=1,N3N),IXYZ=1,6)
      REWIND ITAP18
      WRITE(6,3)
      CALL MATOUT(AFG,6,150,6,N3N,6)
C
C   PRINT OUT POLARIZATION DERIVATIVES
      DO 101 IABC=1,N3N
      POLDR(1,IABC)=-D1T(IABC,1)-D1T(IABC,1)
      POLDR(2,IABC)=-D1T(IABC,2)-D1T(IABC,4)
      POLDR(3,IABC)=-D1T(IABC,5)-D1T(IABC,5)
      POLDR(4,IABC)=-D1T(IABC,3)-D1T(IABC,7)
      POLDR(5,IABC)=-D1T(IABC,6)-D1T(IABC,8)
      POLDR(6,IABC)=-D1T(IABC,9)-D1T(IABC,9)
  101 CONTINUE
      WRITE(6,4)
      CALL MATOUT(POLDR,6,150,6,N3N,6)
C
C   SUM UP BOTH CONTRIBUTIONS
      DO 102 IABC=1,N3N
      DO 102 IXYZ=1,6
      POLDR(IXYZ,IABC)=POLDR(IXYZ,IABC)+AFG(IXYZ,IABC)
  102 CONTINUE
      WRITE(6,5)
      CALL MATOUT(POLDR,6,150,6,N3N,6)
C
      A22=A00*A00
      DO 103 IABC=1,N3N
      DO 103 IXYZ=1,6
      POLDR(IXYZ,IABC)=POLDR(IXYZ,IABC)*A22
  103 CONTINUE
      WRITE(6,6)
      CALL MATOUT(POLDR,6,150,6,N3N,6)
C
C   SAVE THE RESULTS ON THE FILE18
      ITAP18=18
      REWIND ITAP18
      WRITE(ITAP18,1) NATOM,N3N
      WRITE(ITAP18,2) ((POLDR(IXYZ,IABC),IABC=1,N3N),IXYZ=1,6)
      REWIND ITAP18
C
      RETURN
      END
