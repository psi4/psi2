      INTEGER FUNCTION GETCOD()
C
      IMPLICIT INTEGER (A-Z)
      CHARACTER*1 MULTRF,VALENC,BLANK,DIGIT,JUNK,NEXTC
      CHARACTER*1 CHAR1,CHAR2,CHAR3
      CHARACTER*3 CODES,WORDS,CODE
      CHARACTER*4 TEM1,TEM2,TEM3,TCODE
      EQUIVALENCE (TEM1,ITEM1),(TEM2,ITEM2),(TEM3,ITEM3)
      EQUIVALENCE (TCODE,ICODE)
C
      COMMON /TAPES/  OUT,ERROUT,INPUT,DRTTAP
      COMMON /DRTCOD/ NCODES,DELA(9),DELB(9),DELELE(9)
     #,               NTYPES,VIRTUL,OCCUPD,VALOCC,RESCOR,RESVIR,FROZEN
     #,               VALVIR,OPENSH,MULTI,SPESHL,MULTRF,VALENC
     #,               WORDS(6,9),CODES(9)
      COMMON /CONST/  BLANK, DIGIT(10)
C
      JUNK=NEXTC(CHAR1)
      JUNK=NEXTC(CHAR2)
      JUNK=NEXTC(CHAR3)
clj041789 This mess causes problems on DEC:
c     TEM1='    '
c     TEM2='    '
c     TEM3='    '
c     TEM1=CHAR1
c     TEM2=CHAR2
c     TEM3=CHAR3
c     ITEM1=ISHFT(ISHFT(ITEM1,-24),24)
c     ITEM2=ISHFT(ISHFT(ITEM2,-24),16)
c     ITEM3=ISHFT(ISHFT(ITEM3,-24),8)
c     ICODE=IOR(IOR(IOR(ITEM1,ITEM2),ITEM3),IAND(32,255))
c     CODE=TCODE
      code = char1//char2//char3
C
      DO 2 I=1,NCODES
         IF (CODE.EQ.CODES(I)) GO TO 4
    2 CONTINUE
      WRITE (OUT,3) CODE
      WRITE (ERROUT,3) CODE
    3 FORMAT (//,' PROBLEMS WITH AN ORBITAL CODE:',1X,A3)
      call qabort
    4 GETCOD=I
      RETURN
      END
