      SUBROUTINE STUFIT(ITAPE4,NINTS,STVI,LENGTH,F,NSOFF,IOFF,NSYMHF,
     1NIJ,SRIN)
C
C
C  NINTS : STVI ARE IMPLICITLY EQUIVALENCED
C
C
      IMPLICIT REAL*8 (A-H,O-Z)
C
C
      INTEGER SRIN
C
      COMMON /BDIM/   IMAX2,JMAX2,KMAX2,LENR,LENAOR,IBIG,IBIGR,LENPWS
      COMMON /OUT/    IOUT6,ICHECK,IDBG,ICNT
C
      DIMENSION NINTS(LENGTH),F(NIJ),IOFF(NIJ),STVI(LENAOR),
     1NSOFF(NSYMHF)
C
CDB   IDBG8=0
CDB   IF((IDBG.AND.8).NE.0) IDBG8=1
C     PRINT,'  IN STUFIT'
10    CONTINUE
      CALL SREAD(ITAPE4,NINTS,LENGTH)
      SRIN=SRIN+I2SEC(LENGTH)
      ILSTI=NINTS(1)
      NBUF=NINTS(2)
CDB   IF(IDBG8.NE.0)WRITE(IOUT6,'('    IOR   JOR   ISM   JSM    IJ     V
CDB  1AL ')')
      DO 1 IINT=1,NBUF
C     JSM=NINTS(IINT+2).SHIFT.-8
C     IOR=JSM.SHIFT.-3
C     ISM=(IOR.SHIFT.-8)+1
C     IOR=IOR.AND.'377
C     JSM=(JSM.AND.'7)+1
C     JOR=NINTS(IINT+2).AND.'377
           JSM=ISHFT(NINTS(IINT+2),-8)
           IOR=ISHFT(JSM,-3)
           ISM=ISHFT(IOR,-8)+1
           IOR=IAND(IOR,255)
           JSM=IAND(JSM,7)+1
           JOR=IAND(NINTS(IINT+2),255)
           IF (ISM.NE.JSM) THEN
                WRITE(IOUT6,701) ISM,JSM
  701           FORMAT (//,' ***** IN ONE-ELECTRON INTEGRALS, ISM=',I3
     #          ,             ' JSM=',I3,' *****',//)
                CALL MABORT
           END IF
           I=IOR+NSOFF(ISM)
           J=JOR+NSOFF(JSM)
           IJ=IOFF(I)+J
           F(IJ)=STVI(IINT+1491)+F(IJ)
CDB   IF(IDBG8.NE.0)WRITE(IOUT6,'(5I6,G18.8)')IOR,JOR,ISM,JSM,IJ,
CDB  1   STVI(IINT+1491)
    1 CONTINUE
      IF(ILSTI.EQ.0) GO TO 10
      RETURN
      END
