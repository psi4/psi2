      SUBROUTINE SRTONE(BKTPNT,START,ILAST,BKTSZ2,TTT,ITTT,INTOFF,
     1 ITXXX)
      IMPLICIT INTEGER (A-Z)
C     EXTENDED DUMMY START,ILAST,TTT,ITTT,INTOFF,BKTPNT
      integer ibig2
      REAL*8 TTT(IBIG2),VAL
      save itape 
      COMMON /BIGD/ IBIG,IBIG2
      COMMON /DIMS/ ISYMRB,NUMIJ,NIJ,NBF,NIJAO,NBFAO,NORBS,NMAX,NSYMHF
      COMMON/TAPES/ OUT,CHK,IT30,IT47,IT52,IT53,IT55,IT58,IT91,IT93,IT95
      COMMON /OFF/ MAXINT
      COMMON /SRT/VAL,IADR,IDUM,NBKT
      DIMENSION ITTT(IBIG),BKTPNT(NBKT),START(NBKT),
     1 ILAST(NBKT),INTOFF(NBKT)
C     PRINT*, '  IN SRTONE'
      CALL SREW(ITXXX)
      itape=itxxx
      BKTPNT(1)=1
      START(1)=0
      ILAST(1)=0
      DO 110 II=2,NBKT
      ILAST(II)=0
      START(II)=START(II-1)+BKTSZ2
      BKTPNT(II)=1
  110 CONTINUE
C***************** IMPORTANT!! **********************************
C   POINTR SHOULD BE SET EQUAL TO THE SECTOR ADDRESS OF THE FIRST
C   SECTOR ON A DIRECT ACCESS DISK FILE.
      POINTR=1
      PTAD = BKTSZ2/SEC2I(1)
      IF(SEC2I(1)*PTAD.NE.BKTSZ2) PTAD = PTAD + 1
      MAXINT=((BKTSZ2-2)/6)*INTOWP(1)
      IF(MAXINT.LE.0) THEN
      CALL MABORT
      END IF
      DO 120 II=1,NBKT
      INTOFF(II)=(START(II)+MAXINT)/INTOWP(1)+1
  120 CONTINUE
 22   CONTINUE
C     PRINT*,' NPASS= ',NPASS
C     PRINT*,' IADBK= ',IADBK
C     PRINT*,' NBKT= ',NBKT
C     PRINT*,' BKTSZ= ',BKTSZ
C     PRINT*,' MAXINT= ',MAXINT
C     PRINT*,' BKTPNT= ',BKTPNT
C     PRINT*,' START= ',START
C     PRINT*,' ILAST= ',ILAST
C     PRINT*,' INTOFF= ',INTOFF
C     PRINT*,' DONE SRTONE  NUM=',NUM
      RETURN
C
      ENTRY SRTOUT(BKTPNT,START,ILAST,BKTSZ2,TTT,ITTT,INTOFF,
     *itxxx)
C
      STRT=START(IDUM)
      PNT=BKTPNT(IDUM)
      OFSET=INTOFF(IDUM)
      ADRL=STRT+PNT+2
      ADRV=OFSET+PNT
      ITTT(ADRL)=IADR
      TTT(ADRV)=VAL
      BKTPNT(IDUM)=BKTPNT(IDUM)+1
      IF (ADRL .LT. INTOWP(OFSET)  ) RETURN
      ITTT(STRT+1)=ILAST(IDUM)
      ILAST(IDUM)=POINTR
      POINTR=POINTR+PTAD
      ITTT(STRT+2)=MAXINT
      CALL RGETSA(ITXXX,IX)
CGES  WRITE(*,*)'NOW WRITING FILE',ITXXX,' AT ADDRESS ',IX
      CALL RWRIT(ITXXX,ITTT(STRT+1),BKTSZ2,IX)
CIBM  CALL SWRIT(ITXXX,ITTT(STRT+1),BKTSZ)
      BKTPNT(IDUM)=1
      RETURN
C
      ENTRY SRTLST(BKTPNT,START,ILAST,BKTSZ2,TTT,ITTT,INTOFF,
     *itxxx)
C
      DO 130 II=1,NBKT
      STRT=START(II)
      IF (BKTPNT(II) .EQ. 1) GOTO 201
      ITTT(STRT+1)=ILAST(II)
      ILAST(II)=POINTR
      POINTR=POINTR+PTAD
      ITTT(STRT+2)=BKTPNT(II)-1
      CALL RGETSA(ITXXX,IX)
CIBM  CALL SWRIT(ITXXX,ITTT(STRT+1),BKTSZ)
CGES  WRITE(*,*)'NOW WRITING FILE',ITXXX,' AT ADDRESS ',IX
      CALL RWRIT(ITXXX,ITTT(STRT+1),BKTSZ2,IX)
  201 CONTINUE
  130 CONTINUE
C
      RETURN
      END
