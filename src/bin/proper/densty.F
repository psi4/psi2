      SUBROUTINE DENSTY(OCC,EAO,P)
      IMPLICIT REAL*8 (A-H,O-Z)
      integer nbasis,nbfao,nbfso,nbatri
      DIMENSION OCC(NBASIS),EAO(NBFAO,NBFSO),P(NBATRI)
      COMMON/BASIS/NBASIS,NBFAO,NBFSO,NBATRI
      COMMON/SIGNS/IOFF(500),IPRNT
      DATA ZERO / 0.0D+00 /
    1 FORMAT(//,2X,' DENSITY MATRIX'/)
C
C   FORM DENSITY MATRIX
      DO 101 I=1,NBATRI
  101 P(I)=ZERO
      IJ=0
      DO 103 I=1,NBFAO
      DO 103 J=1,I
      IJ=IJ+1
      VALU=ZERO
      DO 102 K=1,NBASIS
      IF(OCC(K).LE.ZERO) GO TO 102
      VALU=VALU+EAO(I,K)*EAO(J,K)*OCC(K)
  102 CONTINUE
      P(IJ)=VALU
  103 CONTINUE
      IF(IPRNT.LE.3) GO TO 201
      WRITE(6,1)
      CALL PRINT(P,NBATRI,NBFAO,6)
C
  201 CONTINUE
      RETURN
      END
