C//////////////////////////////////////////
      SUBROUTINE INITPG(VECTOR)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      integer nwksmx
      DOUBLE PRECISION VECTOR(NWKSMX)
      CHARACTER SYMLBL*3
      INTEGER PUWKT,REFWLK,FWORD,ORBFRM,SEC2I
      LOGICAL IEQJ
      LOGICAL PAGEIN
      DOUBLE PRECISION ACF,DRTVER
      INTEGER BMAX,PUWK,PRPFLG,PRINT,ROOTI,ROOTF,SYMOFF,IRSYM
      INTEGER DRTLBL,SCFLBL,SYMDIF
      COMMON /TAPES/IFILE3,IFILE5,IFILE6,ITAPE7,IFIL58,IFIL54,IFIL50
     $,             IFIL51,IDEV,IFIL30
      COMMON /DIMS/ NBF,NSYM,NORBS,NROWS,NROWS4,NWKS,NWKS2,NLEVS
     $,             NWKSMX,NWKMX2,NLWKMX,BMAX,NROOTS,NORBSQ,NBFSQ
     $,             NOCCMX,NREFS,IEND
      COMMON /INTS/ NMAX,NMAX2,NGROUP,NBLKOC,NUMIJ,NUMKL,INTSRT
      COMMON /LOOPS/ACF,IUWK,JUWK,NLWK,IORB,JORB,PUWK
      COMMON /PAGE/ IWORD3,PAGEIN,NOFFI,NOFFJ,NPASS,NWORDL
      COMMON /OPS/  PRINT,MAX,NOFLG,PRPFLG,ROOTI,ROOTF,IRSYM
      COMMON /SYMM/ SYMOFF(8),NTOTS(8,2),SYMDIF,SYMLBL(15)
      COMMON /LBLS/ DRTVER,DRTLBL(26),INTLBL(26),SCFLBL(26)
      COMMON /PAGDAT/IEQJ,IUWKSV,JUWKSV,NLWKI2,NLWKJ2,JWALK,IWALK,II,JJ
      IWORD3=SEC2I(1)+1
      IWALK=0
      II=1
      JJ=1
      IEQJ=.TRUE.
      RETURN
      ENTRY PAGES(VECTOR)
      IF(IUWK.NE.JUWK) GO TO 210
      ENTRY PAGED(VECTOR)
  200 IF(NLWKI.GT.NWKSMX) RETURN
      IUWKSV=IUWK
      JUWKSV=JUWK
      IEQJ=.TRUE.
      PAGEIN=.TRUE.
      NLWKI2=NLWKI+NLWKI
      NLWKJ2=NLWKI2
      NOFFI=IUWK-1
      NOFFJ=NOFFI
      IWALK=NOFFI+NOFFI
      II=1
      JJ=1
      FWORD=IWALK+IWORD3
      WRITE(IFILE6,10)
      CALL MABORT
   10 FORMAT(2X,'ENTRY PAGES')
C     CALL WREADW(ITAP03,VECTOR,NLWKI2,FWORD,JUNK)
      RETURN
  210 IF((NLWKI+NLWKJ).GT.NWKSMX) RETURN
      ENTRY PAGEO(VECTOR)
      IUWKSV=IUWK
      JUWKSV=JUWK
      PAGEIN=.TRUE.
      IEQJ=.FALSE.
      NLWKI2=NLWKI+NLWKI
      NLWKJ2=NLWKJ+NLWKJ
      NOFFI=IUWK-1
      NOFFJ=JUWK-1
      IWALK=NOFFI+NOFFI
      JWALK=NOFFJ+NOFFJ
      NOFFJ=NOFFJ-NLWKI
      II=1
      JJ=NLWKI+1
      FWORD=IWALK+IWORD3
      WRITE(IFILE6,11)
      CALL MABORT
  11  FORMAT(2X,'ENTRY PAGEO')
C     CALL WREADW(ITAP03,VECTOR,NLWKI2,FWORD,JUNK)
      FWORD=JWALK+IWORD3
C     CALL WREADW(ITAP03,VECTOR(JJ),NLWKJ2,FWORD,JUNK)
      RETURN
      ENTRY PAGEIJ(VECTOR)
C   CHECK THAT SOMETHING HAS CHANGED
      IF(IUWKSV.EQ.IUWK.AND.JUWKSV.EQ.JUWK) RETURN
      IF(IEQJ) GO TO 400
      IF(IUWKSV.EQ.IUWK) GO TO 310
      IF(JUWKSV.EQ.JUWK) GO TO 330
  300 PAGEIN=.FALSE.
      IF(IUWK.EQ.JUWK) GO TO 200
      GO TO 210
  310 IF((NLWKI+NLWKJ).LE.NWKSMX) GO TO 320
      PAGEIN=.FALSE.
      RETURN
  320 JJ=NLWKI+1
      JUWKSV=JUWK
      NLWKJ2=NLWKJ+NLWKJ
      NOFFJ=JUWK-1
      JWALK=NOFFJ+NOFFJ
      NOFFJ=NOFFJ-NLWKI
      FWORD=JWALK+IWORD3
      WRITE(IFILE6,12)
      CALL MABORT
 12   FORMAT(2X,'ENTRY PAGEIJ')
C     CALL WREADW(ITAP03,VECTOR(JJ),NLWKJ2,FWORD,JUNK)
      RETURN
  330 IF(IUWK.NE.JUWK) GO TO 340
      IEQJ=.TRUE.
      II=JJ
      IWALK=JWALK
      IUWKSV=IUWK
      NLWKI2=NLWKJ2
      RETURN
  340 IF(NLWKI.LT.JJ) GO TO 350
      PAGEIN=.FALSE.
      GO TO 210
  350 IUWKSV=IUWK
      NOFFI=IUWK-1
      IWALK=NOFFI+NOFFI
      NLWKI2=NLWKI+NLWKI
      II=1
      FWORD=IWALK+IWORD3
C     CALL WREADW(ITAP03,VECTOR(II),NLWKI2,FWORD,JUNK)
      RETURN
  400 IF(IUWK.NE.IUWKSV) GO TO 420
      IEQJ=.FALSE.
      IF(II.EQ.1) GO TO 405
      IF(NLWKJ.GE.II) GO TO 420
      JJ=1
      GOTO 410
  405 IF((NLWKI+NLWKJ).GT.NWKSMX) GO TO 420
      JJ=II+NLWKI
  410 JUWKSV=JUWK
      NOFFJ=JUWK-1
      JWALK=NOFFJ+NOFFJ
      NOFFJ=NOFFJ-NLWKI
      NLWKJ2=NLWKJ+NLWKJ
      FWORD=JWALK+IWORD3
C     CALL WREADW(ITAP03,VECTOR(JJ),NLWKJ2,FWORD,JUNK)
      RETURN
  420 PAGEIN=.FALSE.
      IF(IUWK.EQ.JUWK) GO TO 200
      GO TO 210
      END
