C//////////////////////////////////////////////////////////
      SUBROUTINE LRGCNF(VECTOR,COEF,CNF,ORDER)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      integer nwksmx,max
      DOUBLE PRECISION VECTOR(NWKSMX),COEF(MAX),CMIN
      CHARACTER SYMLBL*3
      INTEGER CNF(MAX),FWORD,OFFSET,TSTCNF,ORDER(MAX)
      LOGICAL PAGEIN
      DOUBLE PRECISION ACF,DRTVER
      INTEGER BMAX,PUWK,PRPFLG,PRINT,ROOTI,ROOTF,SYMOFF,IRSYM
      INTEGER DRTLBL,SCFLBL,SYMDIF
      COMMON /TAPES/IFILE3,IFILE5,IFILE6,ITAPE7,IFIL58,IFIL54,IFIL50
     $,             IFIL51,IDEV,IFIL30
      COMMON /DIMS/ NBF,NSYM,NORBS,NROWS,NROWS4,NWKS,NWKS2,NLEVS
     $,             NWKSMX,NWKMX2,NLWKMX,BMAX,NROOTS,NORBSQ,NBFSQ
     $,             NOCCMX,NREFS,IEND
      COMMON /INTS/ NMAX,NMAX2,NGROUP,NBLKOC,NUMIJ,NUMKL,INTSRT
      COMMON /LOOPS/ACF,IUWK,JUWK,NLWK,IORB,JORB,PUWK
      COMMON /PAGE/ IWORD3,PAGEIN,NOFFI,NOFFJ,NPASS,NWORDL
      COMMON /OPS/  PRINT,MAX,NOFLG,PRPFLG,ROOTI,ROOTF,IRSYM
      COMMON /SYMM/ SYMOFF(8),NTOTS(8,2),SYMDIF,SYMLBL(15)
      COMMON /LBLS/ DRTVER,DRTLBL(26),INTLBL(26),SCFLBL(26)
      CMIN=0.0D0
      NCNF=0
      OFFSET=0
      FWORD=IWORD3
      NPASS=(NWKS-1)/NWKSMX+1
      NWORDL=NWKS2-(NPASS-1)*NWKMX2
      DO 10 I=1,MAX
      ORDER(I)=I
   10 COEF(I)=0.0D0
      NWORD=NWKMX2
C  SORT MOST IMPORTANT CONFIGURATIONS OUT OF VECTOR
      DO 40 L=1,NPASS
      IF(L.EQ.NPASS) NWORD=NWORDL
      NLOOP=NWORD/2
      CALL WREADW(IFIL54,VECTOR,NWORD,FWORD,FWORD)
      DO 30 K=1,NLOOP
      TSTCF=VECTOR(K)
      TSTABS=ABS(TSTCF)
      TSTCNF=K+OFFSET
      IF(TSTABS.LT.CMIN) GO TO 30
      NCNF=NCNF+1
      IF(NCNF.GT.MAX) NCNF=MAX
      DO 20 J=1,NCNF
      IF(TSTABS.LT.ABS(COEF(J))) GO TO 20
      TEMP=COEF(J)
      ITEMP=CNF(J)
      COEF(J)=TSTCF
      CNF(J)=TSTCNF
      TSTCF=TEMP
      TSTABS=ABS(TEMP)
      TSTCNF=ITEMP
   20 CONTINUE
      IF(NCNF.GE.MAX) CMIN=ABS(COEF(NCNF))
   30 CONTINUE
      OFFSET=OFFSET+NLOOP
   40 CONTINUE
      RETURN
      END
