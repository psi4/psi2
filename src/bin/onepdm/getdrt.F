C///////////////////////////////////////////////////////////////
      SUBROUTINE GETDRT(LEVPT,BVAL,ARC,NLWKS,WEIGHT,ORBSYM,ORBTBF,BFSYM
     $,                 BFCODE)
C
      IMPLICIT INTEGER (A-Z)
C
      integer nlevs,nrows,norbs,nrows4,nbf
      DOUBLE PRECISION ACF,DRTVER
      CHARACTER SYMLBL*3
      INTEGER LEVPT(NLEVS),BVAL(NROWS),ORBSYM(NORBS),ORBTBF(NORBS)
      INTEGER ARC(NROWS4),NLWKS(NROWS),WEIGHT(NROWS4),BFSYM(NBF)
crsg021594 use correct dimension for BFCODE so MRCI output is correct
crsg021594      INTEGER BMAX,SYMOFF,DRTLBL,SCFLBL,SYMDIF,BFCODE(NBF)
      INTEGER BMAX,SYMOFF,DRTLBL,SCFLBL,SYMDIF,BFCODE(nrefs,NBF)
C
      COMMON /TAPES/IFILE3,IFILE5,IFILE6,ITAPE7,IFIL58,IFIL54,IFIL50
     $,             IFIL51,IDEV,IFIL30
      COMMON /DIMS/ NBF,NSYM,NORBS,NROWS,NROWS4,NWKS,NWKS2,NLEVS
     $,             NWKSMX,NWKMX2,NLWKMX,BMAX,NROOTS,NORBSQ,NBFSQ
     $,             NOCCMX,NREFS,IEND
      COMMON /INTS/ NMAX,NMAX2,NGROUP,NBLKOC,NUMIJ,NUMKL,INTSRT
      COMMON /SYMM/ SYMOFF(8),NTOTS(8,2),SYMDIF,SYMLBL(15)
      COMMON /LBLS/ DRTVER,DRTLBL(26),INTLBL(26),SCFLBL(26)
C
      CALL WREADW(IFIL58,ORBSYM,NORBS,IEND,IEND)
      CALL WREADW(IFIL58,BFSYM,NBF,IEND,IEND)
      CALL WREADW(IFIL58,BFCODE,NREFS*NBF,IEND,IEND)
      CALL WREADW(IFIL58,ORBTBF,NORBS,IEND,IEND)
      CALL WREADW(IFIL58,LEVPT,NLEVS,IEND,IEND)
      IEND=IEND+NLEVS
      CALL WREADW(IFIL58,AVAL,1,IEND,IEND)
      IEND=IEND+NROWS-1
      CALL WREADW(IFIL58,BVAL,NROWS,IEND,IEND)
      IEND=IEND+NROWS
      CALL WREADW(IFIL58,ARC,NROWS4,IEND,IEND)
      CALL WREADW(IFIL58,NLWKS,NROWS,IEND,IEND)
      CALL WREADW(IFIL58,WEIGHT,NROWS4,IEND,IEND)
      NFRMIN=LEVPT(LEVFRM)+1
      NLWKMX=0
      DO 20 I=NFRMIN,NROWOC
      IF(NLWKS(I).GT.NLWKMX) NLWKMX=NLWKS(I)
   20 CONTINUE
      NLWKMX=NLWKMX+NLWKMX
      NOCCMX=AVAL+BMAX
      SYM=BFSYM(1)
      SYMOFF(SYM+1)=0
      ISYM=1
      DO 30 I=1,NBF
      IF(BFSYM(I).EQ.SYM) GO TO 30
      NTOTS(ISYM,1)=SUM-SYMOFF(SYM+1)
      NTOTS(ISYM,2)=SYM
      ISYM=ISYM+1
      SYM=BFSYM(I)
      SYMOFF(SYM+1)=SUM
   30 SUM=SUM+1
      NTOTS(ISYM,1)=NBF-SYMOFF(SYM+1)
      NTOTS(ISYM,2)=SYM
      DO 40 I=1,NORBS
   40 ORBSYM(I)=ORBSYM(I)-1
      RETURN
      END
